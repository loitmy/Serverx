<!DOCTYPE html>
<html lang="en"><head>
  <meta name="name" content="">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>0xdf hacks stuff | CTF solutions, malware analysis, home lab development</title>
<meta name="generator" content="Jekyll v4.3.1" />
<meta property="og:title" content="0xdf hacks stuff" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="CTF solutions, malware analysis, home lab development" />
<meta property="og:description" content="CTF solutions, malware analysis, home lab development" />
<link rel="canonical" href="https://0xdf.gitlab.io/" />
<meta property="og:url" content="https://0xdf.gitlab.io/" />
<meta property="og:site_name" content="0xdf hacks stuff" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="0xdf hacks stuff" />
<meta name="twitter:site" content="@0xdf_" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","description":"CTF solutions, malware analysis, home lab development","headline":"0xdf hacks stuff","name":"0xdf hacks stuff","url":"https://0xdf.gitlab.io/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/bootstrap-toc.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="/assets/css/custom.css"> 
  <link rel="stylesheet" href="/assets/css/buymeacoffee.css">
  
  <link rel="stylesheet" href="/assets/css/syntax.css"><link type="application/atom+xml" rel="alternate" href="https://0xdf.gitlab.io/feed.xml" title="0xdf hacks stuff" /><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-P056MVQVGM"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-P056MVQVGM');
</script>
<!--<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-120216868-1', 'auto');
ga('send', 'pageview');
</script>-->
  
<link rel="icon" type="image/png" href="/assets/icons/favicon-32x32.png" sizes="32x32" />
  <link rel="icon" type="image/png" href="/assets/icons/favicon-16x16.png" sizes="16x16" />
</head>

  <body>
  
<header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">0xdf hacks stuff</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
            
<a class="page-link-site" href="/about">About Me</a><a class="page-link-site" href="/tags">Tags</a><a class="page-link-site bmc" href="https://youtube.com/@0xdf"><img src="/icons/youtube.png" class="svg-icon" alt="" />YouTube</a>
          <a class="page-link-site bmc" href="https://gitlab.com/0xdf/ctfscripts"><img src="/icons/gitlab.png" class="svg-icon" alt="" />Gitlab</a><a class="page-link-site bmc" href="/feed.xml"><img src="/icons/rss.png" class="svg-icon" alt="" /><span>feed</span></a><a class="page-link-site bmc" target="_blank"
href="https://www.buymeacoffee.com/0xdf"><img src="https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg" alt="Buy me a coffee" style="-webkit-filter: drop-shadow(0px 0px 2px white); filter: drop-shadow(0px 0px 2px white);"></a>
        </div>
      </nav></div>
</header>
<div id="banner">
    <span id="close-banner"><b>X</b></span>
    <p>Guided mode is new on HackTheBox! Questions that provide an exploitation path, now available for most Easy Retired machines.<br /><br />Checkout <a href="https://www.youtube.com/watch?v=f-pz_gaghSc">my YouTube video overview</a> or the official <a href="https://affiliate.hackthebox.com/guided-mode">HTB post</a> for details!<br /><br />And check out <a href="https://affiliate.hackthebox.com/hackers-bootcamp">Hackers’ Bootcamp</a>, retired machines free to play for everyone, all with guided! End Aug 18!</p>

</div>
<script>
    const banner = document.getElementById('banner');
    const closeButton = document.getElementById('close-banner');
    if (sessionStorage.getItem("closebanner")) {
        banner.style.display = 'none';
    }const enddate = new Date("2023-08-18T00:00:00");
    const curdate = new Date();
    if (curdate > enddate) {
        banner.style.display = 'none';
    }closeButton.addEventListener('click', () => {
        banner.style.display = 'none';
        sessionStorage.setItem("closebanner", true);
    });
</script><main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="home">

<h2 class="post-list-heading">Posts</h2>
    <ul class="post-list">
          <li class="post-list-li"><span class="post-meta">Sep 9, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/09/09/htb-pikatwoo.html">
                HTB: PikaTwoo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-pikatwoo " class="post-tag">htb-pikatwoo</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#modsecurity " class="post-tag">modsecurity</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#apisix " class="post-tag">apisix</a> <a href="/tags#uri-blocker-apisix " class="post-tag">uri-blocker-apisix</a> <a href="/tags#openstack " class="post-tag">openstack</a> <a href="/tags#openstack-swift " class="post-tag">openstack-swift</a> <a href="/tags#openstack-keystone " class="post-tag">openstack-keystone</a> <a href="/tags#android " class="post-tag">android</a> <a href="/tags#cve-2021-38155 " class="post-tag">cve-2021-38155</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#apktool " class="post-tag">apktool</a> <a href="/tags#apk " class="post-tag">apk</a> <a href="/tags#flutter " class="post-tag">flutter</a> <a href="/tags#flutter-obfuscate " class="post-tag">flutter-obfuscate</a> <a href="/tags#genymotion " class="post-tag">genymotion</a> <a href="/tags#adb " class="post-tag">adb</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-proxy " class="post-tag">burp-proxy</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#certificate-pinning " class="post-tag">certificate-pinning</a> <a href="/tags#frida " class="post-tag">frida</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#chat-gpt " class="post-tag">chat-gpt</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#cve-2021-43557 " class="post-tag">cve-2021-43557</a> <a href="/tags#bypass " class="post-tag">bypass</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#swagger " class="post-tag">swagger</a> <a href="/tags#nginx " class="post-tag">nginx</a> <a href="/tags#cve-2021-35368 " class="post-tag">cve-2021-35368</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#nginx-temp-files " class="post-tag">nginx-temp-files</a> <a href="/tags#kubernetes " class="post-tag">kubernetes</a> <a href="/tags#minikube " class="post-tag">minikube</a> <a href="/tags#kubectl " class="post-tag">kubectl</a> <a href="/tags#podman " class="post-tag">podman</a> <a href="/tags#cve-2022-24112 " class="post-tag">cve-2022-24112</a> <a href="/tags#cr8escape " class="post-tag">cr8escape</a> <a href="/tags#cve-2022-0811 " class="post-tag">cve-2022-0811</a> <a href="/tags#crio " class="post-tag">crio</a> <a href="/tags#kernel-parameters " class="post-tag">kernel-parameters</a> <a href="/tags#crashdump " class="post-tag">crashdump</a> <a href="/tags#htb-dyplesher " class="post-tag">htb-dyplesher</a> <a href="/tags#htb-canape " class="post-tag">htb-canape</a> <a href="/tags#htb-pikaboo " class="post-tag">htb-pikaboo</a> <a href="/tags#htb-routerspace " class="post-tag">htb-routerspace</a> <a href="/tags#htb-encoding " class="post-tag">htb-encoding</a> <a href="/tags#htb-pollution " class="post-tag">htb-pollution</a> <a href="/tags#htb-vessel " class="post-tag">htb-vessel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/pikatwoo-cover.webp" />
    <img loading="lazy" src="/img/pikatwoo-cover.png" alt="PikaTwoo" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>PikaTwoo is an absolute monster of an insane box. I’ll start by abusing a vulnerability in OpenStack’s KeyStone to leak a username. With that username, I’ll find an Android application file in the OpenStack Swift object storage. The application is a Flutter application built with the obfuscate option, making it very difficult to reverse. I’ll set up an emulator to proxy the application traffic, using Frida to bypass certificate pinning. I’ll find an SQL injection in the API, and leak an email address. I’ll exploit another vulenrability in the APISIX uri-block WAF to get access to private documents for another API. There, I’ll reset the password for the leaked email, and get authenticated access. I’ll exploit a vulnerability in the modsecurity core rule set to bypass the WAF and get local file include in that API. From there, I’ll abuse nginx temporary files to get a reverse shell in the API pod. I’ll leak an APISIX secret from the Kubernetes secrets store, and use that with another vulnerability to get execution in the APISIX pod. I’ll find creds for a user in a config file and use them to SSH into the host. From there, I’ll abuse the Cr8Escape vulnerability to get execution as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 2, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/09/02/htb-monitorstwo.html">
                HTB: MonitorsTwo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-monitorstwo " class="post-tag">htb-monitorstwo</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#cacti " class="post-tag">cacti</a> <a href="/tags#cve-2022-46169 " class="post-tag">cve-2022-46169</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#cve-2021-41091 " class="post-tag">cve-2021-41091</a> <a href="/tags#cve-2021-41103 " class="post-tag">cve-2021-41103</a> <a href="/tags#htb-monitors " class="post-tag">htb-monitors</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/monitorstwo-cover.webp" />
    <img loading="lazy" src="/img/monitorstwo-cover.png" alt="MonitorsTwo" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>MonitorsTwo starts with a Cacti website (just like Monitors). There’s a command injection vuln that has a bunch of POCs that don’t work as of the time of MonitorsTwo’s release. I’ll show why, and exploit it manually to get a shell in a container. I’ll pivot to the database container and crack a hash to get a foothold on the box. For root, I’ll exploit a couple of Docker CVEs that allow for creating a SetUID binary inside the container that I can then run as root on the host.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 26, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/08/26/htb-onlyforyou.html">
                HTB: OnlyForYou
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-onlyforyou " class="post-tag">htb-onlyforyou</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#python-re " class="post-tag">python-re</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#foxyproxy " class="post-tag">foxyproxy</a> <a href="/tags#gogs " class="post-tag">gogs</a> <a href="/tags#neo4j " class="post-tag">neo4j</a> <a href="/tags#cypher-injection " class="post-tag">cypher-injection</a> <a href="/tags#cypher " class="post-tag">cypher</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#pip " class="post-tag">pip</a> <a href="/tags#setup-py " class="post-tag">setup-py</a> <a href="/tags#htb-opensource " class="post-tag">htb-opensource</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/onlyforyou-cover.webp" />
    <img loading="lazy" src="/img/onlyforyou-cover.png" alt="OnlyForYou" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>OnlyForYou is about exploiting Python and Neo4J. I’ll start by exploiting a Flask website file disclosure vulnerability due to a misunderstanding of the <code class="language-plaintext highlighter-rouge">os.path.join</code> function to get the source for another site. In that source, I’ll identify a command injection vulnerability, and figure out how bypass the filtering with a misunderstanding of the <code class="language-plaintext highlighter-rouge">re.match</code> function. Exploiting this returns a shell. I’ll pivot to the next user by abusing a Cypher Injection in Neo4J, and then escalate to root by exploiting an unsafe sudo rule with pip.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 19, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/08/19/htb-mailroom.html">
                HTB: Mailroom
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-mailroom " class="post-tag">htb-mailroom</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#gitea " class="post-tag">gitea</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#execute-after-redirect " class="post-tag">execute-after-redirect</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#nosql-injection " class="post-tag">nosql-injection</a> <a href="/tags#nosql-injection-over-xss " class="post-tag">nosql-injection-over-xss</a> <a href="/tags#xsrf " class="post-tag">xsrf</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#keepass " class="post-tag">keepass</a> <a href="/tags#strace " class="post-tag">strace</a> <a href="/tags#trace " class="post-tag">trace</a> <a href="/tags#ptrace-scope " class="post-tag">ptrace-scope</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-retired " class="post-tag">htb-retired</a> <a href="/tags#htb-fingerprint " class="post-tag">htb-fingerprint</a> <a href="/tags#htb-previse " class="post-tag">htb-previse</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/mailroom-cover.webp" />
    <img loading="lazy" src="/img/mailroom-cover.png" alt="Mailroom" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Mailroom has a contact us form that I can use to get cross site sripting against an admin user. I’ll use this XSS to exploit a NoSQL injection vulnerability in a private site, brute forcing the user’s password and exfiling it back to myself. From this foothold, I’ll exploit into the container running the site and find more credentials, pivoting to another user. This user is opening their KeePass database, and I’ll use strace to watch them type their password into KeePass CLI, which I can use to recover the root password. In Beyond Root, a quick dive into how the KeePass password was automated.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 12, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/08/12/htb-busqueda.html">
                HTB: Busqueda
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-busqueda " class="post-tag">htb-busqueda</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#searchor " class="post-tag">searchor</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#python-eval " class="post-tag">python-eval</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#gitea " class="post-tag">gitea</a> <a href="/tags#htb-forgot " class="post-tag">htb-forgot</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/busqueda-cover.webp" />
    <img loading="lazy" src="/img/busqueda-cover.png" alt="Busqueda" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Busqueda presents a website that gives links to various sites based on user input. Under the hood, it is using the Python Searchor command line tool, and I’ll find an unsafe eval vulnerability and exploit that to get code execution. On the host, the user can run sudo to run a Python script, but I can’t see the script. I’ll find a virtualhost with Gitea, and use that along with different creds to eventually find the source for the script, and identify how to run it to get arbitrary execution as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 5, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/08/05/htb-agile.html">
                HTB: Agile
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-agile " class="post-tag">htb-agile</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#werkzeug " class="post-tag">werkzeug</a> <a href="/tags#werkzeug-debug " class="post-tag">werkzeug-debug</a> <a href="/tags#flask-debug-pin " class="post-tag">flask-debug-pin</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#python-venv " class="post-tag">python-venv</a> <a href="/tags#pytest " class="post-tag">pytest</a> <a href="/tags#selenium " class="post-tag">selenium</a> <a href="/tags#chrome " class="post-tag">chrome</a> <a href="/tags#chrome-debug " class="post-tag">chrome-debug</a> <a href="/tags#sudoedit " class="post-tag">sudoedit</a> <a href="/tags#cve-2023-22809 " class="post-tag">cve-2023-22809</a> <a href="/tags#idor " class="post-tag">idor</a> <a href="/tags#flask-cookie " class="post-tag">flask-cookie</a> <a href="/tags#htb-bagel " class="post-tag">htb-bagel</a> <a href="/tags#htb-opensource " class="post-tag">htb-opensource</a> <a href="/tags#htb-rainyday " class="post-tag">htb-rainyday</a> <a href="/tags#htb-noter " class="post-tag">htb-noter</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/agile-cover.webp" />
    <img loading="lazy" src="/img/agile-cover.png" alt="Agile" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Agile is a box hosting a password manager solution. There’s a file read vulnerability in the application, and the Flask server is running in debug mode. I’ll use those to get execution on the box, which turns out to be a bit trickier than expected. From there, I’ll dump a user’s password out of the database and get an SSH shell. There’s a testing version of the app running as well, and I’ll abuse Chrome debug to get credentials from the testing Chrome instance to pivot to the next user. This user can use sudoedit to modify files related to the test server. I’ll abuse CVE-2023-22809 to write into the virtual environment that root is sourcing to get root. In Beyond Root, I’ll show two unintended vulnerabilities in the web application that got patched about a week after release.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 29, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/07/29/htb-cerberus.html">
                HTB: Cerberus
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-cerberus " class="post-tag">htb-cerberus</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ttl " class="post-tag">ttl</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#dig " class="post-tag">dig</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#icinga " class="post-tag">icinga</a> <a href="/tags#github " class="post-tag">github</a> <a href="/tags#cve-2022-24716 " class="post-tag">cve-2022-24716</a> <a href="/tags#cve-2022-24715 " class="post-tag">cve-2022-24715</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#file-write " class="post-tag">file-write</a> <a href="/tags#icinga-module " class="post-tag">icinga-module</a> <a href="/tags#firejail " class="post-tag">firejail</a> <a href="/tags#cve-2022-31214 " class="post-tag">cve-2022-31214</a> <a href="/tags#sssd " class="post-tag">sssd</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#manageengine " class="post-tag">manageengine</a> <a href="/tags#adselfservice " class="post-tag">adselfservice</a> <a href="/tags#cve-2022-47966 " class="post-tag">cve-2022-47966</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#saml " class="post-tag">saml</a> <a href="/tags#saml-decoder " class="post-tag">saml-decoder</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/cerberus-cover.webp" />
    <img loading="lazy" src="/img/cerberus-cover.png" alt="Cerberus" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Cerberus is unique in that it’s one of the few boxes on HTB (or any CTF) that has Windows hosting a Linux VM. To start, I can only access an IcingaWeb2 instance running in the VM. I’ll exploit two CVEs in Icinga, first with file read to get credentials, and then a file write to write a fake module and get execution. Inside the VM, I’ll exploit Firejail to get root. I’ll also get creds for a user on the host from SSSD, and then tunnel through the VM to get WinRM access to the host. To get SYSTEM on the host, I’ll exploit a SAML vulnerability in ManageEngine’s ADSelfService Plus.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 22, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/07/22/htb-derailed.html">
                HTB: Derailed
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-derailed " class="post-tag">htb-derailed</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ruby " class="post-tag">ruby</a> <a href="/tags#rails " class="post-tag">rails</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#idor " class="post-tag">idor</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#wasm " class="post-tag">wasm</a> <a href="/tags#webassembly " class="post-tag">webassembly</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#wasm-bof " class="post-tag">wasm-bof</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#cors " class="post-tag">cors</a> <a href="/tags#chatgpt " class="post-tag">chatgpt</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#open-injection " class="post-tag">open-injection</a> <a href="/tags#open-injection-ruby " class="post-tag">open-injection-ruby</a> <a href="/tags#openmediavault " class="post-tag">openmediavault</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#deb " class="post-tag">deb</a> <a href="/tags#deb-package " class="post-tag">deb-package</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-investigation " class="post-tag">htb-investigation</a> <a href="/tags#htb-pikaboo " class="post-tag">htb-pikaboo</a> <a href="/tags#htb-onetwoseven " class="post-tag">htb-onetwoseven</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/derailed-cover.webp" />
    <img loading="lazy" src="/img/derailed-cover.png" alt="Derailed" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Derailed starts with a Ruby on Rails web notes application. I’m able to create notes, and to flag notes for review by an admin. The general user input is relatively locked down as far as cross site scripting, but I’ll find a buffer overflow in the webassembly that puts the username on the page and use that to get a XSS payload overwriting the unfiltered date string. From there, I’ll use the administrator’s browser session to read an admin page with a file read vulnerability where I can get the page source, and abuse an open injection in Ruby (just like in Perl) to get execution. I’ll pivot uses using creds from the database. To get root, I’ll exploit openmediavault’s RPC, showing three different ways - adding an SSH key for root, creating a cron, and installing a Debian package. In Beyond Root, I’ll debug the webassembly in Chromium dev tools.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 15, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/07/15/htb-socket.html">
                HTB: Socket
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-socket " class="post-tag">htb-socket</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#qrcode " class="post-tag">qrcode</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#websocket " class="post-tag">websocket</a> <a href="/tags#python-websockets " class="post-tag">python-websockets</a> <a href="/tags#pyinstaller " class="post-tag">pyinstaller</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-proxy " class="post-tag">burp-proxy</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#burp-repeater-websocket " class="post-tag">burp-repeater-websocket</a> <a href="/tags#websocket-sqli " class="post-tag">websocket-sqli</a> <a href="/tags#username-anarchy " class="post-tag">username-anarchy</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#pyinstaller-spec " class="post-tag">pyinstaller-spec</a> <a href="/tags#pyinstxtractor " class="post-tag">pyinstxtractor</a> <a href="/tags#pycdc " class="post-tag">pycdc</a> <a href="/tags#htb-forgot " class="post-tag">htb-forgot</a> <a href="/tags#htb-absolute " class="post-tag">htb-absolute</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/socket-cover.webp" />
    <img loading="lazy" src="/img/socket-cover.png" alt="Socket" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Socket has a web application for a company that makes a QRcode encoding / decoding software. I’ll download both the Linux and Windows application, and through dynamic analysis, see web socket connections to the box. I’ll find a SQLite injection over the websocket and leak a password and username that can be used for SSH. That user is able to run the PyInstaller build process as root, and I’ll abuse that to read files, and get a shell. In Beyond Root, I’ll look at pulling the Python source code from the application, even though I didn’t need that to solve the box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 8, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/07/08/htb-inject.html">
                HTB: Inject
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-inject " class="post-tag">htb-inject</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#spring-cloud-function-spel-injection " class="post-tag">spring-cloud-function-spel-injection</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#java-sprint " class="post-tag">java-sprint</a> <a href="/tags#maven " class="post-tag">maven</a> <a href="/tags#snyk " class="post-tag">snyk</a> <a href="/tags#spring-cloud-function-web " class="post-tag">spring-cloud-function-web</a> <a href="/tags#cve-2022-22963 " class="post-tag">cve-2022-22963</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#brace-expansion " class="post-tag">brace-expansion</a> <a href="/tags#ansible " class="post-tag">ansible</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#ansible-playbook " class="post-tag">ansible-playbook</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/inject-cover.webp" />
    <img loading="lazy" src="/img/inject-cover.png" alt="Inject" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Inject has a website with a file read vulnerability that allows me to read the source code for the site. The source leaks that it’s using SpringBoot, and have a vulnerable library in use that allows me to get remote code execution. I’ll show how to identify this vulnerability both manually and using Snyk. The root step is about abusing a cron that’s running the Ansible automation framework.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 1, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/07/01/htb-pollution.html">
                HTB: Pollution
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-pollution " class="post-tag">htb-pollution</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#redis " class="post-tag">redis</a> <a href="/tags#redis-cli " class="post-tag">redis-cli</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#mybb " class="post-tag">mybb</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-history-export " class="post-tag">burp-history-export</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#htpasswd " class="post-tag">htpasswd</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#php-filter-injection " class="post-tag">php-filter-injection</a> <a href="/tags#php-fpm " class="post-tag">php-fpm</a> <a href="/tags#fastcgi " class="post-tag">fastcgi</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#snyk " class="post-tag">snyk</a> <a href="/tags#prototype-pollution " class="post-tag">prototype-pollution</a> <a href="/tags#htb-updown " class="post-tag">htb-updown</a> <a href="/tags#htb-encoding " class="post-tag">htb-encoding</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/pollution-cover.webp" />
    <img loading="lazy" src="/img/pollution-cover.png" alt="Pollution" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Pollution starts off with a website where I can find a token in a forum post that has a Burp history export attached. With that token, I can escalate my account to admin, and get access to an endpoint vulnerable to XML external entity (XXE) injection. With that, I’ll read files, including the source code for the site to get access to redis, where I’ll modify my state to get access to the developers site. That site has a PHP local file include (LFI) that I can exploit with filter injection to get code execution. This filter injection technique has become popular, but was relatively unknown at the time of Pollution’s release. I’ll pivot to the next user by exploiting PHP’s FastCGI Process Manager (PHP-FPM), where I’ll get access to the source code for a NodeJS / Express API in development. That API has a prototpye pollution vulnerability, which I can exploit to get execution and a shell as root. In beyond root, I take a quick look at the max length of a URL encountered during the XXE exploit.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 24, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/06/24/htb-stocker.html">
                HTB: Stocker
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-stocker " class="post-tag">htb-stocker</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#chatgpt " class="post-tag">chatgpt</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#nosql " class="post-tag">nosql</a> <a href="/tags#nosql-auth-bypass " class="post-tag">nosql-auth-bypass</a> <a href="/tags#nosql-injection " class="post-tag">nosql-injection</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#serverside-xss " class="post-tag">serverside-xss</a> <a href="/tags#pdf " class="post-tag">pdf</a> <a href="/tags#file-read " class="post-tag">file-read</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/stocker-cover.webp" />
    <img loading="lazy" src="/img/stocker-cover.png" alt="Stocker" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Stocker starts out with a NoSQL injection allowing me to bypass login on the dev website. From there, I’ll exploit purchase order generation via a serverside cross site scripting in the PDF generation that allows me to read files from the host. I’ll get the application source and use a password it contains to get a shell on the box. The user can run some NodeJS scripts as root, but the sudo rule is misconfiguration that allows me to run arbirtray JavaScript, and get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 17, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/06/17/htb-escape.html">
                HTB: Escape
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-escape " class="post-tag">htb-escape</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#mssqlclient " class="post-tag">mssqlclient</a> <a href="/tags#xp-cmdshell " class="post-tag">xp-cmdshell</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#net-ntlmv2 " class="post-tag">net-ntlmv2</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#certify " class="post-tag">certify</a> <a href="/tags#adcs " class="post-tag">adcs</a> <a href="/tags#rubeus " class="post-tag">rubeus</a> <a href="/tags#certipy " class="post-tag">certipy</a> <a href="/tags#silver-ticket " class="post-tag">silver-ticket</a> <a href="/tags#pass-the-hash " class="post-tag">pass-the-hash</a> <a href="/tags#xp-dirtree " class="post-tag">xp-dirtree</a> <a href="/tags#htb-querier " class="post-tag">htb-querier</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> <a href="/tags#htb-proper " class="post-tag">htb-proper</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/escape-cover.webp" />
    <img loading="lazy" src="/img/escape-cover.png" alt="Escape" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Escape is a very Windows-centeric box focusing on MSSQL Server and Active Directory Certificate Services (ADCS). I’ll start by finding some MSSQL creds on an open file share. With those, I’ll use xp_dirtree to get a Net-NTLMv2 challenge/response and crack that to get the sql_svc password. That user has access to logs that contain the next user’s creds. To get administrator, I’ll attack active directory certificate services, showing both certify and certipy. In Beyond Root, I’ll show an alternative vector using a silver ticket attack from the first user to get file read as administrator through MSSQL.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 10, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/06/10/htb-soccer.html">
                HTB: Soccer
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-soccer " class="post-tag">htb-soccer</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#ferobuster " class="post-tag">ferobuster</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#tiny-file-manager " class="post-tag">tiny-file-manager</a> <a href="/tags#default-creds " class="post-tag">default-creds</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#websocket " class="post-tag">websocket</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#websocket-sqli " class="post-tag">websocket-sqli</a> <a href="/tags#boolean-based-sqli " class="post-tag">boolean-based-sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#doas " class="post-tag">doas</a> <a href="/tags#dstat " class="post-tag">dstat</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/soccer-cover.webp" />
    <img loading="lazy" src="/img/soccer-cover.png" alt="Soccer" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Soccer starts with a website that is managed over Tiny File Manager. On finding the default credentials, I’ll use that to upload a webshell and get a shell on the box. With this foothold, I’ll identify a second virtual host with a new site. That site uses websockets to do a validation task. I’ll exploit an SQL injection over the websocket to leak a password and get a shell over SSH. The user is able to run dstat as root using doas, which I’ll exploit by crafting a malicious plugin.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 7, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/06/07/htb-twomillion.html">
                HTB: TwoMillion
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-twomillion " class="post-tag">htb-twomillion</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#cve-2023-0386 " class="post-tag">cve-2023-0386</a> <a href="/tags#htb-invite-challenge " class="post-tag">htb-invite-challenge</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/twomillion-cover.webp" />
    <img loading="lazy" src="/img/twomillion-cover.png" alt="TwoMillion" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>TwoMillion is a special release from HackTheBox to celebrate 2,000,000 HackTheBox members. It released directly to retired, so no points and no bloods, just for run. It features a website that looks like the original HackTheBox platform, including the original invite code challenge that needed to be solved in order to register. Once registered, I’ll enumerate the API to find an endpoint that allows me to become an administrator, and then find a command injection in another admin endpoint. I’ll use database creds to pivot to the next user, and a kernel exploit to get to root. In Beyond Root, I’ll look at another easter egg challenge with a thank you message, and a YouTube video exploring the webserver and it’s vulnerabilities.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 3, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/06/03/htb-bagel.html">
                HTB: Bagel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-bagel " class="post-tag">htb-bagel</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#websocket " class="post-tag">websocket</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#proc " class="post-tag">proc</a> <a href="/tags#wscat " class="post-tag">wscat</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#json " class="post-tag">json</a> <a href="/tags#json-deserialization " class="post-tag">json-deserialization</a> <a href="/tags#dotnet-deserialization " class="post-tag">dotnet-deserialization</a> <a href="/tags#json-net " class="post-tag">json.net</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/bagel-cover.webp" />
    <img loading="lazy" src="/img/bagel-cover.png" alt="Bagel" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Bagel is centered around two web apps. The first is a Flask server. I’ll exploit a file read vulnerability to locate and retrieve the source. In that source, I see how it connects to the other .NET server over web sockets. I’ll abuse the first file read to get the DLL for that server. On reversing that DLL, I’ll find a JSON derserialization issue, and exploit it to get file read and the user’s SSH key. I’ll pivot to the next user using creds from the DLL. To get root, I’ll exploit a sudo rule that let’s the user run dotnet as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 27, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/05/27/htb-absolute.html">
                HTB: Absolute
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-absolute " class="post-tag">htb-absolute</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#dnsenum " class="post-tag">dnsenum</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#username-anarchy " class="post-tag">username-anarchy</a> <a href="/tags#kerbrute " class="post-tag">kerbrute</a> <a href="/tags#as-rep-roast " class="post-tag">as-rep-roast</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#kinit " class="post-tag">kinit</a> <a href="/tags#klist " class="post-tag">klist</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#bloudhound-python " class="post-tag">bloudhound-python</a> <a href="/tags#rpc " class="post-tag">rpc</a> <a href="/tags#dynamic-reversing " class="post-tag">dynamic-reversing</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#shadow-credential " class="post-tag">shadow-credential</a> <a href="/tags#certipy " class="post-tag">certipy</a> <a href="/tags#krbrelay " class="post-tag">krbrelay</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#runascs " class="post-tag">runascs</a> <a href="/tags#krbrelayup " class="post-tag">krbrelayup</a> <a href="/tags#rubeus " class="post-tag">rubeus</a> <a href="/tags#dcsync " class="post-tag">dcsync</a> <a href="/tags#htb-outdated " class="post-tag">htb-outdated</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/absolute-cover.webp" />
    <img loading="lazy" src="/img/absolute-cover.png" alt="Absolute" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Absolute is a much easier box to solve today than it was when it first released in September 2022. At that time, many of the tools necessary to solve the box didn’t support Kerberos authentication, forcing the place to figure out ways to make things work. Still, even today, it’s a maze of Windows enumeration and exploitation that starts with some full names in the metadata of images. I’ll figure out the username format for the domain, and AS-REP-Roast to get creds. LDAP enumeration leads to the next set of creds. Access to a share provides a Nim binary, where some dynamic analysis provides yet another set of creds. This user is able to modify a group and from there modify a user to add a shadow credential and finally get a shell on the box. To get administrator access, I’ll abuse relaying Kerberos, showing both KrbRelay to add a user to the administrators group, and KrbRelayUp to get the machine account hash and do a DC sync attack.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 20, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/05/20/htb-precious.html">
                HTB: Precious
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-precious " class="post-tag">htb-precious</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#ruby " class="post-tag">ruby</a> <a href="/tags#phusion " class="post-tag">phusion</a> <a href="/tags#passenger " class="post-tag">passenger</a> <a href="/tags#nginx " class="post-tag">nginx</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#pdfkit " class="post-tag">pdfkit</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#cve-2022-25765 " class="post-tag">cve-2022-25765</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#bundler " class="post-tag">bundler</a> <a href="/tags#yaml-deserialization " class="post-tag">yaml-deserialization</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/precious-cover.webp" />
    <img loading="lazy" src="/img/precious-cover.png" alt="Precious" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Precious is on the easier side of boxes found on HackTheBox. It starts with a simple web page that takes a URL and generates a PDF. I’ll use the metadata from the resulting PDF to identify the technology in use, and find a command injection exploit to get a foothold on the box. Then I’ll find creds in a Ruby Bundler configuration file to get to user. To get to root, I’ll exploit a yaml deserialization vulnerability in a script meant to manage dependencies. In Beyond Root, I’ll explore the Ruby web application, how it’s hosted, and fix the bug that doesn’t allow me to fetch a PDF of the page itself.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 13, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/05/13/htb-interface.html">
                HTB: Interface
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-interface " class="post-tag">htb-interface</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#next-js " class="post-tag">next-js</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#dompdf " class="post-tag">dompdf</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#cve-2022-28368 " class="post-tag">cve-2022-28368</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#arithmetic-expression-injection " class="post-tag">arithmetic-expression-injection</a> <a href="/tags#quoted-expressinion-injection " class="post-tag">quoted-expressinion-injection</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#symbolic-link " class="post-tag">symbolic-link</a> <a href="/tags#htb-rope " class="post-tag">htb-rope</a> <a href="/tags#htb-wall " class="post-tag">htb-wall</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/interface-cover.webp" />
    <img loading="lazy" src="/img/interface-cover.png" alt="Interface" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Interface starts with a site and an API that, after some fuzzing / enumeration, can be found to offer an endpoint to upload HTML and get back a PDF, converted by DomPDF. I’ll exploit a vulnerability in DomPDF to get a font file into a predictable location, and poison that binary file with a PHP webshell. To escalate, I’ll abuse a cleanup script with Arithmetic Expression Injection, which abuses the <code class="language-plaintext highlighter-rouge">[[ "$VAR" -eq "something" ]]</code> syntax in Bash scripts. In Beyond Root, I’ll look at an unintended abuse of another cleanup script and how symbolic links could (before the box was patched) be used to overwrite and change the ownership of arbitrary files.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 6, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/05/06/htb-flight.html">
                HTB: Flight
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-flight " class="post-tag">htb-flight</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#apache " class="post-tag">apache</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#net-ntlmv2 " class="post-tag">net-ntlmv2</a> <a href="/tags#password-spray " class="post-tag">password-spray</a> <a href="/tags#lookupsid " class="post-tag">lookupsid</a> <a href="/tags#rpc " class="post-tag">rpc</a> <a href="/tags#ntlm-theft " class="post-tag">ntlm-theft</a> <a href="/tags#runascs " class="post-tag">runascs</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#rubeus " class="post-tag">rubeus</a> <a href="/tags#machine-account " class="post-tag">machine-account</a> <a href="/tags#dcsync " class="post-tag">dcsync</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#psexec " class="post-tag">psexec</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/flight-cover.webp" />
    <img loading="lazy" src="/img/flight-cover.png" alt="Flight" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Flight is a Windows-centered box that puts a unique twist by showing both a Apache and PHP website as well as an internal IIS / ASPX website. I’ll get the PHP site to connect back to my server on SMB, leaking a Net NTLMv2, and crack that to get a plaintext password. I’ll get a list of domain users over RPC, and password spray that password to find another user using the same password. That user has write access to a share, where I’ll drop files designed to provoke another auth back to my server to catch another Net NTLMv2. That user has access to the new IIS site, and can write an ASPX webshell to get a shell as the IIS account. As a service account, it will authenticate over the network as the machine account. I’ll abuse that to get the administrator’s hash and from there a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 29, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/04/29/htb-metatwo.html">
                HTB: MetaTwo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-metatwo " class="post-tag">htb-metatwo</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#bookingpress " class="post-tag">bookingpress</a> <a href="/tags#cve-2022-0739 " class="post-tag">cve-2022-0739</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#cve-2021-29447 " class="post-tag">cve-2021-29447</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#passpie " class="post-tag">passpie</a> <a href="/tags#pgp " class="post-tag">pgp</a> <a href="/tags#gpg " class="post-tag">gpg</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/metatwo-cover.webp" />
    <img loading="lazy" src="/img/metatwo-cover.png" alt="MetaTwo" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>MetaTwo starts with a simple WordPress blog using the BookingPress plugin to manage booking events. I’ll find an unauthenticated SQL injection in that plugin and use it to get access to the WP admin panel as an account that can manage media uploads. I’ll exploit an XML external entity (XXE) injection to read files from the host, reading the WP configuration, and getting the creds for the FTP server. On the FTP server I’ll find a script that is sending emails, and use the creds from that to get a shell on the host. The user has a Passpie instance that stores the root password. I’ll crack the PGP key protecting the password and get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 22, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/04/22/htb-investigation.html">
                HTB: Investigation
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-investigation " class="post-tag">htb-investigation</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#cve-2022-23935 " class="post-tag">cve-2022-23935</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#perl " class="post-tag">perl</a> <a href="/tags#open-injection " class="post-tag">open-injection</a> <a href="/tags#open-injection-perl " class="post-tag">open-injection-perl</a> <a href="/tags#event-logs " class="post-tag">event-logs</a> <a href="/tags#msgconvert " class="post-tag">msgconvert</a> <a href="/tags#mutt " class="post-tag">mutt</a> <a href="/tags#mbox " class="post-tag">mbox</a> <a href="/tags#evtx-dump " class="post-tag">evtx-dump</a> <a href="/tags#jq " class="post-tag">jq</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#race-condition " class="post-tag">race-condition</a> <a href="/tags#htb-pikaboo " class="post-tag">htb-pikaboo</a> <a href="/tags#htb-meta " class="post-tag">htb-meta</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/investigation-cover.webp" />
    <img loading="lazy" src="/img/investigation-cover.png" alt="Investigation" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Investigation starts with a website that accepts user uploaded images and runs Exiftool on them. This version has a command injection. I’ll dig into that vulnerability, and then exploit it to get a foothold. Then I find a set of Windows event logs, and analyze them to extract a password. Finally, I find a piece of malware that runs as root and understand it to get execution.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 15, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/04/15/htb-encoding.html">
                HTB: Encoding
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-encoding " class="post-tag">htb-encoding</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#php-filter-injection " class="post-tag">php-filter-injection</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#git-manual " class="post-tag">git-manual</a> <a href="/tags#gitdumper " class="post-tag">gitdumper</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#proxy " class="post-tag">proxy</a> <a href="/tags#uri-structure " class="post-tag">uri-structure</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#git-hooks " class="post-tag">git-hooks</a> <a href="/tags#systemd " class="post-tag">systemd</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#chatgpt " class="post-tag">chatgpt</a> <a href="/tags#parse-url " class="post-tag">parse_url</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/encoding-cover.webp" />
    <img loading="lazy" src="/img/encoding-cover.png" alt="Encoding" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Encoding centered around a web application where I’ll first identify a file read vulnerability, and leverage that to exfil a git repo from a site that I can’t directly access. With that repo, I’ll identify a new web URL that has a local file include vulnerability, and leverage a server-side request forgery to hit that and get execution using php filter injection. To get to the next user I’ll install a malicious git hook. That user is able to create and start services, which I’ll abuse to get root. In Beyond root, I’ll look at an SSRF that worked for IppSec but not me, and show how we troubleshot it to find some unexpected behavior from the PHP <code class="language-plaintext highlighter-rouge">parse_url</code> function.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 8, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/04/08/htb-broscience.html">
                HTB: BroScience
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-broscience " class="post-tag">htb-broscience</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#dotdotpwn " class="post-tag">dotdotpwn</a> <a href="/tags#psql " class="post-tag">psql</a> <a href="/tags#postgres " class="post-tag">postgres</a> <a href="/tags#php-deserialization " class="post-tag">php-deserialization</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#openssl " class="post-tag">openssl</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/broscience-cover.webp" />
    <img loading="lazy" src="/img/broscience-cover.png" alt="BroScience" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Hacking BroScience involves using a directory traversal / file read vulnerability (minus points to anyone who calls it an LFI) to get the PHP source for a website. First I’ll use that code to forge an activation token allowing me to register my account. Then, the source gives the information necessary to exploit a deserialization vulnerability by building a malicious PHP serialized object, encoding it, and sending it as my cookie. This provides a webshell and a shell on the box. I’ll find some hashes in the database that can be cracked, leading to the next user. The wrinkle here is to include the site-wide salt. For root, there’s a command injection in a script that’s checking for certificate expiration. I’ll craft a malicious certificate that performs the injection to get execution as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 1, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/04/01/htb-sekhmet.html">
                HTB: Sekhmet
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-sekhmet " class="post-tag">htb-sekhmet</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#json-deserialization " class="post-tag">json-deserialization</a> <a href="/tags#modsecurity " class="post-tag">modsecurity</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#bypass " class="post-tag">bypass</a> <a href="/tags#sssd " class="post-tag">sssd</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#zipcrypto " class="post-tag">zipcrypto</a> <a href="/tags#bkcrack " class="post-tag">bkcrack</a> <a href="/tags#known-plaintext " class="post-tag">known-plaintext</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#kinit " class="post-tag">kinit</a> <a href="/tags#klist " class="post-tag">klist</a> <a href="/tags#ksu " class="post-tag">ksu</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#proxychains " class="post-tag">proxychains</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#watch " class="post-tag">watch</a> <a href="/tags#tmux " class="post-tag">tmux</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#password-spray " class="post-tag">password-spray</a> <a href="/tags#kerbrute " class="post-tag">kerbrute</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#dpapi " class="post-tag">dpapi</a> <a href="/tags#mimikatz " class="post-tag">mimikatz</a> <a href="/tags#pypykatz " class="post-tag">pypykatz</a> <a href="/tags#edge-saved-passwords " class="post-tag">edge-saved-passwords</a> <a href="/tags#applocker " class="post-tag">applocker</a> <a href="/tags#applocker-bypass " class="post-tag">applocker-bypass</a> <a href="/tags#sharp-chromium " class="post-tag">sharp-chromium</a> <a href="/tags#sharp-collection " class="post-tag">sharp-collection</a> <a href="/tags#htb-hathor " class="post-tag">htb-hathor</a> <a href="/tags#htb-anubis " class="post-tag">htb-anubis</a> <a href="/tags#htb-celestial " class="post-tag">htb-celestial</a> <a href="/tags#htb-nodeblog " class="post-tag">htb-nodeblog</a> <a href="/tags#htb-ransom " class="post-tag">htb-ransom</a> <a href="/tags#htb-access " class="post-tag">htb-access</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="/img/sekhmet-cover.webp" />
    <img loading="lazy" src="/img/sekhmet-cover.png" alt="Sekhmet" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Sekhmet has Windows and Linux exploitation, and a lot of Kerberos. I’ll start exploiting a ExpressJS website vulnable to a JSON deserialization attack. To get execution, I’ll have to bypass a ModSecurity web application firewall. This lands me in a Linux VM. In the VM, I’ll find a backup archive and break the encryption using a known plaintext attack on ZipCrypto to get another user’s domain hash. On cracking that, I’m able to get root on the VM. As the domain user, I’ll access a share, and figure that there’s a text file being updated based on the mobile attribute for four users in the AD environment. There’s a command injection in the script that’s updating, and I’ll use that to get a hash for the user running the script. After password spraying that password to find another user, I’ll get access to the host and find DPAPI protected creds in the user’s Edge instance. On cracking those, I get domain admin credentials.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 25, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/03/25/htb-vessel.html">
                HTB: Vessel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-vessel " class="post-tag">htb-vessel</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#gitdumper " class="post-tag">gitdumper</a> <a href="/tags#express-escape-functions " class="post-tag">express-escape-functions</a> <a href="/tags#escape-functions " class="post-tag">escape-functions</a> <a href="/tags#mysqljs " class="post-tag">mysqljs</a> <a href="/tags#mysqljs-escape-functions " class="post-tag">mysqljs-escape-functions</a> <a href="/tags#cve-2022-24637 " class="post-tag">CVE-2022-24637</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#github " class="post-tag">github</a> <a href="/tags#mass-assignment " class="post-tag">mass-assignment</a> <a href="/tags#log-poisoning " class="post-tag">log-poisoning</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pyinstaller " class="post-tag">pyinstaller</a> <a href="/tags#pyinstxtractor " class="post-tag">pyinstxtractor</a> <a href="/tags#uncompyle6 " class="post-tag">uncompyle6</a> <a href="/tags#python-pyside2 " class="post-tag">python-pyside2</a> <a href="/tags#python-qt " class="post-tag">python-qt</a> <a href="/tags#pdfcrack " class="post-tag">pdfcrack</a> <a href="/tags#cve-2022-0811 " class="post-tag">cve-2022-0811</a> <a href="/tags#virus-total " class="post-tag">virus-total</a> <a href="/tags#pinns " class="post-tag">pinns</a> <a href="/tags#crio " class="post-tag">crio</a> <a href="/tags#kernel-parameters " class="post-tag">kernel-parameters</a> <a href="/tags#crashdump " class="post-tag">crashdump</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-updown " class="post-tag">htb-updown</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/vessel-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/vessel-cover.png" alt="Vessel-cover" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Vessel is a really clever box with some nice design. Several of the bugs are publicly disclosed, but at the time of release didn’t have public exploit, so they required digging into the tech to figure out how to abuse them. I’ll start by pulling a git repo from the website, and find an unsafe call to MySQL from Express. This bug is surprising, as the code looks good, and I’ll dig into it more in Beyond Root. After abusing the type confusion to get SQL injection and a hash, I’ll log in and find a link to a new subdomain hosting an instance of Open Web Analytics. I’ll abuse an information discloser vulnerability to get admin access to OWA, and then a mass assignment vuln to move a log into a web-accessible directory and poison that log to get execution and a shell. I’ll reverse a PyInstaller-generated exe to recover a password to pivot to the next user. From there, I’ll abuse a SetUID binary that’s part of CRI-O to change kernel parameters and get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 18, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/03/18/htb-extension.html">
                HTB: Extension
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-extension " class="post-tag">htb-extension</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#password-reset " class="post-tag">password-reset</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#roundcube " class="post-tag">roundcube</a> <a href="/tags#gitea " class="post-tag">gitea</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#laravel-csrf " class="post-tag">laravel-csrf</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#idor " class="post-tag">idor</a> <a href="/tags#firefox-extension " class="post-tag">firefox-extension</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#firefox-dev-tools " class="post-tag">firefox-dev-tools</a> <a href="/tags#gitea-api " class="post-tag">gitea-api</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#hash-extension " class="post-tag">hash-extension</a> <a href="/tags#hash-extender " class="post-tag">hash-extender</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#deepce " class="post-tag">deepce</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#docker-escape " class="post-tag">docker-escape</a> <a href="/tags#docker-sock " class="post-tag">docker-sock</a> <a href="/tags#htb-altered " class="post-tag">htb-altered</a> <a href="/tags#htb-backend " class="post-tag">htb-backend</a> <a href="/tags#htb-backendtwo " class="post-tag">htb-backendtwo</a> <a href="/tags#htb-ransom " class="post-tag">htb-ransom</a> <a href="/tags#htb-intense " class="post-tag">htb-intense</a> <a href="/tags#htb-feline " class="post-tag">htb-feline</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/extension-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/extension-cover.png" alt="Extension" style="float: right; margin-right:50px; margin-left:50px; height:150px;" class="include_image " />
</picture>

<p>Extension has multiple really creative attack vectors with some unique features. I’ll start by leaking usernames and hashes, getting access to the site and to the email box for a few users. Abusing an IDOR vulnerability I’ll identify the user that I need to get access as next. I’ll enumerate the password reset functionality, and notice that only the last few characters of the token sent each time are changing. I’m not able to brute force a single token, but I can submit hundreds of resets set the odds such that I can guess a valid on in only a few guesses. With this access, I get creds for a Gitea instance, where I’ll find a custom Firefox extension. I’ll abuse that extension, bypassing the cross site scripting filters to hit the Gitea API and pull down a backup file from another user. That backup gives SSH access to the host, and some password reuse pivots to the next user. With this access, I’ll identify a hash extension vulnerability in the web application, and abuse that to access a command injection and get RCE in the website container. The Docker socket inside the container is writable, allowing for a simple container breakout.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 11, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/03/11/htb-mentor.html">
                HTB: Mentor
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-mentor " class="post-tag">htb-mentor</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#fastapi " class="post-tag">fastapi</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#snmp-brute " class="post-tag">snmp-brute</a> <a href="/tags#onesixtyone " class="post-tag">onesixtyone</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#snmpbulkwalk " class="post-tag">snmpbulkwalk</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#postgresql " class="post-tag">postgresql</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#psql " class="post-tag">psql</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#htb-forgot " class="post-tag">htb-forgot</a> <a href="/tags#htb-sneaky " class="post-tag">htb-sneaky</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/mentor-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/mentor-cover.png" alt="Mentor" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Mentor focuses on abusing a FastAPI API and SNMP enumeration. I’ll brute force a second community string that gives more access than the default “public” string. With that, I’ll get access to the running process command lines, and recover a password. With that password, I can get a valid auth token to the API, and find a backup endpoint that has a command injection vulnerability, which I’ll exploit to get a shell. From inside the web container, I’ll find creds for the database and dump the users table. On cracking the hash for one user, I can get SSH access to the host. For root, I’ll find a password in the SNMP configuration.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 4, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/03/04/htb-forgot.html">
                HTB: Forgot
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-forgot " class="post-tag">htb-forgot</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-proxy " class="post-tag">burp-proxy</a> <a href="/tags#varnish " class="post-tag">varnish</a> <a href="/tags#cache " class="post-tag">cache</a> <a href="/tags#cache-abuse " class="post-tag">cache-abuse</a> <a href="/tags#web-cache-deception " class="post-tag">web-cache-deception</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#host-header-injection " class="post-tag">host-header-injection</a> <a href="/tags#htb-response " class="post-tag">htb-response</a> <a href="/tags#tensorflow " class="post-tag">tensorflow</a> <a href="/tags#cve-2022-29216 " class="post-tag">cve-2022-29216</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/forgot-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/forgot-cover.png" alt="Forgot" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Forgot starts with a host-header injection that allows me to reset a users password and have the link sent to them be to my webserver. From there, I’ll abuse some wildcard routes and a Varnish cache to get a cached version of the admin page, which leaks SSH creds. To get to root, I’ll abuse an unsafe eval in TensorFlow in a script designed to check for XSS.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 25, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/02/25/htb-awkward.html">
                HTB: Awkward
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-awkward " class="post-tag">htb-awkward</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#webpack " class="post-tag">webpack</a> <a href="/tags#vuejs " class="post-tag">vuejs</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#auth-bypass " class="post-tag">auth-bypass</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#jwt-io " class="post-tag">jwt-io</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#express-api " class="post-tag">express-api</a> <a href="/tags#awk " class="post-tag">awk</a> <a href="/tags#awk-injection " class="post-tag">awk-injection</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#hashcat-jwt " class="post-tag">hashcat-jwt</a> <a href="/tags#python-jwt " class="post-tag">python-jwt</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#python-requests " class="post-tag">python-requests</a> <a href="/tags#xpad " class="post-tag">xpad</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#mail " class="post-tag">mail</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#pm2 " class="post-tag">pm2</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/awkward-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/awkward-cover.png" alt="Awkward" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Awkward involves abusing a NodeJS API over and over again. I’ll start by bypassing the auth check, and using that to find an API where I can dump user hashes. I’ll find another API where I can get it to do a SSRF, and read internal documentation about the API. In that documentation, I’ll spot an awk injection that leads to a file disclosure vulnerability. With that, I’ll locate a backup archive and get a password from a config file that allows for SSH access. To pivot to root, I’ll abuse the website again with symlinks to have it write to a file that I can’t modify, which triggers an email being sent. I’ll write a command injection payload to get execution as root. In Beyond Root, I’ll show two unintended ways that involved getting a shell as www-data. One was patched two days after release, so I’ll show how I make the machine vulnerable again. The other is a sed parameter injection.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 18, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/02/18/htb-rainyday.html">
                HTB: RainyDay
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-rainyday " class="post-tag">htb-rainyday</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#idor " class="post-tag">idor</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#foxyproxy " class="post-tag">foxyproxy</a> <a href="/tags#socks " class="post-tag">socks</a> <a href="/tags#proxychains " class="post-tag">proxychains</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#flask-cookie " class="post-tag">flask-cookie</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-requests " class="post-tag">python-requests</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#flask-unsign " class="post-tag">flask-unsign</a> <a href="/tags#jail " class="post-tag">jail</a> <a href="/tags#python-use-after-free " class="post-tag">python-use-after-free</a> <a href="/tags#unicode " class="post-tag">unicode</a> <a href="/tags#emoji " class="post-tag">emoji</a> <a href="/tags#john-rules " class="post-tag">john-rules</a> <a href="/tags#htb-scanned " class="post-tag">htb-scanned</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/rainyday-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/rainyday-cover.png" alt="RainyDay" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>RainyDay is a different kind of machine from HackTheBox. It’s got a lot of enumerating and fuzzing to find next steps and a fair amount of programming required to solve. I’ll start by exploiting an IDOR vulnerability to leak hashes, cracking one and getting access to a website that manages containers. From inside a container, I can reach a dev instance and an API that effectively let’s me apply a given regex to a file on the filesystem, which I’ll turn into a file read exploit with some Python scripting. From there I can leak the flask secret key and get into another user’s account, where I’ll find a misconfiguration that allows me to escape the container’s jail and read the user’s private SSH key. From the host, I’ll first exploit Python itself to get execution as the next user. Then I’ll abuse unicode characters to slip more characters than allowed into a hashing program, and use that to brute force a secret salt, allowing me to crash the root hash. In Beyond Root, I’ll look at a mistake that allowed for skipping a large part of this box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 11, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/02/11/htb-photobomb.html">
                HTB: Photobomb
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-photobomb " class="post-tag">htb-photobomb</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#bash-test " class="post-tag">bash-test</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#image-magick " class="post-tag">image-magick</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#bash-builtins " class="post-tag">bash-builtins</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/photobomb-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/photobomb-cover.png" alt="Photobomb" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Photobomb was on the easy end of HackTheBox weekly machines. I’ll find credentials in a JavaScript file, and use those to get access to an image manipulation panel. There’s a command injection vulnerability in the panel, which I’ll use to get execution and a shell. For privesc, the user can run a script as root, and there are two ways to get execution from this. The first is a find command that is called without the full path. The second is abusing the disabled Bash builtin [.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 4, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/02/04/htb-response.html">
                HTB: Response
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-response " class="post-tag">htb-response</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#burp-proxy " class="post-tag">burp-proxy</a> <a href="/tags#hmac " class="post-tag">hmac</a> <a href="/tags#oracle " class="post-tag">oracle</a> <a href="/tags#foxy-proxy " class="post-tag">foxy-proxy</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#proxy " class="post-tag">proxy</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#socket-io " class="post-tag">socket-io</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#ldif " class="post-tag">ldif</a> <a href="/tags#ldapadd " class="post-tag">ldapadd</a> <a href="/tags#ldappasswd " class="post-tag">ldappasswd</a> <a href="/tags#chatgpt " class="post-tag">chatgpt</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#forensics " class="post-tag">forensics</a> <a href="/tags#cross-protocol-request-forgery " class="post-tag">cross-protocol-request-forgery</a> <a href="/tags#cprf " class="post-tag">cprf</a> <a href="/tags#xp-ssrf " class="post-tag">xp-ssrf</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#htb-luke " class="post-tag">htb-luke</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#python-https " class="post-tag">python-https</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#smtp " class="post-tag">smtp</a> <a href="/tags#python-smptd " class="post-tag">python-smptd</a> <a href="/tags#virus-total " class="post-tag">virus-total</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#mettle " class="post-tag">mettle</a> <a href="/tags#bulk-extractor " class="post-tag">bulk-extractor</a> <a href="/tags#openssh " class="post-tag">openssh</a> <a href="/tags#partial-ssh-key " class="post-tag">partial-ssh-key</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#rsactftool " class="post-tag">rsactftool</a> <a href="/tags#htb-proper " class="post-tag">htb-proper</a> <a href="/tags#htb-crossfittwo " class="post-tag">htb-crossfittwo</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/response-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/response-cover.png" alt="Response" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Response truly lived up to the insane rating, and was quite masterfully crafted. To start, I’ll construct a HTTP proxy that can abuse an SSRF vulnerability and a HMAC digest oracle to proxy traffic into the inner network and a chat application. With access as guest, I’ll find bob is eager to talk to the admin. I’ll redirect the LDAP auth to my host, where my LDAP server will grant access as admin, and I can talk to bob. bob speaks of an FTP server and gives creds, but I can’t access it. I’ll write a JavaScript payload that will above a cross protocol request forgery via a link sent to bob to read credentials off the FTP server. Next I’ll add my host as a computer to get scanned by a scanning program, and exploit a directory traversal in the state name of my TLS certificate to read the next user’s SSH key. Finally, I’ll find a PCAP and a core dump from a meterpreter process. I’ll write a decoder for the traffic, and, after pulling the AES key from the core dump memory, decrypt the traffic and pull a copy of a zip file that was exfiled from root’s home directory. Inside that zip is a screenshot which includes just the bottom of the user’s private key, as well as the authorized_keys file with their public key. I’ll manually parse the two files to get all I need to reconstruct the full private key and get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 28, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/01/28/htb-ambassador.html">
                HTB: Ambassador
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-ambassador " class="post-tag">htb-ambassador</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#grafana " class="post-tag">grafana</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#consul " class="post-tag">consul</a> <a href="/tags#msfconsole " class="post-tag">msfconsole</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ambassador-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ambassador-cover.png" alt="Ambassador" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Ambassador starts off with a Grafana instance. I’ll exploit a directory traversal / file read vulnerability to read the config and get the password for the admin. From the Grafana admin panel, I’ll get creds to the MySQL instance. Logging into that leaks credentials for a developer and I can get a shell with SSH. This developer has access to a git repo that leaks a token used for Consul in an old commit. I’ll use that to interact with Consul and get execution as root. I’ll show doing it both manually as well as using Metasploit.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 21, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/01/21/htb-updown.html">
                HTB: UpDown
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-updown " class="post-tag">htb-updown</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#subdomain " class="post-tag">subdomain</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#gitdumper " class="post-tag">gitdumper</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#phar " class="post-tag">phar</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#php-disable-functions " class="post-tag">php-disable-functions</a> <a href="/tags#php-proc-open " class="post-tag">php-proc_open</a> <a href="/tags#python2-input " class="post-tag">python2-input</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#easy-install " class="post-tag">easy-install</a> <a href="/tags#htb-crimestopper " class="post-tag">htb-crimestopper</a> <a href="/tags#php-filter-injection " class="post-tag">php-filter-injection</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-crimestoppers " class="post-tag">htb-crimestoppers</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/updown-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/updown-cover.png" alt="UpDown" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>UpDown presents a website designed to check the status of other webpages. The obvious attack path is an server-side request forgery, but nothing interesting comes from it. There is a dev subdomain, and I’ll find the git repo associated with it. Using that, I’ll figure out how to bypass the Apache filtering, and find a code execution vulnerability out of an LFI using the PHP Archive (or PHAR) format. With a shell, I’ll exploit a legacy Python script using input, and then get root by abusing easy_install.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 14, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/01/14/htb-shoppy.html">
                HTB: Shoppy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-shoppy " class="post-tag">htb-shoppy</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#nosql-injection " class="post-tag">nosql-injection</a> <a href="/tags#mattermost " class="post-tag">mattermost</a> <a href="/tags#nosql-auth-bypass " class="post-tag">nosql-auth-bypass</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#mongodb " class="post-tag">mongodb</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#docker-group " class="post-tag">docker-group</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-mango " class="post-tag">htb-mango</a> <a href="/tags#htb-nodeblog " class="post-tag">htb-nodeblog</a> <a href="/tags#htb-goodgames " class="post-tag">htb-goodgames</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/shoppy-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/shoppy-cover.png" alt="Shoppy" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Shoppy was one of the easier HackTheBox weekly machines to exploit, though identifying the exploits for the initial foothold could be a bit tricky. I’ll start by finding a website and use a NoSQL injection to bypass the admin login page, and another to dump users and hashes. With a cracked hash, I’ll log into a Mattermost server where I’ll find creds to the box that work for SSH. From there, I’ll need the lighest of reverse enginnering to get a static password from a binary, which gets me to the next user. This user is in the docker group, so I’ll load an image mounting the host file system, and get full disk access. I’ll show two ways to get a shell from that. In Beyond Root, a video walkthrough of the vulnerable web-server code, showing how the injections worked, and fixing them.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 7, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2023/01/07/htb-health.html">
                HTB: Health
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-health " class="post-tag">htb-health</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#redirect " class="post-tag">redirect</a> <a href="/tags#hook " class="post-tag">hook</a> <a href="/tags#gogs " class="post-tag">gogs</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqli-union " class="post-tag">sqli-union</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#sqli-sqlite " class="post-tag">sqli-sqlite</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#sha256 " class="post-tag">sha256</a> <a href="/tags#chatgpt " class="post-tag">chatgpt</a> <a href="/tags#htb-ransom " class="post-tag">htb-ransom</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/health-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/health-cover.png" alt="Health" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Health originally released as easy, but was bumped up to Medium three days later. That’s because there’s a tricky SQL injection that you have to exploit via a redirect, which eliminates things like sqlmap. After using the SSRF into redirect to exploit Gogs and leak the user table, I’ll crack the hash and get SSH access to the box. For root, I’ll exploit a cron that runs through the website by generating tasks directly in the database, bypassing the filtering on the website.</p>

</li>
        







          <li class="post-list-li"><span class="post-meta">Jan 7, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/holidayhack2022/">
                2022 SANS Holiday Hack Challenge, featuring KringleCon V: Golden Rings
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#sans-holiday-hack " class="post-tag">sans-holiday-hack</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hh22-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hh22-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:180px;" class="include_image " />
</picture>

<p>The 2022 SANS Holiday Hack Challenge is a battle to recover the five golden rings stolen from Santa by Grinchum. This all takes place at the North Pole where Santa is hosting the 5th annual KringleCon, including <a href="https://www.sans.org/mlp/holiday-hack-challenge#kringlecon">talks</a> from 11 leaders in the information security community. In addition to the talks, there are six objectives to solve, each consisting of multiple terminals and/or challenges. In solving all of these, I’ll recover the five rings, and in the process clear the magic that’s created Grinchum, turning him back into Smilegol. As usual, the challenges were interesting and set up in such a way that it was very beginner friendly, with lots of hints and talks to ensure that you learned something while solving.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 3, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2022/hard">
                Hackvent 2022 - Hard
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#physical " class="post-tag">physical</a> <a href="/tags#radio " class="post-tag">radio</a> <a href="/tags#universal-radio-hacker " class="post-tag">universal-radio-hacker</a> <a href="/tags#nrz " class="post-tag">nrz</a> <a href="/tags#nrz-s " class="post-tag">nrz-s</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-pil " class="post-tag">python-pil</a> <a href="/tags#python-pyzbar " class="post-tag">python-pyzbar</a> <a href="/tags#pulse-view " class="post-tag">pulse-view</a> <a href="/tags#sigrok " class="post-tag">sigrok</a> <a href="/tags#serial " class="post-tag">serial</a> <a href="/tags#uart " class="post-tag">uart</a> <a href="/tags#7z " class="post-tag">7z</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#john-mask " class="post-tag">john-mask</a> <a href="/tags#hashcat-mask " class="post-tag">hashcat-mask</a> <a href="/tags#aes " class="post-tag">aes</a> <a href="/tags#aes-ecb " class="post-tag">aes-ecb</a> <a href="/tags#heap " class="post-tag">heap</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#unicod " class="post-tag">unicod</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hv22-hard-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hv22-hard-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:150px;" class="include_image " />
</picture>

<p>Days fifteen through twentyone were the hard challenges. There were some really great coding challenges. I loved day sixteen, where I’ll have to check <em>tons</em> of QRcodes to find the flag. And day twenty, where I’ll abuse a unicode bug to brute force padding on an AES encryption. There were couple signals analysis challenges, including a radio wave and serial line decode. There was also a neat trick abusing how zip archives handle long passwords, and a nice relateively beginner-friendly heap exploitation.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 3, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2022/medium">
                Hackvent 2022 - Medium
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#social-media " class="post-tag">social-media</a> <a href="/tags#osint " class="post-tag">osint</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#virus-total " class="post-tag">virus-total</a> <a href="/tags#text4shell " class="post-tag">text4shell</a> <a href="/tags#cve-2022-42889 " class="post-tag">cve-2022-42889</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#tcpdump " class="post-tag">tcpdump</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#postgresql " class="post-tag">postgresql</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#idor " class="post-tag">idor</a> <a href="/tags#aws " class="post-tag">aws</a> <a href="/tags#imds " class="post-tag">imds</a> <a href="/tags#aws-secretsmanager " class="post-tag">aws-secretsmanager</a> <a href="/tags#gtfobin " class="post-tag">gtfobin</a> <a href="/tags#prototype-pollution " class="post-tag">prototype-pollution</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#reflective-xss " class="post-tag">reflective-xss</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hv22-med-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hv22-med-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:150px;" class="include_image " />
</picture>

<p>The medium 2022 Hackvent challenges covered days eight through fourteen, and included one more hidden challenge. They get a bit more into exploitation, with SQL injection, AWS / cloud, prototype pollution, some OSINT, and a really interesting reflective XSS attack.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 3, 2023</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2022/easy">
                Hackvent 2022 - Easy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#qrcode " class="post-tag">qrcode</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-pil " class="post-tag">python-pil</a> <a href="/tags#zbarimg " class="post-tag">zbarimg</a> <a href="/tags#python-null-bytes " class="post-tag">python-null-bytes</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#pcap " class="post-tag">pcap</a> <a href="/tags#gcode " class="post-tag">gcode</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#blockchain " class="post-tag">blockchain</a> <a href="/tags#solidity " class="post-tag">solidity</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#metamask " class="post-tag">metamask</a> <a href="/tags#remix " class="post-tag">remix</a> <a href="/tags#python-web3 " class="post-tag">python-web3</a> <a href="/tags#micro-qr " class="post-tag">micro-qr</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hv22-easy-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hv22-easy-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:150px;" class="include_image " />
</picture>

<p>Hackvent is one of the three holiday CTFs I try to play every December. This year I made it through 20 of the first 21 days before life got too busy. The first seven challenges (eight if you count the hidden challenge) were rated easy, and included some interesting programming challenges, some blockchain, and lots of QR codes.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 17, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/12/17/htb-support.html">
                HTB: Support
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-support " class="post-tag">htb-support</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#ldapdomaindump " class="post-tag">ldapdomaindump</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#powermad " class="post-tag">powermad</a> <a href="/tags#rubeus " class="post-tag">rubeus</a> <a href="/tags#sharp-collection " class="post-tag">sharp-collection</a> <a href="/tags#ms-ds-machineaccountquota " class="post-tag">ms-ds-machineaccountquota</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/support-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/support-cover.png" alt="Support" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Support is a box used by an IT staff, and one authored by me! I’ll start by getting a custom .NET tool from an open SMB share. With some light .NET reversing, through dynamic analysis, I can get the credentials for an account from the binary. With those, I’ll enumerate LDAP and find a password in an info field on a shared account. That account has full privileges over the DC machine object, and I’ll abuse that to dump the administrator hash and get full access to the box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 10, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/12/10/htb-outdated.html">
                HTB: Outdated
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-outdated " class="post-tag">htb-outdated</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#domain-controller " class="post-tag">domain-controller</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#cve-2022-30190 " class="post-tag">cve-2022-30190</a> <a href="/tags#folina " class="post-tag">folina</a> <a href="/tags#swaks " class="post-tag">swaks</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#hyper-v " class="post-tag">hyper-v</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#addkeycredentiallink " class="post-tag">addkeycredentiallink</a> <a href="/tags#shadow-credentials " class="post-tag">shadow-credentials</a> <a href="/tags#whisker " class="post-tag">whisker</a> <a href="/tags#pywhisker " class="post-tag">pywhisker</a> <a href="/tags#visualstudio " class="post-tag">visualstudio</a> <a href="/tags#rubeus " class="post-tag">rubeus</a> <a href="/tags#sharp-collection " class="post-tag">sharp-collection</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#wsus " class="post-tag">wsus</a> <a href="/tags#sharpwsus " class="post-tag">sharpwsus</a> <a href="/tags#hive-nightmare " class="post-tag">hive-nightmare</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#pkinittools " class="post-tag">pkinittools</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/outdated-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/outdated-cover.png" alt="Outdated" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Outdated has three steps that are all really interesting. First, I’ll exploit Folina by sending a link to an email address collected via recon over SMB. Then I’ll exploit shadow credentials to move laterally to the next user. Finally, I’ll exploit the Windows Server Update Services (WSUS) by pushing a malicious update to the DC and getting a shell as system. In Beyond Root, I’ll look at a couple steps involving Hive Nightmare that I was able to bypass.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 3, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/12/03/htb-carpediem.html">
                HTB: CarpeDiem
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-carpediem " class="post-tag">htb-carpediem</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#trudesk " class="post-tag">trudesk</a> <a href="/tags#html-file " class="post-tag">html-file</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#mongo " class="post-tag">mongo</a> <a href="/tags#mongoexport " class="post-tag">mongoexport</a> <a href="/tags#bcrypt " class="post-tag">bcrypt</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#voip " class="post-tag">voip</a> <a href="/tags#zoiper " class="post-tag">zoiper</a> <a href="/tags#voicemail " class="post-tag">voicemail</a> <a href="/tags#backdrop-cms " class="post-tag">backdrop-cms</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#tcpdump " class="post-tag">tcpdump</a> <a href="/tags#tls-decryption " class="post-tag">tls-decryption</a> <a href="/tags#weak-tls " class="post-tag">weak-tls</a> <a href="/tags#backdrop-plugin " class="post-tag">backdrop-plugin</a> <a href="/tags#docker-escape " class="post-tag">docker-escape</a> <a href="/tags#cgroups " class="post-tag">cgroups</a> <a href="/tags#cve-2022-0492 " class="post-tag">cve-2022-0492</a> <a href="/tags#htb-ready " class="post-tag">htb-ready</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/carpediem-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/carpediem-cover.png" alt="CarpeDiem" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>CarpeDiem is a hard linux box that involves pivoting through a small network of Docker containers. I’ll start by getting admin access to a website, and using an upload feature to get a webshell and a foothold in that container. From there, I’ll enumerate the network and find an instance of trudesk, from which I’ll read a ticket about a new employee who will get their creds via their voicemail. I’ll follow the instructions in the ticket to get access to the voicemail, and their SSH password. I’ll pivot back into a Backdrop CMS instance by getting creds and uploading a malicious plugin. From there, I’ll get root in that container, and then abuse CVE-2022-0492 to get root on the host.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 26, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/11/26/htb-redpanda.html">
                HTB: RedPanda
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-redpanda " class="post-tag">htb-redpanda</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#springboot " class="post-tag">springboot</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#thymeleaf " class="post-tag">thymeleaf</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#groups " class="post-tag">groups</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/redpanda-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/redpanda-cover.png" alt="RedPanda" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>RedPanda starts with a SSTI vulnerability in a Java web application. I’ll exploit that to get execution and a shell. To get to root, I’ll abuse another Java application that’s running as root to assign credit to various authors. To abuse this, I’ll generate a complex attack chain that starts by injecting a log that points to a malicious JPG image I generate. That JPG has metadata that exploits a directory traversal to point to unintended XML, where I can do an XML external entity attack to read files as root. With that abililty, I’ll read root’s private SSH key. In Beyond Root, I’ll look at why my reverse shell as the first user and an SSH session as that user has access to different groups.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 21, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/11/21/htb-squashed.html">
                HTB: Squashed
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-squashed " class="post-tag">htb-squashed</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#nfs " class="post-tag">nfs</a> <a href="/tags#showmount " class="post-tag">showmount</a> <a href="/tags#x11 " class="post-tag">x11</a> <a href="/tags#xauthority " class="post-tag">xauthority</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#screenshare " class="post-tag">screenshare</a> <a href="/tags#keepass " class="post-tag">keepass</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/squashed-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/squashed-cover.png" alt="Squashed" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Squashed abuses a couple of NFS shares in a nice introduction to NFS. First I’ll get access to a web directory, and, after adjusting my local userid to match that one required by the system, upload a webshell and get execution. Then I’ll get an X11 magic cookie from a different NFS share and use it to get a screenshot of the current user’s desktop, showing the root password in a password manager.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 19, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/11/19/htb-hathor.html">
                HTB: Hathor
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-hathor " class="post-tag">htb-hathor</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#mojoportal " class="post-tag">mojoportal</a> <a href="/tags#default-creds " class="post-tag">default-creds</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#defender " class="post-tag">defender</a> <a href="/tags#applocker " class="post-tag">applocker</a> <a href="/tags#firewall " class="post-tag">firewall</a> <a href="/tags#windows-firewall " class="post-tag">windows-firewall</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#insomnia-webshell " class="post-tag">insomnia-webshell</a> <a href="/tags#get-badpasswords " class="post-tag">get-badpasswords</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#klist " class="post-tag">klist</a> <a href="/tags#kinit " class="post-tag">kinit</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#dll " class="post-tag">dll</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#shortcut " class="post-tag">shortcut</a> <a href="/tags#recycle-bin " class="post-tag">recycle-bin</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#pfx " class="post-tag">pfx</a> <a href="/tags#windows-process-monitor " class="post-tag">windows-process-monitor</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#pkcs12 " class="post-tag">pkcs12</a> <a href="/tags#crackpkcs12 " class="post-tag">crackpkcs12</a> <a href="/tags#authenticode " class="post-tag">authenticode</a> <a href="/tags#sign " class="post-tag">sign</a> <a href="/tags#dcsync " class="post-tag">dcsync</a> <a href="/tags#ktutil " class="post-tag">ktutil</a> <a href="/tags#gettgt " class="post-tag">gettgt</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#wmiexec " class="post-tag">wmiexec</a> <a href="/tags#htb-anubis " class="post-tag">htb-anubis</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> <a href="/tags#htb-scrambled " class="post-tag">htb-scrambled</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hathor-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hathor-cover.png" alt="Hathor" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Hathor is an insane box that lives up to the difficulty. I’ll start with some default creds logging into a mojoPortal website. From there, I’ll figure out how to upload a webshell, and copy it to get the right extension. All my efforts to get a shell are blocked, and I’ll do a deep dive analysis on the firewall and AppLocker settings. I’ll eventually get a shell by overwriting a Dll over SMB, and when that Dll is loaded, I get execution. Still, the running binary is blocked outbound at the firewall. I’ll have to use that execution to overwrite an approved Exe, and then get a shell calling that. To get the next user, I’ll find a code signing certificate in the recycle bin, and use it to modify a Get-bADpasswords script that I can trigger to run as the next user. From that last user, I’ll perform a DCSync attack to get the admin’s hash. NTLM is disabled, so I’ll show a couple ways to use that hash to get a Kerberos ticket and execution on the box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 12, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/11/12/htb-shared.html">
                HTB: Shared
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-shared " class="post-tag">htb-shared</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqli-union " class="post-tag">sqli-union</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#cve-2022-21699 " class="post-tag">cve-2022-21699</a> <a href="/tags#ipython " class="post-tag">ipython</a> <a href="/tags#redis " class="post-tag">redis</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#strace " class="post-tag">strace</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#cve-2022-0543 " class="post-tag">cve-2022-0543</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/shared-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/shared-cover.png" alt="Shared" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Shared starts out with a SQL injection via a cookie value. From there, I’ll find creds and get access over SSH. The first pivot abused a code execution vulnerability in iPython. From there, I’ll reverse (both dynamically and statically) a binary to get Redis creds, and exploit Redis to get execution.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/challenge_that_shall_not_be_named">
                Flare-On 2022: The challenge that shall not be named
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-the-challenge-that-shall-not-be-named " class="post-tag">flare-on-the-challenge-that-shall-not-be-named</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#memory-dump " class="post-tag">memory-dump</a> <a href="/tags#pyinstaller " class="post-tag">pyinstaller</a> <a href="/tags#pyarmor " class="post-tag">pyarmor</a> <a href="/tags#pyinstxtractor " class="post-tag">pyinstxtractor</a> <a href="/tags#uncompyle6 " class="post-tag">uncompyle6</a> <a href="/tags#pyarmor-unpacker " class="post-tag">pyarmor-unpacker</a> <a href="/tags#hook " class="post-tag">hook</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-notnamed-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-notnamed-cover.png" alt="The challenge that shall not be named" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The challenge that shall not be named is a Windows executable generated with PyArmor, a tool that aims to create unreversible binarys from Python. The binary makes an HTTP request with an encrypted flag. I’ll first solve it by holding open that web request and dumping the process memeory to find the flag in plaintext. I’ll also show how to hook the crypt Python library to read the flag as it’s being encrypted.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/nur_getraumt">
                Flare-On 2022: Nur geträumt
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-nur-getraumt " class="post-tag">flare-on-nur-getraumt</a> <a href="/tags#mac " class="post-tag">mac</a> <a href="/tags#mini-vmac " class="post-tag">mini-vmac</a> <a href="/tags#emulation " class="post-tag">emulation</a> <a href="/tags#super-resedit " class="post-tag">super-resedit</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-nurgetraumt-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-nurgetraumt-cover.png" alt="Nur geträumt" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Nur geträumt is mostly a challenge about getting an old Mac disk image running in an emulator, and then poking around to get enough clues to solve a trivia problem. There’s no real reversing involved, but rather reading what is available from reading resources with Super ResEdit, a tool for reversing these old Mac application.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/encryptor">
                Flare-On 2022: encryptor
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-encryptor " class="post-tag">flare-on-encryptor</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#ransomware " class="post-tag">ransomware</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#chacha20 " class="post-tag">chacha20</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-encryptor-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-encryptor-cover.png" alt="encryptor" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The given binary for encryptor is a fake ransomware sample. I’ll figure out which files it tries to encrypt, and then understand how it generates a random key for ChaCha20, then encrypts that key using RSA and attaches it. The mistake it makes is using the private key to encrypt, which means I can use the public key to decrypt, and get the ChaCha key, and then use that to decrypt a given file.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/backdoor">
                Flare-On 2022: backdoor
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-backdoor " class="post-tag">flare-on-backdoor</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#patch " class="post-tag">patch</a> <a href="/tags#dns-c2 " class="post-tag">dns-c2</a> <a href="/tags#ilspy " class="post-tag">ilspy</a> <a href="/tags#metadatatoken " class="post-tag">metadatatoken</a> <a href="/tags#dynamic-method " class="post-tag">dynamic-method</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#saitama " class="post-tag">saitama</a> <a href="/tags#malware-bazaar " class="post-tag">malware-bazaar</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-backdoor-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-backdoor-cover.png" alt="backdoor" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>backdoor is the hardest challenge in the 2022 Flare-On challenge, and one of the harder ones I’ve done. The sample is a .NET binary, but most the functions are heavily obfuscated. I’ll deobfuscate through two different processes, patching assembly back into the binary to get something that DNSpy can reverse. Eventually I’ll find a real malware sample, the Saitama backdoor, that executes command and control over DNS. Once I understand the DNS protocol, I’ll write a DNS server to send commands in the required order to trigger the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/anode">
                Flare-On 2022: anode
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-anode " class="post-tag">flare-on-anode</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#nexe " class="post-tag">nexe</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#nexe-unpacker " class="post-tag">nexe-unpacker</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#random-numbers " class="post-tag">random-numbers</a> <a href="/tags#patch " class="post-tag">patch</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-anode-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-anode-cover.png" alt="anode" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>anode is a JavaScript application packed into an EXE with NEXE. The challenge would be straight forward, but the instance of Node that’s packed in the executable with the JavaScript is dorked such that BigInts don’t evaluate as booleans correctly and the random numbers are seeded the same way each time. I’ll patch the JavaScript in the executable (carefully to maintain the length) to print out all 1024 steps that it takes changing the input into an encoded value, and write a Python script to reverse that and recover the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/alamode">
                Flare-On 2022: à la mode
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-a-la-mode " class="post-tag">flare-on-a-la-mode</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#dll " class="post-tag">dll</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#polyglot " class="post-tag">polyglot</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#x32dbg " class="post-tag">x32dbg</a> <a href="/tags#rc4 " class="post-tag">rc4</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#peb " class="post-tag">peb</a> <a href="/tags#tib " class="post-tag">tib</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-alamode-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-alamode-cover.png" alt="a la mode" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>à la mode is a polyglot file, part .NET binary, part standard binary. The .NET part of the file shows a named pipe client that gets the flag over a connection. The standard binary loads functions dynamically by getting kernelbase.dll’s address from the process environment block, and getting offsets by deobfuscated string function names. Then it uses those functions to stand up a named pipe server. I’ll get the flag dynamically, and then go to show how it is using RC4, and decrypt it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/t8">
                Flare-On 2022: T8
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-t8 " class="post-tag">flare-on-t8</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#x32dbg " class="post-tag">x32dbg</a> <a href="/tags#capa " class="post-tag">capa</a> <a href="/tags#rc4 " class="post-tag">rc4</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-t8-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-t8-cover.png" alt="t8" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>For T8, I’ll have to first bypass a really long sleep by manipulating the date time on my VM. Then I’ll look at a GET request, and compare it to what’s in a given PCAP. The response doesn’t match the PCAP. The first step is to understand the payload sent, and then to fake a server and send a response to understand how to it is decrypted, and then apply that to the PCAP data.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/darn_mice">
                Flare-On 2022: darn_mice
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-darn-mice " class="post-tag">flare-on-darn-mice</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#x32dbg " class="post-tag">x32dbg</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-darnmice-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-darnmice-cover.png" alt="known" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>darn_mice involves reversing a Windows binary that doesn’t do anything when run without arguments. I’ll have to find the correct argument to pass it to get it to spit out the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/magic_8_ball">
                Flare-On 2022: Magic 8 Ball
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-magic-8-ball " class="post-tag">flare-on-magic-8-ball</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#sdl " class="post-tag">sdl</a> <a href="/tags#simple-directmedia " class="post-tag">simple-directmedia</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#x32dbg " class="post-tag">x32dbg</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-magic8ball-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-magic8ball-cover.png" alt="magic 8 ball" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Magic 8 Ball presents a 32 bit Windows executable that will return a flag shaken the right number of times and in the right directions.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/pixel_poker">
                Flare-On 2022: Pixel Poker
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-pixel-poker " class="post-tag">flare-on-pixel-poker</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#direct-x " class="post-tag">direct-x</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#x32dbg " class="post-tag">x32dbg</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-pixelpoker-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-pixelpoker-cover.png" alt="pixel poker" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>In Pixel Poker, I’ll reverse engineer a Windows Direct-X 11 application using both Ghidra and x32dbg to find the correct pixel to click on. On clicking, it returns a meme and the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2022/flaredle">
                Flare-On 2022: Flaredle
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-flaredle " class="post-tag">flare-on-flaredle</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#javascript " class="post-tag">javascript</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2022-flaredle-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2022-flaredle-cover.png" alt="flaredle" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Flaredle is a take off on the popular word game, Wordle. In Wordle, you guess letters in a five letter word. In Flaredle, it’s a 21 character work. I’ll look at the JavaScript to find the winning word, and use it to get the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 5, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/11/05/htb-moderators.html">
                HTB: Moderators
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-moderators " class="post-tag">htb-moderators</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#fuzz " class="post-tag">fuzz</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#php-disable-functions " class="post-tag">php-disable-functions</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wordpress-brandfolder " class="post-tag">wordpress-brandfolder</a> <a href="/tags#wordpress-passwords-manager " class="post-tag">wordpress-passwords-manager</a> <a href="/tags#wordpress-plugin " class="post-tag">wordpress-plugin</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#virtualbox " class="post-tag">virtualbox</a> <a href="/tags#virtualbox-encryption " class="post-tag">virtualbox-encryption</a> <a href="/tags#pyvboxdie-cracker " class="post-tag">pyvboxdie-cracker</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#luks " class="post-tag">luks</a> <a href="/tags#chisel " class="post-tag">chisel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/moderators-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/moderators-cover.png" alt="Moderators" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Moderators was a long box with a bunch of web enumerations, some source code analysis, and cracking multiple passwords for a VM. I’ll start by enumerating a website to eventually find a file upload page, where I’ll bypass filters to get a webshell. With a shell, I’ll access an internal WordPress site exploiting the Brandfolder plugin to pivot to the next user. From there, with access to the WordPress config, I’ll get the MySQL password which gives access to secrets stored via another WordPress plugin. I’ll have to look at the source for that plugin to figure out how to decrypt the information and get another user’s SSH key. Finally, I’ll find a VirtualBox VM, and break through both VirtualBox encryption and LUKS to find a password that gets root access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 29, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/10/29/htb-trick.html">
                HTB: Trick
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-trick " class="post-tag">htb-trick</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#smtp " class="post-tag">smtp</a> <a href="/tags#smtp-user-enum " class="post-tag">smtp-user-enum</a> <a href="/tags#zone-transfer " class="post-tag">zone-transfer</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#employee-management-system " class="post-tag">employee-management-system</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqli-bypass " class="post-tag">sqli-bypass</a> <a href="/tags#cve-2022-28468 " class="post-tag">cve-2022-28468</a> <a href="/tags#boolean-based-sqli " class="post-tag">boolean-based-sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#mail-poisoning " class="post-tag">mail-poisoning</a> <a href="/tags#log-poisoning " class="post-tag">log-poisoning</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#fail2ban " class="post-tag">fail2ban</a> <a href="/tags#htb-admirertoo " class="post-tag">htb-admirertoo</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/trick-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/trick-cover.png" alt="Trick" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Trick starts with some enumeration to find a virtual host. There’s an SQL injection that allows bypassing the authentication, and reading files from the system. That file read leads to another subdomain, which has a file include. I’ll show how to use that LFI to get execution via mail poisoning, log poisoning, and just reading an SSH key. To escalate to root, I’ll abuse fail2ban.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 22, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/10/22/htb-faculty.html">
                HTB: Faculty
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-faculty " class="post-tag">htb-faculty</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqli-bypass " class="post-tag">sqli-bypass</a> <a href="/tags#auth-bypass " class="post-tag">auth-bypass</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#mpdf " class="post-tag">mpdf</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#meta-git " class="post-tag">meta-git</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#ptrace " class="post-tag">ptrace</a> <a href="/tags#capabilities " class="post-tag">capabilities</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/faculty-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/faculty-cover.png" alt="Faculty" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Faculty starts with a very buggy school management web application. I’ll abuse SQL injection to bypass authentication, and then a mPDF vulenrability to read files from disk. I’ll find a password for the database connection in the web files that is also used for a user account on the box. Next I’ll abuse meta-git to get a shell as the next user. The final user has access to the GNU debugger with ptrace capabilities. This allows me to connect to any process on the box and inject shellcode, getting execution in the context of that process. I’ll abuse a process running as root to get root access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 15, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/10/15/htb-perspective.html">
                HTB: Perspective
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-perspective " class="post-tag">htb-perspective</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#web-config " class="post-tag">web-config</a> <a href="/tags#shtml " class="post-tag">shtml</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-proxy " class="post-tag">burp-proxy</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#burp-intruder " class="post-tag">burp-intruder</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#formatauthenticationticket " class="post-tag">formatauthenticationticket</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#pdf " class="post-tag">pdf</a> <a href="/tags#html-scriptless-injection " class="post-tag">html-scriptless-injection</a> <a href="/tags#meta " class="post-tag">meta</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#viewstate " class="post-tag">viewstate</a> <a href="/tags#viewstateuserkey " class="post-tag">viewstateuserkey</a> <a href="/tags#machinekey " class="post-tag">machinekey</a> <a href="/tags#ysoserial-net " class="post-tag">ysoserial.net</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#padding-oracle " class="post-tag">padding-oracle</a> <a href="/tags#padbuster " class="post-tag">padbuster</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#potato " class="post-tag">potato</a> <a href="/tags#seimpersonate " class="post-tag">seimpersonate</a> <a href="/tags#juicypotatong " class="post-tag">juicypotatong</a> <a href="/tags#htb-overflow " class="post-tag">htb-overflow</a> <a href="/tags#htb-lazy " class="post-tag">htb-lazy</a> <a href="/tags#htb-smasher " class="post-tag">htb-smasher</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/perspective-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/perspective-cover.png" alt="Perspective" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Perspective is all about exploiting a ASP.NET application in many different ways. I’ll start by uploading a SHTML file that allows me to read the configuration file for the application. With that, I’ll leak one of the keys used by the application, and the fact that there are more protections in place. That key is enough for me to forge a cookie as admin and get access to additional places on the site. There’s a server-side request forgery vulnerability in that part of the site, and I’ll use it to access a crypto service running on localhost. I’ll decrypt another application key, showing both how to do it with math and via a POST request via the SSRF. With that, I can sign a serialized object and get execution. With a shell, I’ll find a staging version of the application with additional logging and some protections that break my previous attack. I’ll use a padding oracle attack to encrypt cookies, and exploit a command injection via the cookie and the password reset process to get a shell as administrator. In Beyond Root, I’ll look at an unintended way to get admin on the website, and get JuicyPotatoNG working, despite most ports being blocked.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 8, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/10/08/htb-opensource.html">
                HTB: OpenSource
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-opensource " class="post-tag">htb-opensource</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#git-hooks " class="post-tag">git-hooks</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#flask-debug " class="post-tag">flask-debug</a> <a href="/tags#flask-debug-pin " class="post-tag">flask-debug-pin</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#gitea " class="post-tag">gitea</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#htb-bitlab " class="post-tag">htb-bitlab</a> <a href="/tags#werkzeug " class="post-tag">werkzeug</a> <a href="/tags#werkzeug-debug " class="post-tag">werkzeug-debug</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/opensource-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/opensource-cover.png" alt="OpenSource" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>OpenSource starts with a web application that has a downloadable source zip. That zip has a Git repo in it, and that leaks the production code as well as account creds. The website has a directory traversal vulnerability that allows me to read and write files. I’ll show two ways to get a shell. The first is abusing the file read to get the information to calculate the Flask debug pin. The later is overwriting one of the Flask source files to get execution. From there, I’ll access a private Gitea instance and find an SSH key to get a shell on the host. The host has a cron running Git commands as root, so I’ll use git hooks to abuse this and get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 1, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/10/01/htb-scrambled.html">
                HTB: Scrambled
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-scrambled " class="post-tag">htb-scrambled</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#silver-ticket " class="post-tag">silver-ticket</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/scrambled-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/scrambled-cover.png" alt="Scrambled" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Scrambled presented a purely Windows-based path. There are some hints on a webpage, and from there the exploitation is all Windows. NTLM authentication is disabled for the box, so a lot of the tools I’m used to using won’t work, or at least work differently. I’ll find user creds with hints from the page, and get some more hints from a file share. I’ll kerberoast and get a challenge/response for a service account, and use that to generate a silver ticket, getting access to the MSSQL instance. From there, I’ll get some more creds, and use those to get access to a share with some custom dot net executables. I’ll reverse those to find a deserialization vulnerability, and exploit that to get a shell as SYSTEM. Because the tooling for this box is so different I’ll show it from both Linux and Windows attack systems. In Beyond Root, two other ways to abuse the MSSQL access, via file read and JuicyPotatoNG.</p>

</li>
        




          <li class="post-list-li"><span class="post-meta">Sep 28, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/09/28/htb-noter-alternative-root-first-blood.html">
                HTB: Noter - Alternative Root (First Blood)
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-noter " class="post-tag">htb-noter</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#mysql-privileges " class="post-tag">mysql-privileges</a> <a href="/tags#mysql-file-write " class="post-tag">mysql-file-write</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/noter-unintended-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/noter-unintended-cover.png" alt="noter unintended cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>When jkr got first blood on Noter, he did it using all the same intended pieces for the box, but in a very clever way that allowed getting a root shell as the first shell on the box. I had intended to include that in my original Noter writeup, but completely forgot, so I’m adding it here.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 24, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/09/24/htb-seventeen.html">
                HTB: Seventeen
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-seventeen " class="post-tag">htb-seventeen</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#exam-management-system " class="post-tag">exam-management-system</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#boolean-based-sqli " class="post-tag">boolean-based-sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#roundcube " class="post-tag">roundcube</a> <a href="/tags#cve-2020-12640 " class="post-tag">cve-2020-12640</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-proxy " class="post-tag">burp-proxy</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#npm " class="post-tag">npm</a> <a href="/tags#verdaccio " class="post-tag">verdaccio</a> <a href="/tags#home-env " class="post-tag">home-env</a> <a href="/tags#malicious-node-module " class="post-tag">malicious-node-module</a> <a href="/tags#htb-blunder " class="post-tag">htb-blunder</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/seventeen-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/seventeen-cover.png" alt="Seventeen" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Seventeen presented a bunch of virtual hosts, each of which added some piece to eventually land execution. The exam site has a boolean-based SQL injection, which provides access to the database, which leaks another virtual host and it’s DB. The oldmanagement system provides file upload, and leaks the hostname of a Roundcube webmail instance. I’ll upload a webshell and exploit CVE-2020-12640 in Roundcube to include it and get execution. There’s two pivots of password reuse, before getting root by installing a malicious Node module from a rogue NPM server. In Beyond Root, I’ll look at why root uses the .npmrc file from kavi’s home directory and unintended bypassing the htaccess file for webshell execution.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 17, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/09/17/htb-streamio.html">
                HTB: StreamIO
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-streamio " class="post-tag">htb-streamio</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#domain-controller " class="post-tag">domain-controller</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqli-union " class="post-tag">sqli-union</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#rfi " class="post-tag">rfi</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#sqlcmd " class="post-tag">sqlcmd</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#firefox " class="post-tag">firefox</a> <a href="/tags#firepwd " class="post-tag">firepwd</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#bloodhound-python " class="post-tag">bloodhound-python</a> <a href="/tags#laps " class="post-tag">laps</a> <a href="/tags#htb-hancliffe " class="post-tag">htb-hancliffe</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/streamio-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/streamio-cover.png" alt="StreamIO" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>StreamIO is a Windows host running PHP but with MSSQL as the database. It starts with an SQL injection, giving admin access to a website. Then there’s a weird file include in a hidden debug parameter, which eventually gets a remote file include giving execution and a foothold. With that I’ll gain access to a high privileged access to the db, and find another password in a backup table. From that user, I’ll fetch saved Firefox credentials, and use those to read a LAPS password and get an administrator shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 10, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/09/10/htb-scanned.html">
                HTB: Scanned
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-scanned " class="post-tag">htb-scanned</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#django " class="post-tag">django</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#chroot " class="post-tag">chroot</a> <a href="/tags#jail " class="post-tag">jail</a> <a href="/tags#sandbox-escape " class="post-tag">sandbox-escape</a> <a href="/tags#makefile " class="post-tag">makefile</a> <a href="/tags#ptrace " class="post-tag">ptrace</a> <a href="/tags#fork " class="post-tag">fork</a> <a href="/tags#dumbable " class="post-tag">dumbable</a> <a href="/tags#c " class="post-tag">c</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#shared-object " class="post-tag">shared-object</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/scanned-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/scanned-cover.png" alt="Scanned" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The entire Scanned challenge is focused on a single web application, and yet it’s one of the hardest boxes HackTheBox has published. The box starts with a website that is kind of like VirusTotal, where users can upload executables (Linux only) and they run, and get back a list of system calls and return values. The source for the site and the sandbox is also downloadable. In the source, I’ll see how the sandbox sets up chroot jails to isolate the malware. I’ll take advantage of two mistakes in the coding to write a binary that escapes the jail and reads the database for the application, including the Django admin password. That password also works for SSH. With a foothold on the box, I’ll abuse the sandbox again, this time writing a program that sleeps, and then calls a SetUID binary from outside the jail. During the sleep, I’ll load a malicious library into the jail that hijacks execution, and because the binary is SetUID, I get execution as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 3, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/09/03/htb-noter.html">
                HTB: Noter
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-noter " class="post-tag">htb-noter</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#flask-cookie " class="post-tag">flask-cookie</a> <a href="/tags#flask-unsign " class="post-tag">flask-unsign</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#md-to-pdf " class="post-tag">md-to-pdf</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#raptor " class="post-tag">raptor</a> <a href="/tags#shared-object " class="post-tag">shared-object</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/noter-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/noter-cover.png" alt="Noter" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Noter starts by registering an account on the website and looking at the Flask cookie. It’s crackable, but I don’t have another user’s  name or anything else to fake of value. I’ll show a couple different ways to find a username, by generating tons of valid cookies and testing them, and by using the login error messages to find a valid username. With access as a higher priv user on the website, I get creds to the FTP server, where I find the default password scheme, and use that to pivot to the FTP admin. As admin, I get the site source, and find a RCE, both the intended way exploiting a markdown to PDF JavaScript library, as well as an unintended command injection. To get root, I’ll find MySQL running as root and use the Raptor exploit to get command execution through MySQL.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 27, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/08/27/htb-talkative.html">
                HTB: Talkative
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-talkative " class="post-tag">htb-talkative</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#jamovi " class="post-tag">jamovi</a> <a href="/tags#bolt-cms " class="post-tag">bolt-cms</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#rocket-chat " class="post-tag">rocket-chat</a> <a href="/tags#r-lang " class="post-tag">r-lang</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#webhook " class="post-tag">webhook</a> <a href="/tags#twig " class="post-tag">twig</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#mongo " class="post-tag">mongo</a> <a href="/tags#deepce " class="post-tag">deepce</a> <a href="/tags#shocker " class="post-tag">shocker</a> <a href="/tags#cap-dac-read-search " class="post-tag">cap-dac-read-search</a> <a href="/tags#htb-paper " class="post-tag">htb-paper</a> <a href="/tags#htb-anubis " class="post-tag">htb-anubis</a> <a href="/tags#htb-registry " class="post-tag">htb-registry</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/talkative-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/talkative-cover.png" alt="Talkative" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Talkative is about hacking a communications platform. I’ll start by abusing the built-in R scripter in jamovi to get execution and shell in a docker container. There I’ll find creds for the Bolt CMS instance, and use those to log into the admin panel and edit a template to get code execution in the next container. From that container, I can SSH into the main host. From the host, I’ll find a different network of containers, and find MongoDB running in one. I’ll connect to that and use it to get access as admin for a Rocket Chat instance. I’ll abuse the Rocket Chat webhook functionality to get a shell in yet another Docker container. This container has a dangerous capabilities, <code class="language-plaintext highlighter-rouge">CAP_DAC_READ_SEARCH</code>, which I’ll abuse to both read and write files on the host.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 20, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/08/20/htb-timelapse.html">
                HTB: Timelapse
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-timelapse " class="post-tag">htb-timelapse</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#laps " class="post-tag">laps</a> <a href="/tags#zip2john " class="post-tag">zip2john</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#pfx2john " class="post-tag">pfx2john</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#winrm-keys " class="post-tag">winrm-keys</a> <a href="/tags#powershell-history " class="post-tag">powershell-history</a> <a href="/tags#htb-pivotapi " class="post-tag">htb-pivotapi</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/timelapse-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/timelapse-cover.png" alt="Timelapse" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Timelapse is a really nice introduction level active directory box. It starts by finding a set of keys used for authentication to the Windows host on an SMB share. I’ll crack the zip and the keys within, and use Evil-WinRM differently than I have shown before to authenticate to Timelapse using the keys. As the initial user, I’ll find creds in the PowerShell history file for the next user. That user can read from LAPS, the technology that helps to keep local administrator passwords safe and unique. With that read access, I’ll get the administrator password and use Evil-WinRM to get a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 13, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/08/13/htb-retired.html">
                HTB: Retired
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-retired " class="post-tag">htb-retired</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#proc " class="post-tag">proc</a> <a href="/tags#maps " class="post-tag">maps</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#pattern " class="post-tag">pattern</a> <a href="/tags#mprotect " class="post-tag">mprotect</a> <a href="/tags#rop " class="post-tag">rop</a> <a href="/tags#jmp-rsp " class="post-tag">jmp-rsp</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#symlink " class="post-tag">symlink</a> <a href="/tags#make " class="post-tag">make</a> <a href="/tags#capabilities " class="post-tag">capabilities</a> <a href="/tags#cap-dac-override " class="post-tag">cap-dac-override</a> <a href="/tags#binfmt-misc " class="post-tag">binfmt-misc</a> <a href="/tags#sched-debug " class="post-tag">sched_debug</a> <a href="/tags#htb-previse " class="post-tag">htb-previse</a> <a href="/tags#htb-fingerprint " class="post-tag">htb-fingerprint</a> <a href="/tags#execute-after-redirect " class="post-tag">execute-after-redirect</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/retired-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/retired-cover.png" alt="Retired" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Retired starts out with a file read plus a directory traversal vulnerability. (There’s also an EAR vulnerability that I originally missed, but added in later). With that, I’ll get a copy of a binary that gets fed a file via an upload on the website. There’s a buffer overflow, which I can exploit via an uploaded file. I’ll use ROP to make the stack executable, and then run a reverse shell shellcode from it. With a shell, I’ll throw a symlink into a backup directory and get an SSH key from the user. To get root, I’ll abuse binfmt_misc. In Beyond Root, some loose ends that were annoying me.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 6, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/08/06/htb-overgraph.html">
                HTB: Overgraph
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-overgraph " class="post-tag">htb-overgraph</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#graphql " class="post-tag">graphql</a> <a href="/tags#angularjs " class="post-tag">angularjs</a> <a href="/tags#otp " class="post-tag">otp</a> <a href="/tags#nosql-injection " class="post-tag">nosql-injection</a> <a href="/tags#graphql-playground " class="post-tag">graphql-playground</a> <a href="/tags#graphql-voyager " class="post-tag">graphql-voyager</a> <a href="/tags#local-storage " class="post-tag">local-storage</a> <a href="/tags#csti " class="post-tag">csti</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#reflective-xss " class="post-tag">reflective-xss</a> <a href="/tags#csrf " class="post-tag">csrf</a> <a href="/tags#ffmpeg " class="post-tag">ffmpeg</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#file-read " class="post-tag">file-read</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#patchelf " class="post-tag">patchelf</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#checksec " class="post-tag">checksec</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/overgraph-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/overgraph-cover.png" alt="Overgraph" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The initial web exploitation in Overgraph was really hard. I’ll have to find and chain together a reflective cross site scripting (XSS), a client side template injection (CSTI), and a cross site request forgery (CSRF) to leak an admin’s token. With that token, I can upload videos, and I’ll exploit FFmpeg to get local file read (one line at a time!), and read the user’s SSH key. For root, there’s a binary to exploit, but it’s actually rather beginner if you skip the heap exploit and just use the arbitrary file write.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 30, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/07/30/htb-late.html">
                HTB: Late
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-late " class="post-tag">htb-late</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ocr " class="post-tag">ocr</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#kolourpaint " class="post-tag">kolourpaint</a> <a href="/tags#tesseract " class="post-tag">tesseract</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#jinja2 " class="post-tag">jinja2</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> <a href="/tags#linpeas " class="post-tag">linpeas</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#chattr " class="post-tag">chattr</a> <a href="/tags#lsattr " class="post-tag">lsattr</a> <a href="/tags#extended-attributes " class="post-tag">extended-attributes</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/late-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/late-cover.png" alt="Late" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Late really had two steps. The first is to find a online image OCR website that is vulnerable to server-side template injection (SSTI) via the OCRed text in the image. This is relatively simple to find, but getting the fonts correct to exploit the vulnerability is a bit tricky. Still, some trial and error pays off, and results in a shell. From there, I’ll identify a script that’s running whenever someone logs in over SSH. The current user has append access to the file, and therefore I can add a malicious line to the script and connect over SSH to get execution as root. In Beyond Root, a YouTube video showing basic analysis of the webserver, from NGINX to Gunicorn to Python Flask.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 23, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/07/23/htb-catch.html">
                HTB: Catch
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-catch " class="post-tag">htb-catch</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#apk " class="post-tag">apk</a> <a href="/tags#android " class="post-tag">android</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#gitea " class="post-tag">gitea</a> <a href="/tags#swagger " class="post-tag">swagger</a> <a href="/tags#lets-chat " class="post-tag">lets-chat</a> <a href="/tags#cachet " class="post-tag">cachet</a> <a href="/tags#jadx " class="post-tag">jadx</a> <a href="/tags#mobsf " class="post-tag">mobsf</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#cve-2021-39172 " class="post-tag">cve-2021-39172</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#redis " class="post-tag">redis</a> <a href="/tags#php-deserialization " class="post-tag">php-deserialization</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#phpggc " class="post-tag">phpggc</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#cve-2021-39174 " class="post-tag">cve-2021-39174</a> <a href="/tags#cve-2021-39165 " class="post-tag">cve-2021-39165</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#apktool " class="post-tag">apktool</a> <a href="/tags#htb-routerspace " class="post-tag">htb-routerspace</a> <a href="/tags#flare-on-flarebear " class="post-tag">flare-on-flarebear</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/catch-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/catch-cover.png" alt="Catch" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Catch requires finding an API token in an Android application, and using that to leak credentials from a chat server. Those credentials provide access to multiple CVEs in a Cachet instance, providing several different paths to a shell. The intended and most interesting is to inject into a configuration file, setting my host as the redis server, and storing a malicious serialized PHP object in that server to get execution. To escalate to root, I’ll abuse a command injection vulnerability in a Bash script that is checking APK files by giving an application a malicious name field.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 16, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/07/16/htb-acute.html">
                HTB: Acute
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-acute " class="post-tag">htb-acute</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#powershell-web-access " class="post-tag">powershell-web-access</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#defender " class="post-tag">defender</a> <a href="/tags#defender-bypass-directory " class="post-tag">defender-bypass-directory</a> <a href="/tags#screenshare " class="post-tag">screenshare</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#powershell-runas " class="post-tag">powershell-runas</a> <a href="/tags#powershell-configuration " class="post-tag">powershell-configuration</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/acute-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/acute-cover.png" alt="Acute" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Acute is a really nice Windows machine because there’s nothing super complex about the attack paths. Rather, it’s just about manuverting from user to user using shared creds and privilieges available to make the next step. It’s a pure Windows box. There’s two hosts to pivot between, limited PowerShell configurations, and lots of enumeration.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 9, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/07/09/htb-routerspace.html">
                HTB: RouterSpace
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-routerspace " class="post-tag">htb-routerspace</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#android " class="post-tag">android</a> <a href="/tags#apk " class="post-tag">apk</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#apktool " class="post-tag">apktool</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#android-react-native " class="post-tag">android-react-native</a> <a href="/tags#react-native " class="post-tag">react-native</a> <a href="/tags#genymotion " class="post-tag">genymotion</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#android-burp " class="post-tag">android-burp</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#linpeas " class="post-tag">linpeas</a> <a href="/tags#pwnkit " class="post-tag">pwnkit</a> <a href="/tags#cve-2021-4034 " class="post-tag">cve-2021-4034</a> <a href="/tags#polkit " class="post-tag">polkit</a> <a href="/tags#cve-2021-3560 " class="post-tag">cve-2021-3560</a> <a href="/tags#cve-2021-22555 " class="post-tag">cve-2021-22555</a> <a href="/tags#baron-samedit " class="post-tag">baron-samedit</a> <a href="/tags#cve2021-3156 " class="post-tag">cve2021-3156</a> <a href="/tags#htb-paper " class="post-tag">htb-paper</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/routerspace-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/routerspace-cover.png" alt="RouterSpace" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>RouterSpace was all about dynamic analysis of an Android application. Unfortunately, it was a bit tricky to get setup and working. I’ll use a system-wide proxy on the virtualized Android device to route traffic through Burp, identifying the API endpoint and finding a command injection. For root, I’ll exploit the Baron Samedit vulnerability in sudo that came our in early 2021.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 2, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/07/02/htb-undetected.html">
                HTB: Undetected
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-undetected " class="post-tag">htb-undetected</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#composer " class="post-tag">composer</a> <a href="/tags#phpunit " class="post-tag">phpunit</a> <a href="/tags#cve-2017-9841 " class="post-tag">cve-2017-9841</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#awk " class="post-tag">awk</a> <a href="/tags#backdoor " class="post-tag">backdoor</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#apache-mod " class="post-tag">apache-mod</a> <a href="/tags#sshd " class="post-tag">sshd</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/undetected-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/undetected-cover.png" alt="Undetected" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Undetected follows the path of an attacker against a partially disabled website. I’ll exploit a misconfigured PHP package to get execution on the host. From there, I’ll find a kernel exploit left behind by the previous attacker, and while it no longer works, the payload shows how it modified the passwd and shadow files to add backdoored users with static passwords, and those users are still present. Further enumeration finds a malicious Apache module responsible for downloading and installing a backdoored sshd binary. Reversing that provides a password I can use to get a root shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 25, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/06/25/htb-phoenix.html">
                HTB: Phoenix
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-phoenix " class="post-tag">htb-phoenix</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-pressed " class="post-tag">htb-pressed</a> <a href="/tags#htb-static " class="post-tag">htb-static</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#wp-pie-register " class="post-tag">wp-pie-register</a> <a href="/tags#wp-asgaros-forum " class="post-tag">wp-asgaros-forum</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#time-based-sqli " class="post-tag">time-based-sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#2fa " class="post-tag">2fa</a> <a href="/tags#wp-miniorange " class="post-tag">wp-miniorange</a> <a href="/tags#totp " class="post-tag">totp</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#oathtool " class="post-tag">oathtool</a> <a href="/tags#wp-download-from-files " class="post-tag">wp-download-from-files</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#pam " class="post-tag">pam</a> <a href="/tags#sch " class="post-tag">sch</a> <a href="/tags#unsch " class="post-tag">unsch</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#proc " class="post-tag">proc</a> <a href="/tags#wildcard " class="post-tag">wildcard</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/phoenix-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/phoenix-cover.png" alt="Phoenix" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Phoenix starts off with a WordPress site using a plugin with a blind SQL injection. This injection is quite slow, and I think leads to the poor reception for this box overall. Still, very slow blind SQL injection shows the value in learning to pull out only the bits you need from the DB. I’ll get usernames and password hashes, but that leaves me at a two factors prompt. I’ll reverse enginner that plugin to figure out what I need from the DB, and get the seed to generate the token. From there, I’ll abuse another plugin to upload a webshell and get a shell on the box. The first pivot involves password reuse and understanding the pam 2FA setup isn’t enabled on one interface. The next pivot is wildcard injection in a complied shell script. I’ll dump the script out (several ways), and then use the injection to get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 18, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/06/18/htb-paper.html">
                HTB: Paper
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-paper " class="post-tag">htb-paper</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#rocket-chat " class="post-tag">rocket-chat</a> <a href="/tags#cve-2019-17671 " class="post-tag">cve-2019-17671</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#linpeas " class="post-tag">linpeas</a> <a href="/tags#cve-2021-3156 " class="post-tag">cve-2021-3156</a> <a href="/tags#cve-2021-4034 " class="post-tag">cve-2021-4034</a> <a href="/tags#pwnkit " class="post-tag">pwnkit</a> <a href="/tags#cve-2021-3650 " class="post-tag">cve-2021-3650</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/paper-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/paper-cover.png" alt="Paper" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Paper is a fun easy-rated box themed off characters from the TV show “The Office”. There’s a WordPress vulnerability that allows reading draft posts. In a draft post, I’ll find the URL to register accounts on a Rocket Chat instance. Inside the chat, there’s a bot that can read files. I’ll exploit a directory traversal to read outside the current directory, and find a password that can be used to access the system. To escalate from there, I’ll exploit a 2021 CVE in PolKit. In Beyond Root, I’ll look at a later CVE in Polkit, Pwnkit, and show why Paper wasn’t vulnerable, make it vulnerable, and exploit it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/06/11/htb-meta.html">
                HTB: Meta
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-meta " class="post-tag">htb-meta</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#composer " class="post-tag">composer</a> <a href="/tags#cve-2021-22204 " class="post-tag">cve-2021-22204</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#mogrify " class="post-tag">mogrify</a> <a href="/tags#cve-2020-29599 " class="post-tag">cve-2020-29599</a> <a href="/tags#polyglot " class="post-tag">polyglot</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#imagemagick " class="post-tag">imagemagick</a> <a href="/tags#imagemagick-scripting-language " class="post-tag">imagemagick-scripting-language</a> <a href="/tags#neofetch " class="post-tag">neofetch</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/meta-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/meta-cover.png" alt="Meta" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Meta was all about image processing. It starts with an image metadata service where I’ll exploit a CVE in exfiltool to get code execution. From there, I’ll exploit a cron running an ImageMagick script against uploaded files using an SVC/ImageMagick Scripting Language polyglot to get shell as the user. For root, I’ll abuse neofetch and environment variables.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 4, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/06/04/htb-timing.html">
                HTB: Timing
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-timing " class="post-tag">htb-timing</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#side-channel " class="post-tag">side-channel</a> <a href="/tags#timing " class="post-tag">timing</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#mass-assignment " class="post-tag">mass-assignment</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#firewall " class="post-tag">firewall</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#axel " class="post-tag">axel</a> <a href="/tags#sudo-home " class="post-tag">sudo-home</a> <a href="/tags#htb-backendtwo " class="post-tag">htb-backendtwo</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/timing-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/timing-cover.png" alt="Timing" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Timing starts out with a local file include and a directory traversal that allows me to access the source for the website. I’ll identify and abuse a timing attack to identify usernames on a login form. After logging in, there’s a mass assignment vulnerability that allows me to upgrade my user to admin. As admin, I’ll use the LFI plus upload to get execution. To root, I’ll abuse a download program to overwrite root’s authorized_keys file and get SSH access. In Beyond Root, I’ll look at an alternative root, and dig more into mass assignment vulnerabilities.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 31, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/31/setuid-rabbithole.html">
                SetUID Rabbit Hole
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-jail " class="post-tag">htb-jail</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#execve " class="post-tag">execve</a> <a href="/tags#c " class="post-tag">c</a> <a href="/tags#nfs " class="post-tag">nfs</a> <a href="/tags#setuid " class="post-tag">setuid</a> <a href="/tags#seteuid " class="post-tag">seteuid</a> <a href="/tags#setresuid " class="post-tag">setresuid</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/setuid-rabbit-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/setuid-rabbit-cover.png" alt="setuid-rabbit-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>In looking through writeups for Jail after finishing mine, I came across an interesting rabbit hole, which led me down the path of a good deal of research, where I learned interesting detail related to a few things I’ve been using for years. I’ll dive into Linux user IDs and SetUID / SUID, execve vs system, and sh vs bash, and test out what I learn on Jail.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 28, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/28/htb-admirertoo.html">
                HTB: AdmirerToo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-admirertoo " class="post-tag">htb-admirertoo</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#adminer " class="post-tag">adminer</a> <a href="/tags#cve-2021-21311 " class="post-tag">cve-2021-21311</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#adminer-oneclick-login " class="post-tag">adminer-oneclick-login</a> <a href="/tags#opentsdb " class="post-tag">opentsdb</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#cve-2020-35476 " class="post-tag">cve-2020-35476</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#opencats " class="post-tag">opencats</a> <a href="/tags#fail2ban " class="post-tag">fail2ban</a> <a href="/tags#cve-2021-25294 " class="post-tag">cve-2021-25294</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#cve-2021-32749 " class="post-tag">cve-2021-32749</a> <a href="/tags#whois " class="post-tag">whois</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#ncat " class="post-tag">ncat</a> <a href="/tags#htb-forge " class="post-tag">htb-forge</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/admirertoo-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/admirertoo-cover.png" alt="AdmirerToo" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>AdmirerToo is all about chaining exploits together. I’ll use a SSRF vulnerability in Adminer to discover a local instance of OpenTSDB, and use the SSRF to exploit a command injection to get a shell. Then I’ll exploit a command injection in Fail2Ban that requires I can control the result of a whois query about my IP. I’ll abuse a file write vulnerability in OpenCats to upload a malicious whois.conf, and then exploit fail2ban getting a shell. In Beyond Root, I’ll look at the final exploit and why nc didn’t work for me at first, but ncat did.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 23, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/23/htb-jail.html">
                HTB: Jail
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-jail " class="post-tag">htb-jail</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#centos " class="post-tag">centos</a> <a href="/tags#nfs " class="post-tag">nfs</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#peda " class="post-tag">peda</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> <a href="/tags#socket-reuse " class="post-tag">socket-reuse</a> <a href="/tags#nfs-nosquash " class="post-tag">nfs-nosquash</a> <a href="/tags#rvim " class="post-tag">rvim</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#rar " class="post-tag">rar</a> <a href="/tags#quipquip " class="post-tag">quipquip</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#hashcat-rules " class="post-tag">hashcat-rules</a> <a href="/tags#atbash " class="post-tag">atbash</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#rsactftool " class="post-tag">rsactftool</a> <a href="/tags#facl " class="post-tag">facl</a> <a href="/tags#getfacl " class="post-tag">getfacl</a> <a href="/tags#htb-laboratory " class="post-tag">htb-laboratory</a> <a href="/tags#htb-tartarsauce " class="post-tag">htb-tartarsauce</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/jail-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/jail-cover.png" alt="Jail" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Jail is an old HTB machine that is still really nice to play today. There’s a bunch of interesting fundamentals to work through. It starts with a buffer overflow in a jail application that can be exploited to get execution. It’s a very beginner BOF, with stack execution enabled, access to the source, and a way to leak the input buffer address. From there, I’ll abuse an NFS share without user squashing to escalate to the next user. Then there’s an rvim escape to get the next user. And finally a crypto challenge to get root. Jail sent me a bit down the rabbit hole on NFS, so some interesting exploration in Beyond Root, including an alternative way to make the jump from frank to adm.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 21, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/21/htb-pandora.html">
                HTB: Pandora
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-pandora " class="post-tag">htb-pandora</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#snmpbulkwalk " class="post-tag">snmpbulkwalk</a> <a href="/tags#mibs " class="post-tag">mibs</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-dataclass " class="post-tag">python-dataclass</a> <a href="/tags#pandora-fms " class="post-tag">pandora-fms</a> <a href="/tags#cve-2021-32099 " class="post-tag">cve-2021-32099</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#sqli-union " class="post-tag">sqli-union</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#auth-bypass " class="post-tag">auth-bypass</a> <a href="/tags#cve-2020-13851 " class="post-tag">cve-2020-13851</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#mpm-itk " class="post-tag">mpm-itk</a> <a href="/tags#apache " class="post-tag">apache</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-sneaky " class="post-tag">htb-sneaky</a> <a href="/tags#htb-openkeys " class="post-tag">htb-openkeys</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/pandora-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/pandora-cover.png" alt="Pandora" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Pandora starts off with some SNMP enumeration to find a username and password that can be used to get a shell. This provides access to a Pandora FMS system on localhost, which has multiple vulnerabilities. I’ll exploit a SQL injection to read the database and get session cookies. I can exploit that same page to get admin and upload a webshell, or exploit another command injection CVE to get execution. To get root, there’s a simple path hijack in a SUID binary, but I will have to switch to SSH access, as there’s a sandbox in an Apache module preventing my running SUID as root while a descendant process of Apache. I’ll explore that in depth in Beyond Root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 18, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/18/htb-mirai.html">
                HTB: Mirai
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-mirai " class="post-tag">htb-mirai</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#raspberrypi " class="post-tag">raspberrypi</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#plex " class="post-tag">plex</a> <a href="/tags#pihole " class="post-tag">pihole</a> <a href="/tags#default-creds " class="post-tag">default-creds</a> <a href="/tags#deleted-file " class="post-tag">deleted-file</a> <a href="/tags#extundelete " class="post-tag">extundelete</a> <a href="/tags#testdisk " class="post-tag">testdisk</a> <a href="/tags#photorec " class="post-tag">photorec</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/mirai-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/mirai-cover.png" alt="Mirai" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Mirai was a RaspberryPi device running PiHole that happens to still have the RaspberryPi default usename and password. That user can even sudo to root, but there is a bit of a hitch at the end. I’ll have to recover the deleted root flag from a usb drive.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 16, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/16/htb-brainfuck.html">
                HTB: Brainfuck
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-brainfuck " class="post-tag">htb-brainfuck</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#wp-support-plus " class="post-tag">wp-support-plus</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#auth-bypass " class="post-tag">auth-bypass</a> <a href="/tags#smtp " class="post-tag">smtp</a> <a href="/tags#email " class="post-tag">email</a> <a href="/tags#vigenere " class="post-tag">vigenere</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#lxc " class="post-tag">lxc</a> <a href="/tags#lxd " class="post-tag">lxd</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#htb-spectra " class="post-tag">htb-spectra</a> <a href="/tags#htb-tabby " class="post-tag">htb-tabby</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/brainfuck-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/brainfuck-cover.png" alt="Brainfuck" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Brainfuck was one of the first boxes released on HackTheBox. It’s a much more unrealistic and CTF style box than would appear on HTB today, but there are still elements of it that can be a good learning opportunity. There’s WordPress exploitation and a bunch of crypto, including RSA and Vigenere.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 14, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/14/htb-fingerprint.html">
                HTB: Fingerprint
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-fingerprint " class="post-tag">htb-fingerprint</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#ubuntu-1804 " class="post-tag">ubuntu-1804</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#werkzeug " class="post-tag">werkzeug</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#execute-after-redirect " class="post-tag">execute-after-redirect</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#burp-proxy " class="post-tag">burp-proxy</a> <a href="/tags#glassfish " class="post-tag">glassfish</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#browser-fingerprint " class="post-tag">browser-fingerprint</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#proc " class="post-tag">proc</a> <a href="/tags#hql " class="post-tag">hql</a> <a href="/tags#hql-injection " class="post-tag">hql-injection</a> <a href="/tags#boolean-injection " class="post-tag">boolean-injection</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#jwt-io " class="post-tag">jwt-io</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#java-deserialization " class="post-tag">java-deserialization</a> <a href="/tags#maven " class="post-tag">maven</a> <a href="/tags#jd-gui " class="post-tag">jd-gui</a> <a href="/tags#java-byte-code " class="post-tag">java-byte-code</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#aes " class="post-tag">aes</a> <a href="/tags#aes-ecb " class="post-tag">aes-ecb</a> <a href="/tags#padding-attack " class="post-tag">padding-attack</a> <a href="/tags#htb-previse " class="post-tag">htb-previse</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/fingerprint-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/fingerprint-cover.png" alt="Fingerprint" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>For each step in Fingerprint, I’ll have to find multiple vulnerabilities and make them work together to accomplish some goal. To get a shell, I’ll abuse a execute after return (EAR) vulnerability, a directory traversal, HQL injection, cross site scripting, to collect the pieces necessary for the remote exploit. I’ll generate a custom Java serialized payload and abuse a shared JWT signing secret to get execution and a shell. To get to the next user I’ll need to brute force an SSH key character by character using a SUID program, and find the decryption password in a Java Jar. To get root, I’ll need to abuse a new version of one of the initial webservers, conducting a padding attack on the AES cookie to force a malicious admin cookie, and then use the directory traversal to read the root SSH key.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/11/htb-fulcrum.html">
                HTB: Fulcrum
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-fulcrum " class="post-tag">htb-fulcrum</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#rfi " class="post-tag">rfi</a> <a href="/tags#qemu " class="post-tag">qemu</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#powershell-credential " class="post-tag">powershell-credential</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#web-config " class="post-tag">web-config</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#htb-reel " class="post-tag">htb-reel</a> <a href="/tags#htb-omni " class="post-tag">htb-omni</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/fulcrum-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/fulcrum-cover.png" alt="Fulcrum" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Fulcrum is a 2017 release that got a rebuild in 2022. It’s a Linux server with four websites, including one that returns Windows .NET error messages. I’ll exploit an API endpoint via XXE, and use that as an SSRF to get execution through a remote file include. From there I’ll pivot to the Windows webserver with some credentials, enumeration LDAP, pivot to the file server, which can read shares on the DC. In those shares, I’ll find a login script with creds associated with one of the domain admins, and use that to read the flag from the DC, as well as to get a shell. This box has a lot of tunneling, representing a small mixed-OS network on one box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 7, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/07/htb-unicode.html">
                HTB: Unicode
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-unicode " class="post-tag">htb-unicode</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#jwt-io " class="post-tag">jwt-io</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#jwt-rsa " class="post-tag">jwt-rsa</a> <a href="/tags#open-redirect " class="post-tag">open-redirect</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#unicode " class="post-tag">unicode</a> <a href="/tags#unicode-normalization " class="post-tag">unicode-normalization</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#share " class="post-tag">share</a> <a href="/tags#pyinstaller " class="post-tag">pyinstaller</a> <a href="/tags#pyinstxtractor " class="post-tag">pyinstxtractor</a> <a href="/tags#uncompyle6 " class="post-tag">uncompyle6</a> <a href="/tags#parameter-injection " class="post-tag">parameter-injection</a> <a href="/tags#htb-backdoor " class="post-tag">htb-backdoor</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/unicode-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/unicode-cover.png" alt="Unicode" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Unicode’s name reflects the need to bypass web filtering of input by abusing unicode characters, and how they are normalized to abuse a directory traversal bug. There’s also some neat JWT abuse, targeting the RSA signed versions and using an open redirect to trick the server into trusting a public key I host. To escalate, there’s some parameter injection in a PyInstaller-built ELF file.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 5, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/05/htb-return.html">
                HTB: Return
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-return " class="post-tag">htb-return</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#printer " class="post-tag">printer</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#server-operators " class="post-tag">server-operators</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#service-hijack " class="post-tag">service-hijack</a> <a href="/tags#windows-service " class="post-tag">windows-service</a> <a href="/tags#htb-fuse " class="post-tag">htb-fuse</a> <a href="/tags#htb-blackfield " class="post-tag">htb-blackfield</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/return-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/return-cover.png" alt="Return" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Return was a straight forward box released for the HackTheBox printer track. This time I’ll abuse a printer web admin panel to get LDAP credentials, which can also be used for WinRM. The account is in the Server Operators group, which allows it to modify, start, and stop services. I’ll abuse this to get a shell as SYSTEM.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 3, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/03/htb-antique.html">
                HTB: Antique
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-antique " class="post-tag">htb-antique</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#printer " class="post-tag">printer</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#jetdirect " class="post-tag">jetdirect</a> <a href="/tags#telnet " class="post-tag">telnet</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#cups " class="post-tag">cups</a> <a href="/tags#cve-2012-5519 " class="post-tag">cve-2012-5519</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#shadow " class="post-tag">shadow</a> <a href="/tags#cve-2015-1158 " class="post-tag">cve-2015-1158</a> <a href="/tags#pwnkit " class="post-tag">pwnkit</a> <a href="/tags#shared-object " class="post-tag">shared-object</a> <a href="/tags#cve-2021-4034 " class="post-tag">cve-2021-4034</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/antique-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/antique-cover.png" alt="Antique" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Antique released non-competitively as part of HackTheBox’s Printer track. It’s a box simulating an old HP printer. I’ll start by leaking a password over SNMP, and then use that over telnet to connect to the printer, where there’s an exec command to run commands on the system. To escalate, I’ll abuse an old instance of CUPS print manager software to get file read as root, and get the root flag. In Beyond Root, I’ll look at two more CVEs, another CUPS one that didn’t work because no actual printers were attached, and PwnKit, which does work.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 2, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/05/02/htb-backendtwo.html">
                HTB: BackendTwo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-backendtwo " class="post-tag">htb-backendtwo</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#uvicorn " class="post-tag">uvicorn</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#json " class="post-tag">json</a> <a href="/tags#jq " class="post-tag">jq</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#swagger " class="post-tag">swagger</a> <a href="/tags#fastapi " class="post-tag">fastapi</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#pyjwt " class="post-tag">pyjwt</a> <a href="/tags#jwt-io " class="post-tag">jwt-io</a> <a href="/tags#simple-modify-headers " class="post-tag">simple-modify-headers</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#pam-wordle " class="post-tag">pam-wordle</a> <a href="/tags#mass-assignment " class="post-tag">mass-assignment</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#htb-backend " class="post-tag">htb-backend</a> <a href="/tags#htb-altered " class="post-tag">htb-altered</a> <a href="/tags#htb-backdoor " class="post-tag">htb-backdoor</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/backendtwo-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/backendtwo-cover.png" alt="BackendTwo" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>BackendTwo is this month’s UHC box. It builds on the first Backend UHC box, but with some updated vulnerabilities, as well as a couple small repeats from steps that never got played in UHC competition. It starts with an API that I’ll fuzz to figure out how to register. Then I’ll abuse a mass assignment vulnerability to give my user admin privs. From there, I can use a file read endpoint read /proc to find the page source, and eventually the signing secret for the JWT. With that, I can forge a new token allowing access to the file write api, where I’ll quietly insert a backdoor into an endpoint that returns a shell (and show how to just smash the door in as well). To escalate, it’s password reuse and cheating at pam-wordle.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 30, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/30/htb-search.html">
                HTB: Search
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-search " class="post-tag">htb-search</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#domain-controller " class="post-tag">domain-controller</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#password-spray " class="post-tag">password-spray</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#ldapdomaindump " class="post-tag">ldapdomaindump</a> <a href="/tags#jq " class="post-tag">jq</a> <a href="/tags#bloodhound-py " class="post-tag">bloodhound-py</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#kerberoast " class="post-tag">kerberoast</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#msoffice " class="post-tag">msoffice</a> <a href="/tags#office " class="post-tag">office</a> <a href="/tags#excel " class="post-tag">excel</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#pfx2john " class="post-tag">pfx2john</a> <a href="/tags#firefox-certificate " class="post-tag">firefox-certificate</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#client-certificate " class="post-tag">client-certificate</a> <a href="/tags#powershell-web-access " class="post-tag">powershell-web-access</a> <a href="/tags#gmsa " class="post-tag">gmsa</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/search-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/search-cover.png" alt="Search" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Search was a classic Active Directory Windows box. It starts by finding credentials in an image on the website, which I’ll use to dump the LDAP for the domain, and find a Kerberoastable user. There’s more using pivoting, each time finding another clue, with spraying for password reuse, credentials in an Excel workbook, and access to a PowerShell web access protected by client certificates. With that initial shell, its a a few hops identified through Bloodhound, including recoving a GMSA password, to get to domain admin.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 28, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/28/htb-rabbit.html">
                HTB: Rabbit
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-rabbit " class="post-tag">htb-rabbit</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#apache " class="post-tag">apache</a> <a href="/tags#wamp " class="post-tag">wamp</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#owa " class="post-tag">owa</a> <a href="/tags#exchange " class="post-tag">exchange</a> <a href="/tags#joomla " class="post-tag">joomla</a> <a href="/tags#complain-management-system " class="post-tag">complain-management-system</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#openoffice " class="post-tag">openoffice</a> <a href="/tags#macro " class="post-tag">macro</a> <a href="/tags#certutil " class="post-tag">certutil</a> <a href="/tags#powershellv2 " class="post-tag">powershellv2</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#schtasks " class="post-tag">schtasks</a> <a href="/tags#attrib " class="post-tag">attrib</a> <a href="/tags#htb-sizzle " class="post-tag">htb-sizzle</a> <a href="/tags#htb-fighter " class="post-tag">htb-fighter</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/rabbit-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/rabbit-cover.png" alt="Rabbit" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Rabbit was all about enumeration and rabbit holes. I’ll work to quickly eliminate vectors and try to focus in on ones that seem promising. I’ll find an instance of Complain Management System, and exploit multiple SQL injections to get a dump of hashes and usernames. I’ll use them to log into an Outlook Web Access portal, and use that access to send phishing documents with macros to get a shell. From there, I’ll find one of the webservers running as SYSTEM and write a webshell to get a shell. In Beyond Root, a look at a comically silly bug in the Complain Management System’s forgot password featuer, as well as at the scheduled tasks on the box handling the automation.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 25, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/25/htb-fighter.html">
                HTB: Fighter
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-fighter " class="post-tag">htb-fighter</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#xp-cmdshell " class="post-tag">xp-cmdshell</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#windows-firewall " class="post-tag">windows-firewall</a> <a href="/tags#applocker " class="post-tag">applocker</a> <a href="/tags#driverquery " class="post-tag">driverquery</a> <a href="/tags#capcom-sys " class="post-tag">capcom-sys</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#msbuild " class="post-tag">msbuild</a> <a href="/tags#applocker-bypass " class="post-tag">applocker-bypass</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#msfconsole " class="post-tag">msfconsole</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#juicypotato " class="post-tag">juicypotato</a> <a href="/tags#htb-fuse " class="post-tag">htb-fuse</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/fighter-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/fighter-cover.png" alt="Fighter" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Fighter is a solid old Windows box that requires avoiding AppLocker rules to exploit an SQL injection, hijack a bat script, and exploit the imfamous Capcom driver. I’ll show the intended path, as well as some AppLocker bypasses, how to modify the Metasploit Capcom exploit to work, and JuicyPotato (which was born from this box).</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 24, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/24/parallelizing-in-bash-and-python.html">
                Parallelizing in Bash and Python
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-backdoor " class="post-tag">htb-backdoor</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#bash-async " class="post-tag">bash-async</a> <a href="/tags#async " class="post-tag">async</a> <a href="/tags#python-async " class="post-tag">python-async</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#programming " class="post-tag">programming</a> <a href="/tags#brute-force " class="post-tag">brute-force</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/backdoor-scripts-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/backdoor-scripts-cover.png" alt="backdoor-scripts" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>To solve the Backdoor box from HackTheBox, I used a Bash script to loop over 2000 pids using a directory traversal / local file read vulnerability and pull their command lines. I wanted to play with parallelizing that attack, both in Bash and Python. I’ll share the results in this post / YouTube video.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 23, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/23/htb-backdoor.html">
                HTB: Backdoor
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-backdoor " class="post-tag">htb-backdoor</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#exploit-db " class="post-tag">exploit-db</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#ebooks-download " class="post-tag">ebooks-download</a> <a href="/tags#proc " class="post-tag">proc</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#gdbserver " class="post-tag">gdbserver</a> <a href="/tags#gdb-remote " class="post-tag">gdb-remote</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#screen " class="post-tag">screen</a> <a href="/tags#htb-pressed " class="post-tag">htb-pressed</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/backdoor-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/backdoor-cover.png" alt="Backdoor" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Backdoor starts by finding a WordPress plugin with a directory traversal bug that allows me to read files from the filesystem. I’ll use that to read within the /proc directory and identify a previously unknown listening port as gdbserver, which I’ll then exploit to get a shell. To get to root, I’ll join a screen session running as root in multiuser mode.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 20, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/20/htb-ariekei.html">
                HTB: Ariekei
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-ariekei " class="post-tag">htb-ariekei</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#cgi " class="post-tag">cgi</a> <a href="/tags#shellshock " class="post-tag">shellshock</a> <a href="/tags#cve-2014-6271 " class="post-tag">cve-2014-6271</a> <a href="/tags#image-tragick " class="post-tag">image-tragick</a> <a href="/tags#image-magick " class="post-tag">image-magick</a> <a href="/tags#cve-2016-3714 " class="post-tag">cve-2016-3714</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#ssh2john " class="post-tag">ssh2john</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#htb-shocker " class="post-tag">htb-shocker</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ariekei-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ariekei-cover.png" alt="Ariekei" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Ariekei is an insane-rated machine released on HackTheBox in 2017, focused around two very well known vulnerabilities, Shellshock and Image Tragic. I’ll find Shellshock very quickly, but not be able to exploit it due to a web application firewall. I’ll turn to another virtual host where there’s an image upload, and exploit Image Tragic to get a shell in a Docker container. I’ll use what I can enumerate about the network of docker containers and their secrets to to pivot to a new container that can talk directly to the website that’s vulnerable to Shellshock without the WAF, and exploit it to get access there. After escalating, I’ll find an SSH key that provides access to the host, and abuse the docker group to escalate to root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 16, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/16/htb-toby.html">
                HTB: Toby
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-toby " class="post-tag">htb-toby</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#backdoor " class="post-tag">backdoor</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#gogs " class="post-tag">gogs</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#php-deobfuscation " class="post-tag">php-deobfuscation</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#pam " class="post-tag">pam</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#htb-kryptos " class="post-tag">htb-kryptos</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/toby-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/toby-cover.png" alt="Toby" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Toby was a really unique challenge that involved tracing a previous attackers steps and poking a backdoors without full information about how they work. I’ll start by getting access to PHP source that shows where a webshell is loaded, but not the full execution. I’ll have to play with it to get it to give execution, figuring out how it communicates. From there I’ll pivot into a MySQL container and get hashes to get into the Gogs instance. Source code analysis plus some clever password generation allows me to pivot onto the main host, where I’ll have to use trouble tickets to find a PAM backdoor and brute force the password.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 14, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/14/htb-jeeves.html">
                HTB: Jeeves
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-jeeves " class="post-tag">htb-jeeves</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#jetty " class="post-tag">jetty</a> <a href="/tags#jenkins " class="post-tag">jenkins</a> <a href="/tags#keepass " class="post-tag">keepass</a> <a href="/tags#kpcli " class="post-tag">kpcli</a> <a href="/tags#hastcat " class="post-tag">hastcat</a> <a href="/tags#passthehash " class="post-tag">passthehash</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#psexec-py " class="post-tag">psexec-py</a> <a href="/tags#alternative-data-streams " class="post-tag">alternative-data-streams</a> <a href="/tags#htb-object " class="post-tag">htb-object</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/jeeves-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/jeeves-cover.png" alt="Jeeves" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Jeeves was first released in 2017, and I first solved it in 2018. Four years later, it’s been an interesting one to revisit. Some of the concepts seem not that new and exciting, but it’s worth remembering that Jeeves was the first to do them. I’ll start with a webserver and find a Jenkins instance with no auth. I can abuse Jenkins to get execution and remote shell. From there, I’ll find a KeePass database, and pull out a hash that I can pass to get execution as Administrator. root.txt is actually hidden in an alternative data stream.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 12, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/12/htb-backend.html">
                HTB: Backend
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-backend " class="post-tag">htb-backend</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#json " class="post-tag">json</a> <a href="/tags#uvicorn " class="post-tag">uvicorn</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#swagger " class="post-tag">swagger</a> <a href="/tags#fastapi " class="post-tag">fastapi</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#pyjwt " class="post-tag">pyjwt</a> <a href="/tags#jwt-io " class="post-tag">jwt-io</a> <a href="/tags#simple-modify-headers " class="post-tag">simple-modify-headers</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#uhc " class="post-tag">uhc</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/backend-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/backend-cover.png" alt="Backend" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Backend was all about enumerating and abusing an API, first to get access to the Swagger docs, then to get admin access, and then debug access. From there it allows execution of commands, which provides a shell on the box. To escalate to root, I’ll find a root password in the application logs where the user must have put in their password to the name field.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 11, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/11/htb-tally.html">
                HTB: Tally
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-tally " class="post-tag">htb-tally</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#sharepoint " class="post-tag">sharepoint</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#keepass " class="post-tag">keepass</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#kpcli " class="post-tag">kpcli</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#mssqlclient " class="post-tag">mssqlclient</a> <a href="/tags#xp-cmdshell " class="post-tag">xp-cmdshell</a> <a href="/tags#firefox " class="post-tag">firefox</a> <a href="/tags#user-agent " class="post-tag">user-agent</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#cve-2016-1960 " class="post-tag">cve-2016-1960</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#scheduled-task " class="post-tag">scheduled-task</a> <a href="/tags#rottenpotato " class="post-tag">rottenpotato</a> <a href="/tags#sweetpotato " class="post-tag">sweetpotato</a> <a href="/tags#cve-2017-0213 " class="post-tag">cve-2017-0213</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#windows-sessions " class="post-tag">windows-sessions</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#migrate " class="post-tag">migrate</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/tally-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/tally-cover.png" alt="Tally" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Tally is a difficult Windows Machine from Egre55, who likes to make boxes with multiple paths for each step. The box starts with a lot of enumeration, starting with a SharePoint instance that leaks creds for FTP. With FTP access, there are two paths to root. First there’s a KeePass db with creds for SMB, which has a binary with creds for MSSQL, and I can use MSSQL access to run commands and get a shell. Alternatively, I can spot a Firefox installer and a note saying that certain HTML pages on the FTP server will be visited regularly, and craft a malicious page to exploit that browser. To escalate, there’s a scheduled task running a writable PowerShell script as administrator. There’s also SeImpersonate privilege in a shell gained via MSSQL, which can be leveraged to get root as well. Finally, I’ll show a local Windows exploit that was common at the time of the box release, CVE-2017-0213.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 9, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/09/htb-overflow.html">
                HTB: Overflow
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-overflow " class="post-tag">htb-overflow</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#cookie " class="post-tag">cookie</a> <a href="/tags#padding-oracle " class="post-tag">padding-oracle</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#padbuster " class="post-tag">padbuster</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#cmsmadesimple " class="post-tag">cmsmadesimple</a> <a href="/tags#cve-2021-22204 " class="post-tag">cve-2021-22204</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#facl " class="post-tag">facl</a> <a href="/tags#getfacl " class="post-tag">getfacl</a> <a href="/tags#hosts " class="post-tag">hosts</a> <a href="/tags#time-of-check-time-of-use " class="post-tag">time-of-check-time-of-use</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-lazy " class="post-tag">htb-lazy</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/overflow-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/overflow-cover.png" alt="Overflow" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Overflow starts with a padding oracle attack on a cookie for a website. I’ll get to do some need cookie analysis before employing padbuster to decrypt the cookie and forge a new admin one. As admin, I get access to a logs panel with an SQL injection, where I can dump the db and crack the password to log into the CMS as well as a new virtual host with job adds. I’ll submit a malicious image that exploits a CVE in exiftool to get a shell. I’ll pivot to the next user with a credential from the web source. The next user is regularly running a script that pulls from another domain. With access to the hosts file, I’ll direct that domain to my machine and get execution. Finally, to get root, I’ll exploit a buffer overflow and a time of check / time of use vulnerability to get arbitrary read as root, and leverage that to get a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 7, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/07/htb-minion.html">
                HTB: Minion
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-minion " class="post-tag">htb-minion</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#asp " class="post-tag">asp</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#icmp-exfil " class="post-tag">icmp-exfil</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#powershell-runas " class="post-tag">powershell-runas</a> <a href="/tags#alternative-data-streams " class="post-tag">alternative-data-streams</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#htb-nest " class="post-tag">htb-nest</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/minion-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/minion-cover.png" alt="Minion" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Minion is four and a half years old, but it’s still really difficult. The steps themselves are not that hard, but the difficulty comes with the firewall that only allows ICMP out. So while I find a blind command execution relatively quickly, I’ll have to write my own shell using Python and PowerShell to exfil data over pings. The rest of the steps are also not hard on their own, just difficult to work through my ICMP shell. I’ll hijack a writable PowerShell script that runs on a schedule, and then find a password from the Administrator user in an alternative data stream on a backup file to get admin access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 4, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/04/htb-inception.html">
                HTB: Inception
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-inception " class="post-tag">htb-inception</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#dompdf " class="post-tag">dompdf</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#squid " class="post-tag">squid</a> <a href="/tags#proxychains " class="post-tag">proxychains</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#lxd " class="post-tag">lxd</a> <a href="/tags#php-filter " class="post-tag">php-filter</a> <a href="/tags#webdav " class="post-tag">webdav</a> <a href="/tags#davtest " class="post-tag">davtest</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#forward-shell " class="post-tag">forward-shell</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#ping-sweep " class="post-tag">ping-sweep</a> <a href="/tags#tftp " class="post-tag">tftp</a> <a href="/tags#apt " class="post-tag">apt</a> <a href="/tags#apt-pre-invoke " class="post-tag">apt-pre-invoke</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-joker " class="post-tag">htb-joker</a> <a href="/tags#htb-granny " class="post-tag">htb-granny</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/inception-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/inception-cover.png" alt="Inception" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Inception was one of the first boxes on HTB that used containers. I’ll start by exploiting a dompdf WordPress plugin to get access to files on the filesystem, which I’ll use to identify a WedDAV directory and credentials. I’ll abuse WebDAV to upload a webshell, and get a foothold in a container. Unfortunately, outbound traffic is blocked, so I can’t get a reverse shell. I’ll write a forward shell in Python to get a solid shell. After some password reuse and sudo, I’ll have root in the container. Looking at the host, from the container I can access FTP and TFTP. Using the two I’ll identify a cron running apt update, and write a pre-invoke script to get a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 2, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/04/02/htb-shibboleth.html">
                HTB: Shibboleth
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-shibboleth " class="post-tag">htb-shibboleth</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#zabbix " class="post-tag">zabbix</a> <a href="/tags#ipmi " class="post-tag">ipmi</a> <a href="/tags#msfconsole " class="post-tag">msfconsole</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#shared-object " class="post-tag">shared-object</a> <a href="/tags#rakp " class="post-tag">rakp</a> <a href="/tags#ipmipwner " class="post-tag">ipmipwner</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#cve-2021-27928 " class="post-tag">cve-2021-27928</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-zipper " class="post-tag">htb-zipper</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/shibboleth-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/shibboleth-cover.png" alt="Shibboleth" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Shibboleth starts with a static website and not much else. I’ll have to identify the clue to look into BMC automation and find IPMI listening on UDP. I’ll leak a hash from IPMI, and crack it to get creds to a Zabbix instance. Within Zabbix, I’ll have the agent run a command, providing a foothold. Some credential reuse pivots to the next user. To get root, I’ll exploit a CVE in MariaDB / MySQL. In Beyond Root, a video reversing the shared object file I used in that root exploit, as well as generating my own in C.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 30, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/03/30/htb-altered.html">
                HTB: Altered
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-altered " class="post-tag">htb-altered</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#type-juggling " class="post-tag">type-juggling</a> <a href="/tags#password-reset " class="post-tag">password-reset</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#rate-limit " class="post-tag">rate-limit</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqli-file " class="post-tag">sqli-file</a> <a href="/tags#sqli-union " class="post-tag">sqli-union</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#dirtypipe " class="post-tag">dirtypipe</a> <a href="/tags#cve-2022-0847 " class="post-tag">cve-2022-0847</a> <a href="/tags#pam-wordle " class="post-tag">pam-wordle</a> <a href="/tags#passwd " class="post-tag">passwd</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#htb-ransom " class="post-tag">htb-ransom</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/altered-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/altered-cover.png" alt="Altered" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Altered was another Ultimate Hacking Championship (UHC) box that’s now up on HTB. This one has another Laravel website. This time I’ll abuse the password reset capability, bypassing the rate limiting using HTTP headers to brute force the pin. Once in, I’ll find a endpoint that’s vulnerable to SQL injection, but only after abusing type-juggling to bypass an integrity check. Using that SQL injection, I’ll write a webshell and get a foothold. To get to root, I’ll abuse Dirty Pipe, with a twist. Most of the scripts to exploit Dirty Pipe modify the passwd file, but this box has pam-wordle installed, so you much play a silly game of tech-based Wordle to auth. I’ll show both how to solve this, and how to use a different technique that overwrites a SUID executable. In Beyond Root, I’ll reverse how that latter exploit works.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 26, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/03/26/htb-secret.html">
                HTB: Secret
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-secret " class="post-tag">htb-secret</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#pyjwt " class="post-tag">pyjwt</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#pr-set-dumpable " class="post-tag">pr-set-dumpable</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#crash-dump " class="post-tag">crash-dump</a> <a href="/tags#var-crash " class="post-tag">var-crash</a> <a href="/tags#appport-unpack " class="post-tag">appport-unpack</a> <a href="/tags#core-dump " class="post-tag">core-dump</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/secret-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/secret-cover.png" alt="Secret" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>To get a foothold on Secret, I’ll start with source code analysis in a Git repository to identify how authentication works and find the JWT signing secret. With that secret, I’ll get access to the admin functions, one of which is vulnerable to command injection, and use this to get a shell. To get to root, I’ll abuse a SUID file in two different ways. The first is to get read access to files using the open file descriptors. The alternative path is to crash the program and read the content from the crashdump.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 19, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/03/19/htb-stacked.html">
                HTB: Stacked
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-stacked " class="post-tag">htb-stacked</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#localstack " class="post-tag">localstack</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#docker-compose " class="post-tag">docker-compose</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#xss-referer " class="post-tag">xss-referer</a> <a href="/tags#aws " class="post-tag">aws</a> <a href="/tags#awslocal " class="post-tag">awslocal</a> <a href="/tags#aws-lambda " class="post-tag">aws-lambda</a> <a href="/tags#cve-2021-32090 " class="post-tag">cve-2021-32090</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#htb-crossfit " class="post-tag">htb-crossfit</a> <a href="/tags#htb-bankrobber " class="post-tag">htb-bankrobber</a> <a href="/tags#htb-bucket " class="post-tag">htb-bucket</a> <a href="/tags#htb-epsilon " class="post-tag">htb-epsilon</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/stacked-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/stacked-cover.png" alt="Stacked" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Stacked was really hard. The foothold involved identifying XSS in a referer header that landed in an mail application that I could not see. I’ll use the XSS to enumerate that mailbox and find a subdomain used for an instance of localstack. From there, I’ll find I can create Lambda functions, and there’s a command injection vulnerability in the dashboard if it displays a malformed function name. I’ll use the XSS to load that page in an IFrame and trigger the vulnerability, providing a foothold in the localstack container. To escalate in that container, I’ll use Pspy to monitor what happens when localstack runs a lambda function, and find that it is also vulnerable to command injection as root. From root in the container, I can get full access to the host filesystem and a shell. In Beyond Root, I’ll take a look at the mail application and the automations triggering the XSS vulnerabilities.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 15, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/03/15/htb-ransom.html">
                HTB: Ransom
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-ransom " class="post-tag">htb-ransom</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#type-juggling " class="post-tag">type-juggling</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#zipcrypto " class="post-tag">zipcrypto</a> <a href="/tags#known-plaintext " class="post-tag">known-plaintext</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#bkcrack " class="post-tag">bkcrack</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ransom-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ransom-cover.png" alt="Ransom" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Ransom was a UHC qualifier box, targeting the easy to medium range. It has three basic steps. First, I’ll bypass a login screen by playing with the request and type juggling. Then I’ll access files in an encrypted zip archive using a known plaintext attack and bkcrypt. Finally, I’ll find credentials in HTML source that work to get root on the box. In Beyond Root, I’ll look at the structure of a Laravel application, examine how the api requests were handled and how I managed to get JSON data into a GET request, and finally look at the type juggling, why it worked, and how to fix it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 12, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/03/12/htb-devzat.html">
                HTB: Devzat
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-devzat " class="post-tag">htb-devzat</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#devzat " class="post-tag">devzat</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#go " class="post-tag">go</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#influxdb " class="post-tag">influxdb</a> <a href="/tags#cve-2019-20933 " class="post-tag">cve-2019-20933</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#pyjwt " class="post-tag">pyjwt</a> <a href="/tags#jwt-io " class="post-tag">jwt-io</a> <a href="/tags#htb-cereal " class="post-tag">htb-cereal</a> <a href="/tags#htb-dyplesher " class="post-tag">htb-dyplesher</a> <a href="/tags#htb-travel " class="post-tag">htb-travel</a> <a href="/tags#htb-epsilon " class="post-tag">htb-epsilon</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/devzat-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/devzat-cover.png" alt="Devzat" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Devzat is centered around a chat over SSH tool called Devzat. To start, I can connect, but there is at least one username I can’t access. I’ll find a pet-themed site on a virtual host, and find it has an exposed git repository. Looking at the code shows file read / directory traversal and command injection vulnerabilities. I’ll use the command injection to get a shell. From localhost, I can access the chat for the first user, where there’s history showing another user telling them about an influxdb instance. I’ll find an auth bypass exploit to read the db, and get the next user’s password. This user has access to the source for a new version of Devzat. Analysis of this version shows a new command, complete with a file read vulnerability that I’ll use to read root’s private key and get a shell over SSH.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 10, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/03/10/htb-epsilon.html">
                HTB: Epsilon
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-epsilon " class="post-tag">htb-epsilon</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#gitdumper " class="post-tag">gitdumper</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#aws " class="post-tag">aws</a> <a href="/tags#awscli " class="post-tag">awscli</a> <a href="/tags#aws-lambda " class="post-tag">aws-lambda</a> <a href="/tags#htb-gobox " class="post-tag">htb-gobox</a> <a href="/tags#htb-bolt " class="post-tag">htb-bolt</a> <a href="/tags#htb-bucket " class="post-tag">htb-bucket</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#timing-attack " class="post-tag">timing-attack</a> <a href="/tags#cron " class="post-tag">cron</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/epsilon-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/epsilon-cover.png" alt="Epsilon" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Epsilon originally released in the 2021 HTB University CTF, but later released on HTB for others to play. In this box, I’ll start by finding an exposed git repo on the webserver, and use that to find source code for the site, including the AWS keys. Those keys get access to lambda functions which contain a secret that is reused as the secret for the signing of JWT tokens on the site. With that secret, I’ll get access to the site and abuse a server-side template injection to get execution and an initial shell. To escalate to root, there’s a backup script that is creating tar archives of the webserver which I can abuse to get a copy of root’s home directory, including the flag and an SSH key for shell access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 5, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/03/05/htb-hancliffe.html">
                HTB: Hancliffe
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-hancliffe " class="post-tag">htb-hancliffe</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#hashpass " class="post-tag">hashpass</a> <a href="/tags#nuxeo " class="post-tag">nuxeo</a> <a href="/tags#uri-parsing " class="post-tag">uri-parsing</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#unified-remote " class="post-tag">unified-remote</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#firefox " class="post-tag">firefox</a> <a href="/tags#firepwd " class="post-tag">firepwd</a> <a href="/tags#winpeas " class="post-tag">winpeas</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-seal " class="post-tag">htb-seal</a> <a href="/tags#htb-logforge " class="post-tag">htb-logforge</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#x32dbg " class="post-tag">x32dbg</a> <a href="/tags#rot-47 " class="post-tag">rot-47</a> <a href="/tags#atbash " class="post-tag">atbash</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#jmp-esp " class="post-tag">jmp-esp</a> <a href="/tags#metasm " class="post-tag">metasm</a> <a href="/tags#nasm " class="post-tag">nasm</a> <a href="/tags#socket-reuse " class="post-tag">socket-reuse</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#wmic " class="post-tag">wmic</a> <a href="/tags#dep " class="post-tag">dep</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hancliffe-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hancliffe-cover.png" alt="Hancliffe" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Hancliffe starts with a uri parsing vulnerability that provides access to an internal instance of Nuxeo, which is vulnerable to a Java server-side template injection that leads to RCE. With a foothold, I can tunnel to access an instance of Universal Remote, which allows RCE as the next user. That user has a stored password in Firefox for H@$hPa$$, which gives the password for the next user. Finally, this user has access to a development application that is vulnerable to an interesting and tricky buffer overflow, where I’ll have to jump around on the stack and use socket reuse to get execution as administrator.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 28, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/28/htb-object.html">
                HTB: Object
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-object " class="post-tag">htb-object</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#uni-ctf " class="post-tag">uni-ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#jenkins " class="post-tag">jenkins</a> <a href="/tags#cicd " class="post-tag">cicd</a> <a href="/tags#firewall " class="post-tag">firewall</a> <a href="/tags#windows-firewall " class="post-tag">windows-firewall</a> <a href="/tags#jenkins-credential-decryptor " class="post-tag">jenkins-credential-decryptor</a> <a href="/tags#pwn-jenkins " class="post-tag">pwn-jenkins</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#sharphound " class="post-tag">sharphound</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#github " class="post-tag">github</a> <a href="/tags#forcechangepassword " class="post-tag">forcechangepassword</a> <a href="/tags#genericwrite " class="post-tag">genericwrite</a> <a href="/tags#writeowner " class="post-tag">writeowner</a> <a href="/tags#logon-script " class="post-tag">logon-script</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#scheduled-task " class="post-tag">scheduled-task</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#htb-jeeves " class="post-tag">htb-jeeves</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/object-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/object-cover.png" alt="Object" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Object was tricky for a CTF box, from the HackTheBox University CTF in 2021. I’ll start with access to a Jenkins server where I can create a pipeline (or job), but I don’t have permissions to manually tell it to build. I’ll show two ways to get it to build anyway, providing execution. I’ll enumerate the firewall to see that no TCP traffic can reach outbound, and eventually find credentials and get a connection over WinRM. From there, it’s three hops of Active Directory abuse, all made clear by BloodHound. First a password change, then abusing logon scripts, and finally some group privileges. In Beyond Root, I’ll enumerate the automation that ran the logon scripts as one of the users.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 26, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/26/htb-driver.html">
                HTB: Driver
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-driver " class="post-tag">htb-driver</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#net-ntlmv2 " class="post-tag">net-ntlmv2</a> <a href="/tags#scf " class="post-tag">scf</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#cve-2019-19363 " class="post-tag">cve-2019-19363</a> <a href="/tags#winpeas " class="post-tag">winpeas</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#history " class="post-tag">history</a> <a href="/tags#powershell-history " class="post-tag">powershell-history</a> <a href="/tags#printer " class="post-tag">printer</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#exploit-suggestor " class="post-tag">exploit-suggestor</a> <a href="/tags#windows-sessions " class="post-tag">windows-sessions</a> <a href="/tags#printnightmare " class="post-tag">printnightmare</a> <a href="/tags#cve-2021-1675 " class="post-tag">cve-2021-1675</a> <a href="/tags#invoke-nightmare " class="post-tag">invoke-nightmare</a> <a href="/tags#htb-sizzle " class="post-tag">htb-sizzle</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/driver-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/driver-cover.png" alt="Driver" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Drive released as part of the HackTheBox printer exploitation track. To get access, there’s a printer web page that allows users to upload to a file share. I’ll upload an scf file, which triggers anyone looking at the share in Explorer to try network authentication to my server, where I’ll capture and crack the password for the user. That password works to connect to WinRM, providing a foothold to Driver. To escalate, I can exploit either a Ricoh printer driver or PrintNightmare, and I’ll show both.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 23, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/23/htb-goodgames.html">
                HTB: GoodGames
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-goodgames " class="post-tag">htb-goodgames</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#uni-ctf " class="post-tag">uni-ctf</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqli-bypass " class="post-tag">sqli-bypass</a> <a href="/tags#sqli-union " class="post-tag">sqli-union</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#escape " class="post-tag">escape</a> <a href="/tags#docker-mount " class="post-tag">docker-mount</a> <a href="/tags#htb-bolt " class="post-tag">htb-bolt</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/goodgames-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/goodgames-cover.png" alt="GoodGames" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>GoodGames has some basic web vulnerabilities. First there’s a SQL injection that allows for both a login bypass and union injection to dump data. The admin’s page shows a new virtualhost, which, after authing with creds from the database, has a server-side template injection vulnerability in the name in the profile, which allows for coded execution and a shell in a docker container. From that container, I’ll find the same password reused by a user on the host, and SSH to get access. On the host, I’ll abuse the home directory that’s mounted into the container and the way Linux does file permissions and ownership to get a shell as root on the host.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 19, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/19/htb-bolt.html">
                HTB: Bolt
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-bolt " class="post-tag">htb-bolt</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#docker-tar " class="post-tag">docker-tar</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#roundcube " class="post-tag">roundcube</a> <a href="/tags#webmail " class="post-tag">webmail</a> <a href="/tags#passbolt " class="post-tag">passbolt</a> <a href="/tags#dive " class="post-tag">dive</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#password-reset " class="post-tag">password-reset</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#chrome " class="post-tag">chrome</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bolt-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bolt-cover.png" alt="Bolt" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Bolt was all about exploiting various websites with different bits of information collected along the way. To start, I’ll download a Docker image from the website, and pull various secrets from the older layers of the image, including a SQLite database and the source to the demo website. With that, I’m able to get into the demo website and exploit a server-side template injection vulnerability to get a foothold on the box. After some password reuse to get to the next user, I’ll go into the user’s Chrome profile to pull out the PGP key associated with their Passbolt password manager account, and use it along with database access to reset the users password and get access to their passwords, including the root password. In Beyond Root, a deep dive into the SSTI payloads used on this box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 14, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/14/htb-steamcloud.html">
                HTB: SteamCloud
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-steamcloud " class="post-tag">htb-steamcloud</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#uni-ctf " class="post-tag">uni-ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#kubernetes " class="post-tag">kubernetes</a> <a href="/tags#minikube " class="post-tag">minikube</a> <a href="/tags#htb-unobtainium " class="post-tag">htb-unobtainium</a> <a href="/tags#kubectl " class="post-tag">kubectl</a> <a href="/tags#kubeletctl " class="post-tag">kubeletctl</a> <a href="/tags#container " class="post-tag">container</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/steamcloud-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/steamcloud-cover.png" alt="SteamCloud" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>SteamCloud just presents a bunch of Kubernetes-related ports. Without a way to authenticate, I can’t do anything with the Kubernetes API. But I also have access to the Kubelet running on one of the nodes (which is the same host), and that gives access to the pods running on that node. I’ll get into one and get out the keys necessary to auth to the Kubernetes API. From there, I can spawn a new pod, mounting the host file system into it, and get full access to the host. I’ll eventually manage to turn that access into a shell as well.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 12, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/12/htb-earlyaccess.html">
                HTB: EarlyAccess
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-earlyaccess " class="post-tag">htb-earlyaccess</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#xss-cookies " class="post-tag">xss-cookies</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#second-order " class="post-tag">second-order</a> <a href="/tags#second-order-sqli " class="post-tag">second-order-sqli</a> <a href="/tags#htb-nightmare " class="post-tag">htb-nightmare</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#php-filter " class="post-tag">php-filter</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#wget " class="post-tag">wget</a> <a href="/tags#escape " class="post-tag">escape</a> <a href="/tags#arp " class="post-tag">arp</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/earlyaccess-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/earlyaccess-cover.png" alt="EarlyAccess" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>When it comes to telling a story, EarlyAccess might be my favorite box on HackTheBox. It’s the box of a game company, with fantastic marketing on their front page for a game that turns out to be snake. I’ll need multiple exploits including XSS and second order SQLI to get admin on the signup site, abuse that to move the the game site, and from there to the dev site. From the dev site I’ll find a command injection to get a shell in the website’s docker container. I’ll abuse an API to leak another password to get onto the host. From there its back into another docker container, where I’ll crash the container to get execution and shell as root, getting access to the shadow file and a password for the host. Finally, I’ll abuse capabilities on arp to get read as root, the flag, and the root SSH key. In Beyond root, looking at a couple unintended paths.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 9, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/09/htb-flustered.html">
                HTB: Flustered
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-flustered " class="post-tag">htb-flustered</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#uni-ctf " class="post-tag">uni-ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#squid " class="post-tag">squid</a> <a href="/tags#glusterfs " class="post-tag">glusterfs</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#foxyproxy " class="post-tag">foxyproxy</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#azure-storage " class="post-tag">azure-storage</a> <a href="/tags#azure-storage-explorer " class="post-tag">azure-storage-explorer</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flustered-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flustered-cover.png" alt="Flustered" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Fluster starts out with a coming soon webpage and a squid proxy. When both turn out as dead ends, I’ll identify GlusterFS, with a volume I can mount without auth. This volume has the MySQL data stores, and from it I’ll find Squid credentials. With access to the proxy, I’ll find the application source code, and exploit a server-side template injection vulnerability to get execution. With a foothold, I’ll find the keys necessary to get access to a second Gluster volume, which gives access as user. To root, I’ll connect to a Docker container hosting an emulated Azure Storage, and using a key from the host, pull the root SSH key. In Beyond root, an exploration into Squid and NGINX configs, and a look at full recreating the database based on the files from the remote volume.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 7, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/07/funware-cactuscon-2022-ctf.html">
                FunWare [CactusCon 2022 CTF]
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#cactuscon " class="post-tag">cactuscon</a> <a href="/tags#ctf-funware " class="post-tag">ctf-funware</a> <a href="/tags#forensics " class="post-tag">forensics</a> <a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ftk-imager " class="post-tag">ftk-imager</a> <a href="/tags#access-data-file " class="post-tag">access-data-file</a> <a href="/tags#ransomeware " class="post-tag">ransomeware</a> <a href="/tags#pyinstaller " class="post-tag">pyinstaller</a> <a href="/tags#pyinstxtractor " class="post-tag">pyinstxtractor</a> <a href="/tags#flare-on-wopr " class="post-tag">flare-on-wopr</a> <a href="/tags#uncompyle6 " class="post-tag">uncompyle6</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#firefox " class="post-tag">firefox</a> <a href="/tags#firepwd " class="post-tag">firepwd</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/cactuscon-ctf-2022-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/cactuscon-ctf-2022-cover.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Over the weekend, a few of us from Neutrino Cannon competed in the CactusCon 2022 CTF by ThreatSims. PolarBearer and I worked on a challenge called Funware, which was a interesting forensics challenge that starts with a disk image of a system that’d been ransomwared, and leads to understanding the malware, decrypting the files, and finding where it was downloaded from. It was a fun forensics challenge. Thanks to <a href="https://twitter.com/pwnEIP">@pwnEIP</a> and <a href="https://twitter.com/Cone_Virus">@Cone_Virus</a> for the challenge and for getting me the questions after it was over so I could write this up.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 5, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/05/htb-horizontall.html">
                HTB: Horizontall
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-horizontall " class="post-tag">htb-horizontall</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#strapi " class="post-tag">strapi</a> <a href="/tags#cve-2019-18818 " class="post-tag">cve-2019-18818</a> <a href="/tags#cve-2019-19609 " class="post-tag">cve-2019-19609</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#phpggc " class="post-tag">phpggc</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/horizontall-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/horizontall-cover.png" alt="Horizontall" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Horizonatll was built around vulnerabilities in two web frameworks. First there’s discovering an instance of strapi, where I’ll abuse a CVE to reset the administrator’s password, and then use an authenticated command injection vulnerability to get a shell. With a foldhold on the box, I’ll examine a dev instance of Laravel running only on localhost, and manage to crash it and leak the secrets. From there, I can do a deserialization attack to get execution as root. In Beyond Root, I’ll dig a bit deeper on the strapi CVEs and how they were patched.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 3, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/02/03/htb-pressed.html">
                HTB: Pressed
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-pressed " class="post-tag">htb-pressed</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#totp " class="post-tag">totp</a> <a href="/tags#2fa " class="post-tag">2fa</a> <a href="/tags#xml-rpc " class="post-tag">xml-rpc</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-wordpress-xmlrpc " class="post-tag">python-wordpress-xmlrpc</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#pwnkit " class="post-tag">pwnkit</a> <a href="/tags#cve-2021-4034 " class="post-tag">cve-2021-4034</a> <a href="/tags#pkexec " class="post-tag">pkexec</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-scavenger " class="post-tag">htb-scavenger</a> <a href="/tags#htb-stratosphere " class="post-tag">htb-stratosphere</a> <a href="/tags#wp-miniorgange " class="post-tag">wp-miniorgange</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/pressed-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/pressed-cover.png" alt="Pressed" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Pressed presents a unique attack vector on WordPress, where you have access to admin creds right from the start, but can’t log in because of 2FA. This means it’s time to abuse XML-RPC, the thing that wpscan shows as a vulnerability on every WordPress instance, is rarely useful. I’ll leak the source for the single post on the site, and see that’s it’s using PHPEverywhere to run PHP from within the post. I’ll edit the post to include a webshell. The firewall is blocking outbound traffic, so I can’t get a reverse shell. The box is vulnerable to PwnKit, so I’ll have to modify the exploit to work over the webshell. After leaking the root flag, I’ll go beyond with a Video where I take down the firewall and get a root shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 29, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/01/29/htb-anubis.html">
                HTB: Anubis
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-anubis " class="post-tag">htb-anubis</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#adcs " class="post-tag">adcs</a> <a href="/tags#htb-sizzle " class="post-tag">htb-sizzle</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#certificate-authority " class="post-tag">certificate-authority</a> <a href="/tags#client-certificate " class="post-tag">client-certificate</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#proxychains " class="post-tag">proxychains</a> <a href="/tags#foxyproxy " class="post-tag">foxyproxy</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#net-ntlmv2 " class="post-tag">net-ntlmv2</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#jamovi " class="post-tag">jamovi</a> <a href="/tags#cve-2021-28079 " class="post-tag">cve-2021-28079</a> <a href="/tags#electron " class="post-tag">electron</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#certutil " class="post-tag">certutil</a> <a href="/tags#certreq " class="post-tag">certreq</a> <a href="/tags#certify " class="post-tag">certify</a> <a href="/tags#certificate-template " class="post-tag">certificate-template</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#klist " class="post-tag">klist</a> <a href="/tags#kinit " class="post-tag">kinit</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#posh-adcs " class="post-tag">posh-adcs</a> <a href="/tags#rubeus " class="post-tag">rubeus</a> <a href="/tags#sharp-collection " class="post-tag">sharp-collection</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#psexec-py " class="post-tag">psexec-py</a> <a href="/tags#faketime " class="post-tag">faketime</a> <a href="/tags#htb-sizzle " class="post-tag">htb-sizzle</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/anubis-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/anubis-cover.png" alt="Anubis" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Anubis starts simply enough, with a ASP injection leading to code execution in a Windows Docker container. In the container I’ll find a certificate request, which leaks the hostname of an internal web server. That server is handling software installs, and by giving it my IP, I’ll capture and crack the NetNTLMv2 hash associated with the account doing the installs. That account provides SMB access, where I find Jamovi files, one of which has been accessed recently. I’ll exploit these files to get execution and a foothold on the host. To escalate, I’ll find a certificate template that the current user has full control over. I’ll use that control to add smart card authentication as a purpose for the template, and create one for administrator. I’ll show how to do this the more manual way, getting the certificate and then authenticating with Kerveros from my Linux VM. Then I’ll go back and do it again using PoshADCS and Rubeus all on Anubis.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 22, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/01/22/htb-forge.html">
                HTB: Forge
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-forge " class="post-tag">htb-forge</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#redirection " class="post-tag">redirection</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pdb " class="post-tag">pdb</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/forge-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/forge-cover.png" alt="Forge" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The website on Forge has an server-side request forgery (SSRF) vulnerability that I can use to access the admin site, available only from localhost. But to do that, I have to bypass a deny list of terms in the given URL. I’ll have the server contact me, and return a redirect to the site I actually want to have it visit. From the admin site, I can see that it too has an SSRF, and it can manage FTP as well. I’ll update my redirect to have it fetch files from the local FTP server, including the user flag and the user’s SSH private key. The user is able to run a Python script as root, and because of how this script uses PDB (the Python debugger), I can exploit the crash to get a shell as root. In Beyond Root, I’ll look at bypassing the filter, and explore the webserver configuration to figure out how the webserver talks FTP.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 15, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/01/15/htb-developer.html">
                HTB: Developer
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-developer " class="post-tag">htb-developer</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#django " class="post-tag">django</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#ps2exe " class="post-tag">ps2exe</a> <a href="/tags#xls " class="post-tag">xls</a> <a href="/tags#office " class="post-tag">office</a> <a href="/tags#msoffice " class="post-tag">msoffice</a> <a href="/tags#excel " class="post-tag">excel</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#reverse-tab-nabbing " class="post-tag">reverse-tab-nabbing</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#sentry " class="post-tag">sentry</a> <a href="/tags#postgres " class="post-tag">postgres</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/developer-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/developer-cover.png" alt="Developer" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Developer is a CTF platform modeled off of HackTheBox! When I sign up for an account, there are eight real challenges to play across four different categories. On solving one, I can submit a write-up link, which the admin will click. This link is vulnerable to reverse-tab-nabbing, a neat exploit where the writeup opens in a new window, but it can get the original window to redirect to a site of my choosing. I’ll make it look like it logged out, and capture credentials from the admin, giving me access to the Django admin panel and the Sentry application. I’ll crash that application to see Django is running in debug mode, and get the secret necessary to perform a deserialization attack, providing execution and a foothold on the box. I’ll dump the Django hashes from the Postgresql DB for Senty and crack them to get the creds for the next user. For root, there’s a sudo executable that I can reverse to get the password which leads to SSH access as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 10, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/01/10/htb-nodeblog.html">
                HTB: NodeBlog
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-nodeblog " class="post-tag">htb-nodeblog</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#nosql-injection " class="post-tag">nosql-injection</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#node-serialize " class="post-tag">node-serialize</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#json-deserialization " class="post-tag">json-deserialization</a> <a href="/tags#mongo " class="post-tag">mongo</a> <a href="/tags#mongodump " class="post-tag">mongodump</a> <a href="/tags#bsondump " class="post-tag">bsondump</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/nodeblog-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/nodeblog-cover.png" alt="NodeBlog" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>This UHC qualifier box was a neat take on some common NodeJS vulnerabilities. First there’s a NoSQL authentication bypass. Then I’ll use XXE in some post upload ability to leak files, including the site source. With that, I’ll spot a deserialization vulnerability which I can abuse to get RCE. I’ll get the user’s password from Mongo via the shell or through the NoSQL injection, and use that to escalate to root. In Beyond Root, a look at characters that broke the deserialization payload, and scripting the NoSQL injection.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 8, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2022/01/08/htb-previse.html">
                HTB: Previse
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-previse " class="post-tag">htb-previse</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#execute-after-redirect " class="post-tag">execute-after-redirect</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqli-insert " class="post-tag">sqli-insert</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/previse-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/previse-cover.png" alt="Previse" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>To get a foothold on Previse, first I’ll exploit an execute after redirect vulnerability in the webpage that allows me access to restricted sites despite not being logged in. From those sites, I’ll create a user for myself and log in normally. Then I get the source to the site, and I’ll find a command injection vulnerability (both using the source and just by enumerating the site) to get a foothold on the box. To escalate, I’ll go into the database and dump the user hashes, one of which cracks to the password for a user on the box. For root, there’s a bash script with a path hijack vulnerability that can run with sudo, allowing for execution. In Beyond Root I’ll look at the standard sudo config and what was changed for Previse, and then look at an unintended SQL injection in an insert statement.</p>

</li>
        















          <li class="post-list-li"><span class="post-meta">Jan 8, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/holidayhack2021/">
                2021 SANS Holiday Hack Challenge, featuring KringleCon 4: Calling Birds
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#sans-holiday-hack " class="post-tag">sans-holiday-hack</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hh21-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hh21-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:180px;" class="include_image " />
</picture>

<p>The 2021 SANS Holiday Hack Challenge was the battle of two competing conferences. Santa is hosting the 4th annual KringleCon at the North Pole, and Jack Front has set up a competing conference next door, FrostFest.  This years challenge conference included <a href="https://www.youtube.com/watch?v=lRbd2C6NHOg&amp;list=PLjLd1hNA7YVx99qJF3OoPF-qunjqw-SoU">14 talks from leaders in information security</a>, including a late entry from the elf, Professor Qwerty Petabyte, covering Log4j. In addition to the talks, there were 15 terminals / in-game puzzles and 13 objectives to solve. In solving all of these, the Jack Frost’s plot was foiled. As usual, the challenges were interesting and set up in such a way that it was very beginner friendly, with lots of hints and talks to ensure that you learned something while solving.</p>

</li>
        



          <li class="post-list-li"><span class="post-meta">Jan 1, 2022</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2021">
                Hackvent 2021
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#gitdumper " class="post-tag">gitdumper</a> <a href="/tags#obfuscation " class="post-tag">obfuscation</a> <a href="/tags#brainfuck " class="post-tag">brainfuck</a> <a href="/tags#polyglot " class="post-tag">polyglot</a> <a href="/tags#jsfuck " class="post-tag">jsfuck</a> <a href="/tags#de4js " class="post-tag">de4js</a> <a href="/tags#python-pil " class="post-tag">python-pil</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#pcap " class="post-tag">pcap</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#content-length " class="post-tag">content-length</a> <a href="/tags#ignore-content-length " class="post-tag">ignore-content-length</a> <a href="/tags#cistercian-numerals " class="post-tag">cistercian-numerals</a> <a href="/tags#code-golf " class="post-tag">code-golf</a> <a href="/tags#type-juggling " class="post-tag">type-juggling</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#clara-io " class="post-tag">clara-io</a> <a href="/tags#stl " class="post-tag">stl</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#kotlin " class="post-tag">kotlin</a> <a href="/tags#race-condition " class="post-tag">race-condition</a> <a href="/tags#p-384 " class="post-tag">p-384</a> <a href="/tags#eliptic-curve " class="post-tag">eliptic-curve</a> <a href="/tags#signing " class="post-tag">signing</a> <a href="/tags#crypto " class="post-tag">crypto</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hv21-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hv21-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:150px;" class="include_image " />
</picture>

<p>This year I was only able to complete 14 of the 24 days of challenges, but it was still a good time. I learned something about how web clients handle content lengths, how to obfuscate JavaScript for a golf competition, and exploited some neat crypto to sign commands for a server.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 29, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/12/29/htb-logforge.html">
                HTB: LogForge
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-logforge " class="post-tag">htb-logforge</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#jsp " class="post-tag">jsp</a> <a href="/tags#jsessionid " class="post-tag">jsessionid</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#apache-tomcat-parse " class="post-tag">apache-tomcat-parse</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#war " class="post-tag">war</a> <a href="/tags#log4shell " class="post-tag">log4shell</a> <a href="/tags#log4j " class="post-tag">log4j</a> <a href="/tags#jndi " class="post-tag">jndi</a> <a href="/tags#ysoserial " class="post-tag">ysoserial</a> <a href="/tags#jndi-exploit-kit " class="post-tag">jndi-exploit-kit</a> <a href="/tags#ysoserial-modified " class="post-tag">ysoserial-modified</a> <a href="/tags#jd-gui " class="post-tag">jd-gui</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#jar " class="post-tag">jar</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#uri-parsing " class="post-tag">uri-parsing</a> <a href="/tags#htb-seal " class="post-tag">htb-seal</a> <a href="/tags#htb-pikaboo " class="post-tag">htb-pikaboo</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/logforge-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/logforge-cover.png" alt="LogForge" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>LogForge was a UHC box that HTB created entirely focused on Log4j / Log4Shell. To start, there’s an Orange Tsai attack against how Apache is hosting Tomcat, allowing the bypass of restrictions to get access to the manager page. From there, I’ll exploit Log4j to get a shell as the tomcat user. With a foothold on the machine, there’s an FTP server running as root listening only on localhost. This FTP server is Java based, and reversing it shows it’s using Log4j to log usernames. I’ll exploit this to leak the environment variables used to store the username and password needed to access the FTP server, and use that to get access to the root flag. The password also works to get a root shell. In Beyond Root I’ll look at using netcat to read the LDAP requests and do some binary RE of LDAP on the wire.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 18, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/12/18/htb-static.html">
                HTB: Static
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-static " class="post-tag">htb-static</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#vpn " class="post-tag">vpn</a> <a href="/tags#openvpn " class="post-tag">openvpn</a> <a href="/tags#totp " class="post-tag">totp</a> <a href="/tags#fixgz " class="post-tag">fixgz</a> <a href="/tags#oathtool " class="post-tag">oathtool</a> <a href="/tags#ntp " class="post-tag">ntp</a> <a href="/tags#ntpdate " class="post-tag">ntpdate</a> <a href="/tags#route " class="post-tag">route</a> <a href="/tags#xdebug " class="post-tag">xdebug</a> <a href="/tags#dbgpclient " class="post-tag">dbgpClient</a> <a href="/tags#htb-olympus " class="post-tag">htb-olympus</a> <a href="/tags#htb-jewel " class="post-tag">htb-jewel</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#socks " class="post-tag">socks</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#cve-2019-11043 " class="post-tag">cve-2019-11043</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#format-string " class="post-tag">format-string</a> <a href="/tags#htb-rope " class="post-tag">htb-rope</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#aslr " class="post-tag">aslr</a> <a href="/tags#socat " class="post-tag">socat</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#easy-rsa " class="post-tag">easy-rsa</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/static-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/static-cover.png" alt="Static" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Static was a really great hard box. I’ll start by finding a corrupted gzipped SQL backup, which I can use to leak the seed for a TOTP 2FA, allowing me access to an internal page. There I’ll get a VPN config, which I’ll use to connect to the network and get access to additional hosts. There’s a web host that has xdebug running on it’s PHP page, allowing for code execution. From there, I’ll pivot to a PKI host that I can only reach from web. I’ll exploit a PHP-FPM bug to get a shell on there. On this box, there’s a binary with setuid capabilities and a format string exploit, which I’ll use to leak addresses and then overwrite the path to a binary called to have it run my reverse shell. In Beyond Root, I’ll look at an unintended Path Hijack in an actual open-source program, easy-rsa.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 11, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/12/11/htb-writer.html">
                HTB: Writer
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-writer " class="post-tag">htb-writer</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#auth-bypass " class="post-tag">auth-bypass</a> <a href="/tags#ffuf " class="post-tag">ffuf</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#apache " class="post-tag">apache</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#django " class="post-tag">django</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#postfix " class="post-tag">postfix</a> <a href="/tags#swaks " class="post-tag">swaks</a> <a href="/tags#apt " class="post-tag">apt</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/writer-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/writer-cover.png" alt="Writer" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Writer was really hard for a medium box. There’s an SQL injection that provides both authentication bypass and file read on the system. The foothold involved either chaining togethers file uploads and file downloads to get a command injection, or using an SSRF to trigger a development site that is editable using creds found in the site files to access SMB. With a shell, the first pivot is using creds from the Django DB after cracking the hash. Then I’ll inject into a Postfix mail filter and trigger it be sending an email. Finally, there’s an editable apt config file that allows command injection as root. In beyond root, I’ll show the intended path using the SSRF to trigger the modified dev site.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 4, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/12/04/htb-pikaboo.html">
                HTB: Pikaboo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-pikaboo " class="post-tag">htb-pikaboo</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#off-by-slash " class="post-tag">off-by-slash</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#log-poisoning " class="post-tag">log-poisoning</a> <a href="/tags#perl-diamond-injection " class="post-tag">perl-diamond-injection</a> <a href="/tags#perl " class="post-tag">perl</a> <a href="/tags#open-injection " class="post-tag">open-injection</a> <a href="/tags#open-injection-perl " class="post-tag">open-injection-perl</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#htb-seal " class="post-tag">htb-seal</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/pikaboo-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/pikaboo-cover.png" alt="Pikaboo" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Pikaboo required a lot of enumeration and putting together different pieces to get through each step. I’ll only ever get a shell as www-data and root, but for each step there’s several pieces to pull together and combine to some effect. I’ll start by abusing an off-by-slash vulnerability in the interaction between NGINX and Apache to get access to a staging server. In there, I’ll use an LFI to include FTP logs, which I can poison with PHP to get execution. As www-data, I’ll find a cron running a Perl script as root, which is vulnerable to command injection via the diamond operator. I’ll find creds for another user in LDAP and get access to FTP, where I can drop a file that will be read and give execution to get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 27, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/11/27/htb-intelligence.html">
                HTB: Intelligence
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-intelligence " class="post-tag">htb-intelligence</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#dnsenum " class="post-tag">dnsenum</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#kerbrute " class="post-tag">kerbrute</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#password-spray " class="post-tag">password-spray</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#bloodhound-py " class="post-tag">bloodhound-py</a> <a href="/tags#dnstool " class="post-tag">dnstool</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#readgmsapassword " class="post-tag">readgmsapassword</a> <a href="/tags#gmsa " class="post-tag">gmsa</a> <a href="/tags#gmsadumper " class="post-tag">gmsadumper</a> <a href="/tags#silver-ticket " class="post-tag">silver-ticket</a> <a href="/tags#wmiexec " class="post-tag">wmiexec</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/intelligence-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/intelligence-cover.png" alt="Intelligence" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Intelligence was a great box for Windows and Active Directory enumeration and exploitation. I’ll start with a lot of enumeration against a domain controller. Eventually I’ll brute force a naming pattern to pull down PDFs from the website, finding the default password for new user accounts. Spraying that across all the users I enumerated returns one that works. From there, I’ll find a PowerShell script that runs every five minutes on Intelligence that is making a web request to each DNS in the AD environment that starts with web. I’ll add myself as a server, and use responder to capture a hash when it next runs. On cracking that hash, I’ll have a new user, and bloodhound shows that account has control over a service accounts GMSA password. That service account has delegation on the domain. I’ll exploit those relationships to get administrator on the box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 22, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/11/22/htb-union.html">
                HTB: Union
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-union " class="post-tag">htb-union</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#sqli-file " class="post-tag">sqli-file</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#iptables " class="post-tag">iptables</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/union-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/union-cover.png" alt="Union" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The November Ultimate Hacking Championship qualifier box is Union. There’s a tricky-to-find union SQL injection that will allow for file reads, which leaks the users on the box as well as the password for the database. Those combine to get SSH access. Once on the box, I’ll notice that www-data is modifying the firewall, which is a privileged action, using sudo. Analysis of the page source shows it is command injectable via the X-Forwarded-For header, which provides a shell as www-data. This account has full sudo rights, providing root access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 20, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/11/20/htb-bountyhunter.html">
                HTB: BountyHunter
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-bountyhunter " class="post-tag">htb-bountyhunter</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#decoder " class="post-tag">decoder</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#python-eval " class="post-tag">python-eval</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bountyhunter-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bountyhunter-cover.png" alt="BountyHunter" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>BountyHunter has a really nice simple XXE vulnerability in a webpage that provides access to files on the host. With that, I can get the users on the system, as well as a password in a PHP script, and use that to get SSH access to the host. To privesc, there’s a ticket validation script that runs as root that is vulnerable to Python eval injection.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 18, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/11/18/runcode-live-2021-solutions.html">
                RunCode Live 2021 Solutions
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#runcode " class="post-tag">runcode</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/runcode.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/runcode.png" alt="runcode" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>I’ve been posting solutions on YouTube for the RunCode Live 2021 competition held 11-13 November 2021. This a a programming CTF, so I’ll show how I approach various problems using mostly Python. Check them out, and subscribe on YouTube to get notified as I add more videos.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 13, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/11/13/htb-seal.html">
                HTB: Seal
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-seal " class="post-tag">htb-seal</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#nginx " class="post-tag">nginx</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#git-bucket " class="post-tag">git-bucket</a> <a href="/tags#off-by-slash " class="post-tag">off-by-slash</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#mutual-authentication " class="post-tag">mutual-authentication</a> <a href="/tags#uri-parsing " class="post-tag">uri-parsing</a> <a href="/tags#war " class="post-tag">war</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#ansible " class="post-tag">ansible</a> <a href="/tags#htb-tabby " class="post-tag">htb-tabby</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/seal-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/seal-cover.png" alt="Seal" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>In Seal, I’ll get access to the NGINX and Tomcat configs, and find both Tomcat passwords and a misconfiguration that allows me to bypass the certificate-based authentication by abusing differences in how NGINX and Tomcat parse urls. The rest of the box is about Ansible, the automation platform. I’ll abuse a backup playbook being run on a cron to get the next user. And I’ll write my own playbook and abuse sudo to get root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 8, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/11/08/htb-pivotapi-more.html">
                HTB: Three More PivotAPI Unintendeds
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-pivotapi " class="post-tag">htb-pivotapi</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#mssql-shell " class="post-tag">mssql-shell</a> <a href="/tags#seimpersonate " class="post-tag">seimpersonate</a> <a href="/tags#efspotato " class="post-tag">efspotato</a> <a href="/tags#sebackupvolume " class="post-tag">sebackupvolume</a> <a href="/tags#ntfscontrolfile " class="post-tag">ntfscontrolfile</a> <a href="/tags#dcsync " class="post-tag">dcsync</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#rubeus " class="post-tag">rubeus</a> <a href="/tags#sharp-collection " class="post-tag">sharp-collection</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#ticketconverter " class="post-tag">ticketconverter</a> <a href="/tags#ntpdate " class="post-tag">ntpdate</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#wmiexec " class="post-tag">wmiexec</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/pivotapi-more-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/pivotapi-more-cover.png" alt="PivotAPI" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>There were three other techniques that were used as shortcuts on PivotAPI that I thought were worth sharing but that I didn’t have time to get into my original post. xct tipped me off to exploiting Sempersonate using EfsPotato (even after the print spooler was disabled), as well as abusing SeManageVolume to get full read/write as admin. TheCyberGeek and IppSec both showed how to abuse delegation to do a DCSync attack.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 6, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/11/06/htb-pivotapi.html">
                HTB: PivotAPI
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-pivotapi " class="post-tag">htb-pivotapi</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#exiftool " class="post-tag">exiftool</a> <a href="/tags#as-rep-roast " class="post-tag">as-rep-roast</a> <a href="/tags#getuserspns " class="post-tag">getuserspns</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#mssqlclient " class="post-tag">mssqlclient</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#mbox " class="post-tag">mbox</a> <a href="/tags#mutt " class="post-tag">mutt</a> <a href="/tags#msgconvert " class="post-tag">msgconvert</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#procmon " class="post-tag">procmon</a> <a href="/tags#vbs " class="post-tag">vbs</a> <a href="/tags#api-monitor " class="post-tag">api-monitor</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#mssql-shell " class="post-tag">mssql-shell</a> <a href="/tags#mssqlproxy " class="post-tag">mssqlproxy</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#keepass " class="post-tag">keepass</a> <a href="/tags#genericall " class="post-tag">genericall</a> <a href="/tags#powersploit " class="post-tag">powersploit</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#forcechangepassword " class="post-tag">forcechangepassword</a> <a href="/tags#laps " class="post-tag">laps</a> <a href="/tags#winpeas " class="post-tag">winpeas</a> <a href="/tags#powershell-run-as " class="post-tag">powershell-run-as</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#seimpersonate " class="post-tag">seimpersonate</a> <a href="/tags#printspoofer " class="post-tag">printspoofer</a> <a href="/tags#htb-safe " class="post-tag">htb-safe</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/pivotapi-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/pivotapi-cover.png" alt="PivotAPI" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>PivotAPI had so many steps. It starts and ends with Active Directory attacks, first finding a username in a PDF metadata and using that to AS-REP Roast. This user has access to some binaries related to managing a database. I’ll reverse them mostly with dynamic analysis to find the password through several layers of obfuscation, eventually gaining access to the MSSQL service. From there, I’ll use mssqlproxy to tunnel WinRM through the DB, where I find a KeePass DB. Those creds give SSH access, where I’ll then pivot through some vulnerable privileges to get access to a developers share. In there, another binary that I can use to fetch additional creds. Finally, after another pivot through misconfigured privileges, I’ll get access to the LAPS password for the administrator. In Beyond Root, I’ll show some unintended paths.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 3, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/petthekitty">
                Flare-On 2021: PetTheKitty
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-petthekitty " class="post-tag">flare-on-petthekitty</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#delta-patch " class="post-tag">delta-patch</a> <a href="/tags#dll " class="post-tag">dll</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#scapy " class="post-tag">scapy</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-petthekitty-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-petthekitty-cover.png" alt="petthekitty" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>PetTheKitty started with a PCAP with two streams. The first was used to download and run a DLL malware, and the second was the C2 communications of that malware. The malware and the initial downloader user Windows Delta patches to exchange information. I’ll reverse the binary to understand the algorithm and decode the reverse shell session to find the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 2, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/11/02/htb-nunchucks.html">
                HTB: Nunchucks
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-nunchucks " class="post-tag">htb-nunchucks</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#express-nunchucks " class="post-tag">express-nunchucks</a> <a href="/tags#capabilities " class="post-tag">capabilities</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#apparmor " class="post-tag">apparmor</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/nunchucks-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/nunchucks-cover.png" alt="Nunchucks" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>October’s UHC qualifying box, Nunchucks, starts with a template injection vulnerability in an Express JavaScript application. There are a lot of templating engines that Express can use, but this one is using Nunchucks. After getting a shell, there’s what looks like a simple GTFObins privesc, as the Perl binary has the setuid capability. However, AppArmor is blocking the simple exploitation, and will need to be bypassed to get a root shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 1, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/known">
                Flare-On 2021: known
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-known " class="post-tag">flare-on-known</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-known-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-known-cover.png" alt="known" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>known presented a ransomware file decrypter, as well as a handful of encrypted files. If I can figure out the key to give the decrypter, it will decrypt the files, one of which contains the flag. I’ll use Ghidra to determine the algorithm, then recreate it in Python, and brute force all possible keys to find the right one.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 30, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/10/30/htb-explore.html">
                HTB: Explore
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-explore " class="post-tag">htb-explore</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#android " class="post-tag">android</a> <a href="/tags#adb " class="post-tag">adb</a> <a href="/tags#es-file-explorer " class="post-tag">es-file-explorer</a> <a href="/tags#cve-2019-6447 " class="post-tag">cve-2019-6447</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/explore-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/explore-cover.png" alt="Explore" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Explore is the first Android box on HTB. There’s a relatively simple file read vulnerability in ES File Explorer that allows me to read images off the phone, including one with a password in it. With that password I’ll SSH into the phone, and access the Android debug (adb) service, where I can easily get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 29, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/myaquaticlife">
                Flare-On 2021: myaquaticlife
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-myaquaticlife " class="post-tag">flare-on-myaquaticlife</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#upx " class="post-tag">upx</a> <a href="/tags#multimedia-builder " class="post-tag">multimedia-builder</a> <a href="/tags#mmunbuilder " class="post-tag">mmunbuilder</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#brute-force " class="post-tag">brute-force</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-myaquaticlife-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-myaquaticlife-cover.png" alt="myaquaticlife" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>myaquaticlife was a Windows exe built on a really old multimedia framework, Multimedia Builder. I’ll use a project on Github to decompile it back to the framework file, and look at it in the original software. There’s a DLL used as a plugin that tracks the order of clicks on fish, and I can figure out the order to click and get the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 28, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/beelogin">
                Flare-On 2021: beelogin
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-beelogin " class="post-tag">flare-on-beelogin</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#jsfuck " class="post-tag">jsfuck</a> <a href="/tags#de4js " class="post-tag">de4js</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#deobfuscation " class="post-tag">deobfuscation</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-beelogin-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-beelogin-cover.png" alt="beelogin" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>beelogin starts with a simple HTML page with five input fields. Diving into the source, there’s almost sixty thousand lines of JavaScript. The vast majority of that ends up being junk that isn’t run. I’ll trim it down to around 30 lines. Then there’s some math to track where each of 64 bytes in the key impact which bytes of the result. Once I have that, I can check for bytes that produce valid JavaScript, and find the key. The result is some obfuscated JavaScript that comes out to be doing the same thing again, on the second half of the key. Once I have both halves, I can get the flag or put the key in and get the page to give it to me.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 27, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/flarelinuxvm">
                Flare-On 2021: flarelinuxvm
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-flarelinuxvm " class="post-tag">flare-on-flarelinuxvm</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#vm " class="post-tag">vm</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#encoding " class="post-tag">encoding</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#ransomware " class="post-tag">ransomware</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-flarelinuxvm-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-flarelinuxvm-cover.png" alt="flarelinuxvm" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Flare Linux VM starts with a VM and some ransomware encrypted files. I’ll have to triage, find the malware, and reverse it to understand that it’s using a static key stream to encrypted the files. With that stream, I can decrypt and get the files, which provide a series of CTF puzzles to get a password which I can give to the binary and get the final flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 26, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/10/26/htb-spooktrol.html">
                HTB: Spooktrol
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-spooktrol " class="post-tag">htb-spooktrol</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#fastapi " class="post-tag">fastapi</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-proxy " class="post-tag">burp-proxy</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#uhc " class="post-tag">uhc</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/spooktrol-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/spooktrol-cover.png" alt="Spooktrol" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>spooktrol is another UHC championship box created by IppSec. It’s all about attacking a malware C2 server, which have a long history of including silly bugs in them. In this one, I’ll hijack the tasking message and have it upload a file, which, using a directory traversal bug, allows me to write to root’s authorized keys file on the container. Then, I’ll exploit the C2’s database to write a task to another agent and get a shell on that box. In Beyond Root, I’ll look at an unintended directory traversal vulnerability in the implant download.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 25, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/spel">
                Flare-On 2021: spel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-spel " class="post-tag">flare-on-spel</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#unpack " class="post-tag">unpack</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> <a href="/tags#dll " class="post-tag">dll</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#anti-debug " class="post-tag">anti-debug</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-spel-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-spel-cover.png" alt="spel" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>spel was a Russian nesting doll of binaries. It starts with a giant function that has thousands move instructions setting a single byte at a time into a buffer and then calling it. That buffer is shellcode that loads and calls a DLL. That DLL loads and calls a function from a second DLL. In that DLL, there are a series of checks that cause the program to exit (different file name, network connection), before the flag bytes are eventually decoded from a PNG resource in the original binary, and then scrambled into an order only observable in debug.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 24, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/antioch">
                Flare-On 2021: antioch
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-antioch " class="post-tag">flare-on-antioch</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#docker-tar " class="post-tag">docker-tar</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-antioch-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-antioch-cover.png" alt="antioch" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>antioch was a challenge based on the old movie, Monty Python and the Holy Grail. I’m given a Tar archive, which is a Docker image, the output of a command like <code class="language-plaintext highlighter-rouge">docker save</code>. It has a lot of layer data, but most the layers are not referenced in the manifest. The image does have a single ELF executable in it. Though reversing this binary, I’ll see how it expects input matching the various authors from the metadata in the unused layers, and how each author has an id associated with it. I’ll use the order of those IDs to reconstruct the Docker image to include the files in the right order, and then the new image will give the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 23, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/10/23/htb-spider.html">
                HTB: Spider
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-spider " class="post-tag">htb-spider</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask-cookie " class="post-tag">flask-cookie</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#jinja2 " class="post-tag">jinja2</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#sqlmap-eval " class="post-tag">sqlmap-eval</a> <a href="/tags#ssti-blind " class="post-tag">ssti-blind</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#xxe " class="post-tag">xxe</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/spider-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/spider-cover.png" alt="Spider" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Spider was all about classic attacks in unusual places. There’s a limited SSTI in a username that allows me to leak a Flask secret. I’ll use that to generate Flask cookies with SQL injection payloads inside to leak a user id, and gain admin access on the site. From there, another SSTI, but this time blind, to get RCE and a shell. For root, there’s a XXE in a cookie that allows me to leak the final flag as well as the root ssh key.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 22, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/wizardcult">
                Flare-On 2021: wizardcult
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-wizardcult " class="post-tag">flare-on-wizardcult</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#go " class="post-tag">go</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#irc " class="post-tag">irc</a> <a href="/tags#inspircd " class="post-tag">inspircd</a> <a href="/tags#c2 " class="post-tag">c2</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-wizardcult-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-wizardcult-cover.png" alt="wizardcult" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The last challenge in Flare-On 8 was probably not harder than the ninth one, but it might have been the one I had the most fun attacking. In a mad rush to finish on time, I didn’t take great notes, so instead, I went back and solved it start to finish on YouTube.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 22, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2021/credchecker">
                Flare-On 2021: credchecker
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-credchecker " class="post-tag">flare-on-credchecker</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#html " class="post-tag">html</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2021-credchecker-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2021-credchecker-cover.png" alt="credchecker" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Flare-On 8 got off to an easy start with an HTML page and a login form. The page has JavaScript to accept and check the password, and I’ll show two ways to get the flag - pulling the password and then logging in, and decrypting the flag buffer.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 16, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/10/16/htb-dynstr.html">
                HTB: Dynstr
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-dynstr " class="post-tag">htb-dynstr</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#dynamic-dns " class="post-tag">dynamic-dns</a> <a href="/tags#no-ip " class="post-tag">no-ip</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#dnsenum " class="post-tag">dnsenum</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#scriptreplay " class="post-tag">scriptreplay</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#nsupdate " class="post-tag">nsupdate</a> <a href="/tags#authorized-keys " class="post-tag">authorized-keys</a> <a href="/tags#wildcard " class="post-tag">wildcard</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#passwd " class="post-tag">passwd</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/dynstr-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/dynstr-cover.png" alt="Dynstr" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Dynstr was a super neat concept based around a dynamic DNS provider. To start, I’ll find command injection in the DNS / IP update API. Then I’ll find a private key in a script replay of a debugging session and strace logs. I’ll also need to tinker with the DNS resolutions to allow myself to connect over SSH, as the authorized_keys file has restrictions in it. For root, there’s a simple wildcard injection into a script I can run as root, and I’ll show two ways to exploit that. In Beyond Root, a break down of the DNS API, and a look at an unintended flag leak and a dive into Bash variables and number comparisons.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 9, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/10/09/htb-monitors.html">
                HTB: Monitors
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-monitors " class="post-tag">htb-monitors</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#wp-with-spritz " class="post-tag">wp-with-spritz</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#exploitdb " class="post-tag">exploitdb</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#apache-config " class="post-tag">apache-config</a> <a href="/tags#cacti " class="post-tag">cacti</a> <a href="/tags#cve-2020-14295 " class="post-tag">cve-2020-14295</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#systemd " class="post-tag">systemd</a> <a href="/tags#crontab " class="post-tag">crontab</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#solr " class="post-tag">solr</a> <a href="/tags#cve-2020-9496 " class="post-tag">cve-2020-9496</a> <a href="/tags#ysoserial " class="post-tag">ysoserial</a> <a href="/tags#docker-escape " class="post-tag">docker-escape</a> <a href="/tags#kernel-module " class="post-tag">kernel-module</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/monitors-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/monitors-cover.png" alt="Monitors" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Monitors starts off with a WordPress blog that is vulnerable to a local file include vulnerability that allows me to read files from system. In doing so, I’ll discover another virtual host serving a vulnerable version of Cacti, which I’ll exploit via SQL injection that leads to code execution. From there, I’ll identify a new service in development running Apache Solr in a Docker container, and exploit that to get into the container. The container is running privilieged, which I’ll abuse by installing a malicious kernel module to get access as root on the host.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 2, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/10/02/htb-cap.html">
                HTB: Cap
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-cap " class="post-tag">htb-cap</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#pcap " class="post-tag">pcap</a> <a href="/tags#idor " class="post-tag">idor</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#capabilities " class="post-tag">capabilities</a> <a href="/tags#linpeas " class="post-tag">linpeas</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/cap-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/cap-cover.png" alt="Cap" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Cap provided a chance to exploit two simple yet interesting capabilities. First, there’s a website with an insecure direct object reference (IDOR) vulnerability, where the site will collect a PCAP for me, but I can also access other user’s PCAPs, to include one from the user of the box with their FTP credentials, which also provides SSH access as that user. With a shell, I’ll find that in order for the site to collect pcaps, it needs some privileges, which are provided via Linux capabilities, including one that I’ll abuse to get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 27, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/09/27/htb-jarmis.html">
                HTB: Jarmis
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-jarmis " class="post-tag">htb-jarmis</a> <a href="/tags#ja3 " class="post-tag">ja3</a> <a href="/tags#ja3s " class="post-tag">ja3s</a> <a href="/tags#jarm " class="post-tag">jarm</a> <a href="/tags#tls " class="post-tag">tls</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#ncat " class="post-tag">ncat</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#fastapi " class="post-tag">fastapi</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#jq " class="post-tag">jq</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#msf-custom-module " class="post-tag">msf-custom-module</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#omigod " class="post-tag">omigod</a> <a href="/tags#cve-2021-38647 " class="post-tag">cve-2021-38647</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#gopher " class="post-tag">gopher</a> <a href="/tags#code-review " class="post-tag">code-review</a> <a href="/tags#htb-laser " class="post-tag">htb-laser</a> <a href="/tags#htb-travel " class="post-tag">htb-travel</a> <a href="/tags#uhc " class="post-tag">uhc</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/jarmis-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/jarmis-cover.png" alt="Jarmis" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>My favorite part about Jarmis was that it is centered around this really neat technology used to fingerprint and      identify TLS servers. There’s an application that will scan a given server and report back the Jarm signature, and if that signature matches something potentially malicious in the database, it will do a GET request to that server to    collect additional metadata. I’ll abuse that service to get a list of open ports on localhost and find 5985/5986, which are typically WinRM. Given that Jarmis is a Linux host, it’s odd, and it turns out that this is the same port   that OMI listens to, and the host is vulnerable to OMIGod. To exploit this, I’ll find a POC and convert it into a     Gopher redirect by redirecting the GET request. I’ll need to create a malicious server as well, and I’ll show two ways, using IPTables and a custom Metasploit module. In Beyond Root, I’ll look at the webserver config, and find the  error in the public Jarm code that allowed me to use Jarm as a port scanner.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 25, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/09/25/htb-pit.html">
                HTB: Pit
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-pit " class="post-tag">htb-pit</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#centos " class="post-tag">centos</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#udp " class="post-tag">udp</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#seeddms " class="post-tag">seeddms</a> <a href="/tags#cve-2019-12744 " class="post-tag">cve-2019-12744</a> <a href="/tags#exploitdb " class="post-tag">exploitdb</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#selinux " class="post-tag">selinux</a> <a href="/tags#cockpit " class="post-tag">cockpit</a> <a href="/tags#htb-sneaky " class="post-tag">htb-sneaky</a> <a href="/tags#getfacl " class="post-tag">getfacl</a> <a href="/tags#facl " class="post-tag">facl</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/pit-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/pit-cover.png" alt="Pit" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Pit used SNMP in two different ways. First, I’ll enumerate it to leak the location of a webserver running SeedDMS, where I’ll abuse a webshell upload vulnerability to get RCE on the host. I’m not able to get a reverse shell because of SeLinux, but I can enumerate enough to find a password for michelle, and use that to get access to a Cockpit instance which offers a terminal. From there, I’ll find that I can write scripts that will be run by SNMP, and I’ll use that to get execution and a shell as root. In Beyond Root, a look at SeLinux and how it blocked things I tried to do on Pit.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 18, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/09/18/htb-sink.html">
                HTB: Sink
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-sink " class="post-tag">htb-sink</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gitea " class="post-tag">gitea</a> <a href="/tags#haproxy " class="post-tag">haproxy</a> <a href="/tags#gunicorn " class="post-tag">gunicorn</a> <a href="/tags#request-smuggling " class="post-tag">request-smuggling</a> <a href="/tags#localstack " class="post-tag">localstack</a> <a href="/tags#aws " class="post-tag">aws</a> <a href="/tags#aws-secretsmanager " class="post-tag">aws-secretsmanager</a> <a href="/tags#aws-kms " class="post-tag">aws-kms</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#htb-bucket " class="post-tag">htb-bucket</a> <a href="/tags#htb-gobox " class="post-tag">htb-gobox</a> <a href="/tags#git " class="post-tag">git</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sink-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sink-cover.png" alt="Sink" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Sink was an amazing box touching on two major exploitation concepts. First is the request smuggling attack, where I send a malformed packet that tricks the front-end server and back-end server interactions such that the next user’s request is handled as a continuation of my request. After that, I’ll find a AWS instance (localstack) and exploit various services in that, including secrets manager and the key management. In Beyond Root, I’ll look at the way this box was configured to allow for multiple users to do request smuggling at the same time.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 14, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/09/14/htb-validation.html">
                HTB: Validation
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-validation " class="post-tag">htb-validation</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#cookies " class="post-tag">cookies</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#second-order-sqli " class="post-tag">second-order-sqli</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#sqli-file " class="post-tag">sqli-file</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/validation-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/validation-cover.png" alt="Validation" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Validation is another box HTB made for the UHC competition. It is a qualifier box, meant to be easy and help select the top ten to compete later this month. Once it was done on UHC, HTB makes it available. In this box, I’ll exploit a second-order SQL injection, write a script to automate the enumeration, and identify the SQL user has FILE permissions. I’ll use that to write a webshell, and get execution. For root, it’s simple password reuse from the database. In Beyond Root, I’ll look at how this box started and ended in a container.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 11, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/09/11/htb-schooled.html">
                HTB: Schooled
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-schooled " class="post-tag">htb-schooled</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#moodle " class="post-tag">moodle</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#cve-2020-25627 " class="post-tag">cve-2020-25627</a> <a href="/tags#cve-2020-14321 " class="post-tag">cve-2020-14321</a> <a href="/tags#moodle-plugin " class="post-tag">moodle-plugin</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#pkg " class="post-tag">pkg</a> <a href="/tags#freebsd " class="post-tag">freebsd</a> <a href="/tags#package " class="post-tag">package</a> <a href="/tags#htb-teacher " class="post-tag">htb-teacher</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/schooled-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/schooled-cover.png" alt="Schooled" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Schooled starts with a string of exploits to gain more and more privilege in a Moodle instance, eventually leading to a malicious plugin upload that provides a webshell. I’ll pull some hashes from the DB and crack them to get to the next user. This user can run the FreeBSD package manager, pkg, as root, and can also write to the hosts file. I’ll trick it into connecting to my VM, and give it a malicious package that provide root. In Beyond Root, I’ll look at the Moodle plugin a bit more in depth.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 4, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/09/04/htb-unobtainium.html">
                HTB: Unobtainium
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-unobtainium " class="post-tag">htb-unobtainium</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#kubernetes " class="post-tag">kubernetes</a> <a href="/tags#deb " class="post-tag">deb</a> <a href="/tags#package " class="post-tag">package</a> <a href="/tags#electron " class="post-tag">electron</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#prototype-pollution " class="post-tag">prototype-pollution</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#asar " class="post-tag">asar</a> <a href="/tags#sans-holiday-hack " class="post-tag">sans-holiday-hack</a> <a href="/tags#htb-onetwoseven " class="post-tag">htb-onetwoseven</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#kubectl " class="post-tag">kubectl</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/unobtainium-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/unobtainium-cover.png" alt="Unobtainium" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Unobtainium was the first box on HackTheBox to play with Kubernetes, a technology for deploying and managing containers. It also has a Electron application to reverse, which allows for multiple exploits against the server, first local file include, then prototype pollution, and finally command injection. With a shell, I’ll find a way to gain admin access over Kubernetes and get root with a malicious container.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 30, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/08/30/htb-gobox.html">
                HTB: Gobox
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-gobox " class="post-tag">htb-gobox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#uhc " class="post-tag">uhc</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#go " class="post-tag">go</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#aws " class="post-tag">aws</a> <a href="/tags#awscli " class="post-tag">awscli</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#s3 " class="post-tag">s3</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#nginx-module " class="post-tag">nginx-module</a> <a href="/tags#backdoor " class="post-tag">backdoor</a> <a href="/tags#nginxexecute " class="post-tag">nginxexecute</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/gobox-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/gobox-cover.png" alt="Gobox" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>HackTheBox made Gobox to be used in the Hacking Esports UHC competition on Aug 29, 2021. Once the competition is over, HTB put it out for all of us to play. This is neat box, created by IppSec, where I’ll exploit a server-side template injection vulnerability in a Golang webserver to leak creds to the site, and then the full source. I’ll use the source with the SSTI to get execution, but no shell. I’ll write a script to make enumeration easy, and then identify the host is in AWS, and is managing a bucket the hosts another site. I’ll upload a PHP webshell to get a shell on the main host. Finally, I’ll find a backdoor NGINX module which is enabled, reverse it to get execution, and get a shell as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 28, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/08/28/htb-knife.html">
                HTB: Knife
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-knife " class="post-tag">htb-knife</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php-backdoor " class="post-tag">php-backdoor</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#php-8-1-0-dev " class="post-tag">php-8.1.0-dev</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#knife " class="post-tag">knife</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#vim " class="post-tag">vim</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/knife-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/knife-cover.png" alt="Knife" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Knife is one of the easier boxes on HTB, but it’s also one that has gotten significantly easier since it’s release. I’ll start with a webserver that isn’t hosting much of a site, but is leaking that it’s running a dev version of PHP. This version happens to be the version that had a backdoor inserted into it when the PHP development servers were hacked in March 2021. At the time of release, just searching for this version string didn’t immediately lead to the backdoor, but within two days of release it did. For root, the user can run knife as root. At the time of release, there was no GTFObins page for knife, so the challenge required reading the docs to find a way to run arbitrary code. That page now exists.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 27, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/08/27/pivoting-off-phishing-domain.html">
                Pivoting off Phishing Domain
              </a>
            </h3>

<span class="tag-list"><a href="/tags#forensics " class="post-tag">forensics</a> <a href="/tags#threat-intel " class="post-tag">threat-intel</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#riskiq " class="post-tag">riskiq</a> <a href="/tags#maltego " class="post-tag">maltego</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/image-20210827040428323.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/image-20210827040428323.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>John Hammond YouTube channel is full of neat stuff, from CTF solutions to real malware analysis. Recently, he did an analysis of an email with an HTML attachment which presented as a fake Microsoft login page. When a victim enters creds, the page would send them to www.hurleyauctions[.]us, and redirect the user to an actual Microsoft Outlook site. John looked at bit at the registration information on the domain, but I wanted to dive a bit deeper, specifically using RiskIQ and Maltego.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 21, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/08/21/htb-proper.html">
                HTB: Proper
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-proper " class="post-tag">htb-proper</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#ajax " class="post-tag">ajax</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#keyed-hash " class="post-tag">keyed-hash</a> <a href="/tags#sqli-orderby " class="post-tag">sqli-orderby</a> <a href="/tags#sqlmap-eval " class="post-tag">sqlmap-eval</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#rfi " class="post-tag">rfi</a> <a href="/tags#time-of-check-time-of-use " class="post-tag">time-of-check-time-of-use</a> <a href="/tags#inotifywait " class="post-tag">inotifywait</a> <a href="/tags#go " class="post-tag">go</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#arbitrary-read " class="post-tag">arbitrary-read</a> <a href="/tags#wertrigger " class="post-tag">wertrigger</a> <a href="/tags#pipe-monitor " class="post-tag">pipe-monitor</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#named-pipe " class="post-tag">named-pipe</a> <a href="/tags#cve-2021-1732 " class="post-tag">cve-2021-1732</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> <a href="/tags#htb-scriptkiddie " class="post-tag">htb-scriptkiddie</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/proper-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/proper-cover.png" alt="Proper" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Proper was a fascinating Windows box with three fascinating stages. First, there’s a SQL injection, but the url parameters are hashed with a key, so I need to leak that key, and then make sure to update the hash for each request. I get to play with the eval option for SQLmap, as well as show some manual scripting to do it. Next, there’s a time of check / time of use vulnerability in a file include that allows me to do a remote file include over SMB, swapping out the contents between the first and second read to get code execution. For root, there’s a Go binary that does cleanup of files in the users Downloads folder that I can abuse to get arbitrary write as SYSTEM. I’ll abuse this with the windows error reporting system to get execution. In Beyond Root, I’ll look at a couple more ways to get root using this binary.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 14, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/08/14/htb-crossfittwo.html">
                HTB: CrossFitTwo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-crossfittwo " class="post-tag">htb-crossfittwo</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#openbsd " class="post-tag">openbsd</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#websocket " class="post-tag">websocket</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#unbound " class="post-tag">unbound</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#relayd " class="post-tag">relayd</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#cors " class="post-tag">cors</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#socket-io " class="post-tag">socket-io</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#node-modules " class="post-tag">node-modules</a> <a href="/tags#yubikey " class="post-tag">yubikey</a> <a href="/tags#changelist " class="post-tag">changelist</a> <a href="/tags#ykgenerate " class="post-tag">ykgenerate</a> <a href="/tags#htb-crossfit " class="post-tag">htb-crossfit</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/crossfittwo-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/crossfittwo-cover.png" alt="CrossFitTwo" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Much like CrossFit, CrossFitTwo was just a monster of a box. The centerpiece is a crazy cross-site scripting attack through a password reset interface using DNS to redirect the admin to a site I control to then have them register an account for me. I’ll then hijack some socket.io messages to get access to chats where I’ll capture a password to get a shell. On the box, I’ll abuse NodeJS’s module load order, then extract the root ssh key from a changelist backup and the yubikey seed needed to get SSH as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 7, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/08/07/htb-love.html">
                HTB: Love
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-love " class="post-tag">htb-love</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#voting-system " class="post-tag">voting-system</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#winpeas " class="post-tag">winpeas</a> <a href="/tags#alwaysinstallelevated " class="post-tag">alwaysinstallelevated</a> <a href="/tags#msi " class="post-tag">msi</a> <a href="/tags#htb-ethereal " class="post-tag">htb-ethereal</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/love-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/love-cover.png" alt="Love" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Love was a solid easy-difficulty Windows box, with three stages. First, I’ll use a simple SSRF to get access to a webpage that is only allowed to be viewed from localhost that leaks credentials for a Voting System instance. Then, I’ll exploit an upload vulnerability in Voting System to get RCE, showing both using the searchsploit script and manual exploitation. Finally, I’ll abuse the AlwaysInstallElevated setting to get a system shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 31, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/07/31/htb-thenotebook.html">
                HTB: TheNotebook
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-thenotebook " class="post-tag">htb-thenotebook</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#jwt-io " class="post-tag">jwt-io</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#cve-2019-5736 " class="post-tag">cve-2019-5736</a> <a href="/tags#runc " class="post-tag">runc</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#go " class="post-tag">go</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/thenotebook-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/thenotebook-cover.png" alt="TheNotebook" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>TheNotebook starts off with a website where I’ll abuse a JWT misconfiguration to convince the server to validate my token using a key hosted on my server. From there, I’ll get access to a site where I can upload a PHP webshell and get execution. After finding an SSH key in a backup, I’ll exploit a vulnerability in runc, the executable that underlies Docker to get execution as the root user in the host.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 24, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/07/24/htb-armageddon.html">
                HTB: Armageddon
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-armageddon " class="post-tag">htb-armageddon</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#drupal " class="post-tag">drupal</a> <a href="/tags#drupalgeddon2 " class="post-tag">drupalgeddon2</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#snap " class="post-tag">snap</a> <a href="/tags#snapcraft " class="post-tag">snapcraft</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/armageddon-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/armageddon-cover.png" alt="Armageddon" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Argageddon was a box targeted at beginners. The foothold exploit, Drupalgeddon2 has many public exploit scripts that can be used to upload a webshell and run commands. I’ll get access to the database and get the admin’s hash, crack it, and find that password is reused on the host as well. To get root, I’ll abuse the admin’s ability to install snap packages as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 17, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/07/17/htb-breadcrumbs.html">
                HTB: Breadcrumbs
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-breadcrumbs " class="post-tag">htb-breadcrumbs</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#cookies " class="post-tag">cookies</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#defender " class="post-tag">defender</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#stickynotes " class="post-tag">stickynotes</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#aes " class="post-tag">aes</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#htb-buff " class="post-tag">htb-buff</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/breadcrumbs-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/breadcrumbs-cover.png" alt="Breadcrumbs" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Breadcrumbs starts with a fair amount of web enumeration and working to get little bits of additional access. First I’ll leak the page source with a directory traversal vulnerability, and use that to get the algorithms necessary to forge both a session cookie and a JWT token. With both of those cookies, I gain administrator access to the site, and can upload a webshell after bypassing some filtering and Windows Defender. I’ll find the next user’s data in the website files. I’ll find another password in Sticky Notes data, and use that to get access to a new password manager under development. To get to administrator, I’ll exploit a SQL injection in the password manager to get the encrypted password and the key material to decrypt it, providing the admin password.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 10, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/07/10/htb-atom.html">
                HTB: Atom
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-atom " class="post-tag">htb-atom</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#xampp " class="post-tag">xampp</a> <a href="/tags#redis " class="post-tag">redis</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#portable-kanban " class="post-tag">portable-kanban</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#asar " class="post-tag">asar</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#electron " class="post-tag">electron</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#printnightmare " class="post-tag">printnightmare</a> <a href="/tags#invoke-nightmare " class="post-tag">invoke-nightmare</a> <a href="/tags#cve-2021-34527 " class="post-tag">cve-2021-34527</a> <a href="/tags#htb-sharp " class="post-tag">htb-sharp</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/atom-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/atom-cover.png" alt="Atom" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Atom was a box that involved insecure permissions on an update server, which allowed me to write a malicious payload to that server and get execution when an Electron App tried to update from my host. I’ll reverse the electron app to understand the tech, and exploit it to get a shell. For root, I’ll have to exploit a Portable-Kanban instance which is using Redis to find a password. In Beyond Root, a quick visit back to PrintNightmare.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 8, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/07/08/playing-with-printnightmare.html">
                Playing with PrintNightmare
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-heist " class="post-tag">htb-heist</a> <a href="/tags#cve-2021-1675 " class="post-tag">cve-2021-1675</a> <a href="/tags#cve-2021-34527 " class="post-tag">cve-2021-34527</a> <a href="/tags#printnightmare " class="post-tag">printnightmare</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#invoke-nightmare " class="post-tag">invoke-nightmare</a> <a href="/tags#sharpprintnightmare " class="post-tag">sharpprintnightmare</a> <a href="/tags#dll " class="post-tag">dll</a> <a href="/tags#samba " class="post-tag">samba</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/printnightmare-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/printnightmare-cover.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>CVE-2021-34527, or PrintNightmare, is a vulnerability in the Windows Print Spooler that allows for a low priv user to escalate to administrator on a local box or on a remote server. This is especially bad because it is not uncommon for Domain Controllers to have an exposed print spooler, and thus, this exploit can take an attacker from low-priv user to domain admin. There are a few proof of concept exploits out there, and I wanted to give them a spin an old HackTheBox machine. I’ll also look at disabling the Print Spooler and how it breaks the exploits, and discuss the July 6 patch.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 3, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/07/03/htb-ophiuchi.html">
                HTB: Ophiuchi
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-ophiuchi " class="post-tag">htb-ophiuchi</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#yaml " class="post-tag">yaml</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#jar " class="post-tag">jar</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#marshalsec " class="post-tag">marshalsec</a> <a href="/tags#yaml-payload " class="post-tag">yaml-payload</a> <a href="/tags#wasm " class="post-tag">wasm</a> <a href="/tags#wasm-fiddle " class="post-tag">wasm-fiddle</a> <a href="/tags#webassembly " class="post-tag">webassembly</a> <a href="/tags#htb-ropetwo " class="post-tag">htb-ropetwo</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ophiuchi-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ophiuchi-cover.png" alt="Ophiuchi" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Ophiuchi presented two interesting attacks. First there was a Java YAML deserialization attack that involved generating a JAR payload to inject via a serialized payload. Then there was a somewhat contrived challenge that forced me to generate web assembly (or WASM) code to get execution of a Bash script.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 26, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/06/26/htb-spectra.html">
                HTB: Spectra
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-spectra " class="post-tag">htb-spectra</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#chromeos " class="post-tag">chromeos</a> <a href="/tags#nano " class="post-tag">nano</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#wordpress-plugin " class="post-tag">wordpress-plugin</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#autologon-credentials " class="post-tag">autologon-credentials</a> <a href="/tags#initctl " class="post-tag">initctl</a> <a href="/tags#sudo " class="post-tag">sudo</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/spectra-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/spectra-cover.png" alt="Spectra" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Spectra was the first ChromeOS box on HackTheBox. I’ll start looking at a web server and find a password as well as a WordPress site. The password gets me into the admin panel, where I can edit a plugin or write a new plugin to get execution. From there I’ll find auto-login credentials and use them to get a shell as the next user. That user can control the init daemon with sudo, which I’ll abuse to get root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 19, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/06/19/htb-tentacle.html">
                HTB: Tentacle
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-tentacle " class="post-tag">htb-tentacle</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#dig " class="post-tag">dig</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#dnsenum " class="post-tag">dnsenum</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#kerbrute " class="post-tag">kerbrute</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#ntpdate " class="post-tag">ntpdate</a> <a href="/tags#squid " class="post-tag">squid</a> <a href="/tags#as-rep-roast " class="post-tag">as-rep-roast</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#proxychains " class="post-tag">proxychains</a> <a href="/tags#nmap-over-proxy " class="post-tag">nmap-over-proxy</a> <a href="/tags#wpad " class="post-tag">wpad</a> <a href="/tags#opensmtpd " class="post-tag">opensmtpd</a> <a href="/tags#exploitdb " class="post-tag">exploitdb</a> <a href="/tags#cve-2020-7247 " class="post-tag">cve-2020-7247</a> <a href="/tags#msmtprc " class="post-tag">msmtprc</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#kinit " class="post-tag">kinit</a> <a href="/tags#keytab " class="post-tag">keytab</a> <a href="/tags#klist " class="post-tag">klist</a> <a href="/tags#htb-unbalanced " class="post-tag">htb-unbalanced</a> <a href="/tags#htb-joker " class="post-tag">htb-joker</a> <a href="/tags#getfacl " class="post-tag">getfacl</a> <a href="/tags#facl " class="post-tag">facl</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/tentacle-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/tentacle-cover.png" alt="Tentacle" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Tentacle was a box of two halves. The start is all about a squid proxy, and bouncing through two one them (one of them twice) to access an internal network, where I’ll find a wpad config file that alerts me to another internal network. In that second network, I’ll exploit an OpenSMTPd server and get a foothold. The second half was about abusing Kerberos in a Linux environment. I’ll use creds to get SSH authenticated by Kerberos, then abuse a backup script that give that principle access as another user. That user can access the KeyTab file, which allows them to administer the domain, and provides root access. In Beyond Root, a dive too deep into the rabbit hole of understanding the KeyTab file.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 16, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/06/16/htb-enterprise.html">
                HTB: Enterprise
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-enterprise " class="post-tag">htb-enterprise</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#joomla " class="post-tag">joomla</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#wordpress-plugin " class="post-tag">wordpress-plugin</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#error-based-sqli " class="post-tag">error-based-sqli</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#xinetd " class="post-tag">xinetd</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#ret2libc " class="post-tag">ret2libc</a> <a href="/tags#ltrace " class="post-tag">ltrace</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#pattern " class="post-tag">pattern</a> <a href="/tags#checksec " class="post-tag">checksec</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#peda " class="post-tag">peda</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#htb-frolic " class="post-tag">htb-frolic</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/enterprise-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/enterprise-cover.png" alt="Enterprise" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>To own Enterprise, I’ll have to work through different containers to eventually reach the host system. The WordPress instance has a plugin with available source and a SQL injection vulnerability. I’ll use that to leak creds from a draft post, and get access to the WordPress instance. I can use that to get RCE on that container, but there isn’t much else there. I can also use those passwords to access the admin panel of the Joomla container, where I can then get RCE and a shell. I’ll find a directory mounted into that container that allows me to write a webshell on the host, and get RCE and a shell there. To privesc, I’ll exploit a service with a simple buffer overflow using return to libc. In Beyond Root, I’ll dig more into the Double Query Error-based SQLI.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 12, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/06/12/htb-tenet.html">
                HTB: Tenet
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-tenet " class="post-tag">htb-tenet</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#php-deserialization " class="post-tag">php-deserialization</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#race-condition " class="post-tag">race-condition</a> <a href="/tags#bash " class="post-tag">bash</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/tenet-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/tenet-cover.png" alt="Tenet" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Tenet provided a very straight-forward deserialization attack to get a foothold and a race-condition attack to get root. Both are the kinds of attacks seem more commonly on hard- and insane-rated boxes, but at a medium difficult here.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 8, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/06/08/htb-node.html">
                HTB: Node
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-node " class="post-tag">htb-node</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#express " class="post-tag">express</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#ret2libc " class="post-tag">ret2libc</a> <a href="/tags#mongo " class="post-tag">mongo</a> <a href="/tags#ltrace " class="post-tag">ltrace</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#checksec " class="post-tag">checksec</a> <a href="/tags#aslr " class="post-tag">aslr</a> <a href="/tags#aslr-brute-force " class="post-tag">aslr-brute-force</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#wildcard " class="post-tag">wildcard</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/node-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/node-cover.png" alt="Node" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Node is about enumerating a Express NodeJS application to find an API endpoint that shares too much data., including user password hashes. To root the box, there’s a simple return to libc buffer overflow exploit. I had some fun finding three other ways to get the root flag, as well as one that didn’t work out.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 5, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/06/05/htb-scriptkiddie.html">
                HTB: ScriptKiddie
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-scriptkiddie " class="post-tag">htb-scriptkiddie</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#cve-2020-7384 " class="post-tag">cve-2020-7384</a> <a href="/tags#msfconsole " class="post-tag">msfconsole</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#incron " class="post-tag">incron</a> <a href="/tags#irb " class="post-tag">irb</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/scriptkiddie-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/scriptkiddie-cover.png" alt="ScriptKiddie" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>ScriptKiddie was the third box I wrote that has gone live on the HackTheBox platform. From the time I first heard about the command injection vulnerability in msfvenom, I wanted to make a box themed around a novice hacker and try to incorporate it. To own this box, I’ll find the website which has a few tools for a hacker might use, including an option to have msfvenon create a payload. I’ll upload a malicious template and get code execution on the box. From there, I’ll exploit a cron with another command injection to reach the next user. Finally, to root, I’ll abuse the sudo rights of that user to run msfconsole as root, and use the built in shell commands to get a root shell. In Beyond Root, a look at some of the automations I put in place for the box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 31, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/31/htb-cereal-unintended.html">
                Cereal Unintended Root
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-cereal " class="post-tag">htb-cereal</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#timing-attack " class="post-tag">timing-attack</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/cereal-unintended-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/cereal-unintended-cover.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>There’s a really neat unintended path to root on Cereal discovered by HackTheBox user FF5. The important detail to notice is that a shell as sonny running via a webshell has additional groups related to IIS that don’t show up in an SSH shell. I can use these groups to exploit the IIS service and how it manages the website running as root with a timing attack that will allow me to slip my own code into the site and execute it. I’ll find the directory where IIS stages files and compiles them, the Shadow Copy Folders. I’ll delete everything in there, and trigger IIS to rebuilt. It will copy the source into the directory and compile it, but there’s a chance for me to modify the source between the copy and the compile.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 29, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/29/htb-cereal.html">
                HTB: Cereal
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-cereal " class="post-tag">htb-cereal</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#react " class="post-tag">react</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#csharp " class="post-tag">csharp</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#gitdumper " class="post-tag">gitdumper</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#visualstudio " class="post-tag">visualstudio</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#json-deserialization " class="post-tag">json-deserialization</a> <a href="/tags#npm " class="post-tag">npm</a> <a href="/tags#npm-audit " class="post-tag">npm-audit</a> <a href="/tags#react-marked-markdown " class="post-tag">react-marked-markdown</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#roguepotato " class="post-tag">roguepotato</a> <a href="/tags#potato " class="post-tag">potato</a> <a href="/tags#sweetpotato " class="post-tag">sweetpotato</a> <a href="/tags#printspoofer " class="post-tag">printspoofer</a> <a href="/tags#graphql " class="post-tag">graphql</a> <a href="/tags#graphql-voyager " class="post-tag">graphql-voyager</a> <a href="/tags#graphql-playground " class="post-tag">graphql-playground</a> <a href="/tags#jq " class="post-tag">jq</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#genericpotato " class="post-tag">genericpotato</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> <a href="/tags#htb-travel " class="post-tag">htb-travel</a> <a href="/tags#htb-dyplesher " class="post-tag">htb-dyplesher</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/cereal-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/cereal-cover.png" alt="Cereal" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Cereal was all about takign attacks I’ve done before, and breaking the ways I’ve previously done them so that I had to dig deeper and really understand them. I’ll find the source for a website on an exposed Git repo. The site is built in C#/.NET on the backend, and React JavaScript on the client side. I’ll first have to find the code that generates authentication tokens and use that to forge a token that gets me past the login. There I have access to a form that can submit cereal flavor requests. I’ll chain together a cross-site scripting vulnerability and a deserialization vulnerability to upload a webshell. That was made more tricky because the serverside code had logic in place to break payloads generated by YSoSerial. With execution, I’ll find the first user password and get SSH access. That user has SeImpersonate. But with no print spooler service on the box, and no outbound TCP port 135, neither RoguePotato, SweetPotato, or PrintSpoofer could abuse it to get a SYSTEM shell. I’ll enumerate a site running on localhost and its GraphQL backend to find a serverside request forgery vulnerability, which I’ll abuse with GenericPotato to get a shell as System.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 25, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/25/htb-shocker.html">
                HTB: Shocker
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-shocker " class="post-tag">htb-shocker</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#cgi " class="post-tag">cgi</a> <a href="/tags#shellshock " class="post-tag">shellshock</a> <a href="/tags#bashbug " class="post-tag">bashbug</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#cve-2014-6271 " class="post-tag">cve-2014-6271</a> <a href="/tags#gtfobin " class="post-tag">gtfobin</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/shocker-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/shocker-cover.png" alt="Shocker" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The name Shocker gives away pretty quickly what I’ll need to do on this box. There were a couple things to look out for along the way. First, I’ll need to be careful when directory brute forcing, as the server is misconfigured in that the cgi-bin directory doesn’t show up without a trailing slash. This means that tools like gobuster and feroxbuster miss it in their default state. I’ll show both manually exploiting ShellShock and using the nmap script to identify it is vulnerable. Root is a simple GTFObin in perl. In Beyond Root, I’ll look at the Apache config and go down a rabbit hole looking at what commands cause execution to stop in ShellShock and try to show how I experimented to come up with a theory that seems to explain what’s happening.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 22, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/22/htb-delivery.html">
                HTB: Delivery
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-delivery " class="post-tag">htb-delivery</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#osticket " class="post-tag">osticket</a> <a href="/tags#mattermost " class="post-tag">mattermost</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#hashcat-rules " class="post-tag">hashcat-rules</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/delivery-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/delivery-cover.png" alt="Delivery" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Delivery is a easy-rated box that I found very beginner friendly. It didn’t require anything technically complex, but rather a bit of creative thinking. The box presents a helpdesk and an instance of Mattermost. By creating a ticket at the helpdesk, I get an email that I can use to update the ticket. I’ll use that email to register a Mattermost account, where I find internal conversations that include creds for SSH. With access to the box, I’ll check out the database and dump the root password hash. Using hashcat rules mentioned in the Mattermost chat, I’ll crack that password, which is the root password on the box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 19, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/19/htb-kotarak.html">
                HTB: Kotarak
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-kotarak " class="post-tag">htb-kotarak</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#war " class="post-tag">war</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#lxc " class="post-tag">lxc</a> <a href="/tags#ntds " class="post-tag">ntds</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#wget " class="post-tag">wget</a> <a href="/tags#cve-2016-4971 " class="post-tag">cve-2016-4971</a> <a href="/tags#authbind " class="post-tag">authbind</a> <a href="/tags#disk " class="post-tag">disk</a> <a href="/tags#lvm " class="post-tag">lvm</a> <a href="/tags#htb-nineveh " class="post-tag">htb-nineveh</a> <a href="/tags#htb-jerry " class="post-tag">htb-jerry</a> <a href="/tags#htb-tabby " class="post-tag">htb-tabby</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/kotarak-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/kotarak-cover.png" alt="Kotarak" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Kotarak was an old box that I had a really fun time replaying for a writeup. It starts with an SSRF that allows me to find additional webservers on ports only listening on localhost. I’ll use that to leak a Tomcat config with username and password, and upload a malicious war to get a shell. From there, I can access files from an old Windows pentest to include an ntds.dit file and a system hive. That’s enough to dump a bunch of hashes, one of which cracks and provides creds I can use to get the next user. The root flag is actually in a container that is using Wget to request a file every two minutes. It’s an old vulnerable version, and a really neat exploit that involves sending a redirect to an FTP server and using that to write a malicious config file in the root home directory in the container. I’ll also show an alternative root abusing the user’s disk group to exfil the entire root filesystem and grab the flag on my local system.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 17, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/17/digging-into-cgroups.html">
                Digging into cgroups Escape
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-ready " class="post-tag">htb-ready</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#cgroups " class="post-tag">cgroups</a> <a href="/tags#escape " class="post-tag">escape</a> <a href="/tags#overlayfs " class="post-tag">overlayfs</a> <a href="/tags#release-agent " class="post-tag">release-agent</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ready-cgroups-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ready-cgroups-cover.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The method I used in Ready to get code execution on the host system from a docker container running as privileged was a series of bash commands that didn’t make any sense on first glance. I wanted to dive into them and see what was happening under the hood.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 15, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/15/htb-ready.html">
                HTB: Ready
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-ready " class="post-tag">htb-ready</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#gitlab " class="post-tag">gitlab</a> <a href="/tags#cve-2018-19571 " class="post-tag">cve-2018-19571</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#cve-2018-19585 " class="post-tag">cve-2018-19585</a> <a href="/tags#crlf-injection " class="post-tag">crlf-injection</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#redis " class="post-tag">redis</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#escape " class="post-tag">escape</a> <a href="/tags#docker-privileged " class="post-tag">docker-privileged</a> <a href="/tags#cgroups " class="post-tag">cgroups</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ready-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ready-cover.png" alt="Ready" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Ready was another opportunity to abuse CVEs in GitLab to get a foothold in a GitLab container. Within that container, I’ll find some creds that will escalate to root. I’ll also notice that the container is run with the privileged flag, which gives it a lot of power with respect to the host system. I’ll show two ways to abuse this, using cgroups and just accessing the host filesystem.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 11, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/11/htb-blue.html">
                HTB: Blue
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-blue " class="post-tag">htb-blue</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#nmap-scripts " class="post-tag">nmap-scripts</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#ms17-010 " class="post-tag">ms17-010</a> <a href="/tags#eternalblue " class="post-tag">eternalblue</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#impacket " class="post-tag">impacket</a> <a href="/tags#virtualenv " class="post-tag">virtualenv</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/blue-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/blue-cover.png" alt="Blue" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Blue was the first box I owned on HTB, on 8 November 2017. And it really is one of the easiest boxes on the platform. The root first blood went in two minutes. You just point the exploit for MS17-010 (aka ETERNALBLUE) at the machine and get a shell as System. I’ll show how to find the machine is vulnerable to MS17-010 using Nmap, and how to exploit it with both Metasploit and using Python scripts.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 8, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/08/htb-attended.html">
                HTB: Attended
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-attended " class="post-tag">htb-attended</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#smtp " class="post-tag">smtp</a> <a href="/tags#stmp-user-enum " class="post-tag">stmp-user-enum</a> <a href="/tags#swaks " class="post-tag">swaks</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#vim " class="post-tag">vim</a> <a href="/tags#cve-2019-12735 " class="post-tag">cve-2019-12735</a> <a href="/tags#vim-modelines " class="post-tag">vim-modelines</a> <a href="/tags#firewall " class="post-tag">firewall</a> <a href="/tags#scripting " class="post-tag">scripting</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#ssh-config " class="post-tag">ssh-config</a> <a href="/tags#ssh-keys " class="post-tag">ssh-keys</a> <a href="/tags#ping-sweep " class="post-tag">ping-sweep</a> <a href="/tags#nc-port-scan " class="post-tag">nc-port-scan</a> <a href="/tags#openbsd " class="post-tag">openbsd</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#debug " class="post-tag">debug</a> <a href="/tags#ssh-keygen " class="post-tag">ssh-keygen</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#rop " class="post-tag">rop</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#ropper " class="post-tag">ropper</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#htb-flujab " class="post-tag">htb-flujab</a> <a href="/tags#htb-ypuffy " class="post-tag">htb-ypuffy</a> <a href="/tags#htb-travel " class="post-tag">htb-travel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/attended-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/attended-cover.png" alt="Attended" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Attended was really hard. At the time of writing three days before it retires, just over 100 people have rooted it, making it the least rooted box on HackTheBox. It starts with a phishing exercise where hints betray that the user will open a text file in Vim, opening them to the Vim modelines exploit to get command execution. But there’s a firewall blocking any outbound traffic that isn’t ICMP or a valid HTTP GET request, so I’ll write some scripts to build command and control through that. Then I find a place I can drop an SSH config file that will be run by the second user, which I’ll abuse to get SSH access. For root, there’s a buffer overflow in a command processing SSH auth on the gateway. I’ll craft a malicious SSH key to overflow that binary and get a reverse shell. In Beyond Root, I’ll look at an unintended command injection in the SSH config running script.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 4, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/04/networking-vms-for-htb.html">
                Networking VMs for HTB
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#configuration " class="post-tag">configuration</a> <a href="/tags#virtual-machine " class="post-tag">virtual-machine</a> <a href="/tags#parrot-os " class="post-tag">parrot-os</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/vms-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/vms-cover.png" alt="VM Config" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>When doing HTB or other CTFs, I typically run from a Linux VM (formerly Kali, lately Parrot), but I also need to use a Windows VM from time to time as well. Some of those times, I’ll need to interact with the HTB machines over the VPN from the Windows host, and it’s always a bit of a pain to turn off the VPN in the Linux VM, and then turn it on from Windows. This post shows how I configured my VMs so that Windows traffic can route through the Linux VM to HTB.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 3, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/03/more-bucket-beyond-root.html">
                More Bucket Beyond Root
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-bucket " class="post-tag">htb-bucket</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#s3 " class="post-tag">s3</a> <a href="/tags#aws " class="post-tag">aws</a> <a href="/tags#awscli " class="post-tag">awscli</a> <a href="/tags#apache " class="post-tag">apache</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#localstack " class="post-tag">localstack</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#automation " class="post-tag">automation</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bucket-more-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bucket-more-cover.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>@teh_zeron reach out on twitter to ask why there’s no images directory in the webroot on Bucket. I showed how my PHP webshell will show up there, and the index page seems to always be there. I’ll look closely at how Bucket was set up, how different requests are handled, and the automation that is syncing between the host and the container.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 1, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/05/01/htb-sharp.html">
                HTB: Sharp
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-sharp " class="post-tag">htb-sharp</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#portable-kanban " class="post-tag">portable-kanban</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#dotnet-remoting " class="post-tag">dotnet-remoting</a> <a href="/tags#ysoserial-net " class="post-tag">ysoserial.net</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#exploitremotingservice " class="post-tag">exploitremotingservice</a> <a href="/tags#wcf " class="post-tag">wcf</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#csharp " class="post-tag">csharp</a> <a href="/tags#htb-json " class="post-tag">htb-json</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sharp-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sharp-cover.png" alt="Sharp" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Sharp was all about C# and .NET. It started with a PortableKanban config. At the time of release, there was no public scripts decrypting the database, so it involved reverse engineering a real .NET binary. From there, I’ll reverse and exploit a .NET remoting service with a serialized payload to get shell as user. To escalate to system, I’ll reverse a Windows Communication Foundation (WCF)-based service to find an endpoint that runs PowerShell code. I’ll create a client to return a reverse shell. I’m also going to solve this one from a Windows VM (mostly).</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 27, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/04/27/htb-toolbox.html">
                HTB: Toolbox
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-toolbox " class="post-tag">htb-toolbox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#docker-toolbox " class="post-tag">docker-toolbox</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#postgresql " class="post-tag">postgresql</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#default-creds " class="post-tag">default-creds</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#container " class="post-tag">container</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/toolbox-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/toolbox-cover.png" alt="Toolbox" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Toolbox is a machine that released directly into retired as a part of the Containers and Pivoting Track on HackTheBox. It’s a Windows instance running an older tech stack, Docker Toolbox. Before Windows could support containers, this used VirtualBox to run a lightweight custom Linux OS optimized for running Docker. I’ll get a foodhold using SQL injection which converts into RCE with sqlmap. Then I’ll use default credentials to pivot into the VM, where I find an SSH key that gives administrator access to the host system.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 24, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/04/24/htb-bucket.html">
                HTB: Bucket
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-bucket " class="post-tag">htb-bucket</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#s3 " class="post-tag">s3</a> <a href="/tags#aws " class="post-tag">aws</a> <a href="/tags#awscli " class="post-tag">awscli</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#dynamodb " class="post-tag">dynamodb</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#localstack " class="post-tag">localstack</a> <a href="/tags#pd4ml " class="post-tag">pd4ml</a> <a href="/tags#pdfdetach " class="post-tag">pdfdetach</a> <a href="/tags#getfacl " class="post-tag">getfacl</a> <a href="/tags#facl " class="post-tag">facl</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bucket-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bucket-cover.png" alt="Bucket" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Bucket is a pentest against an Amazon AWS stack. There’s an S3 bucket that is being used to host a website and is configured to allow unauthenticated read / write. I’ll upload a webshell to get a foothold on the box. From there, I’ll access the DynamoDB instance to find some passwords, one of which is re-used for the user on the box. There’s another webserver on localhost with a in-development service that creates a PDF based on entries in the database. I’ll exploit that to get file read on the system as root, and turn that into a root shell. In Beyond Root, I’ll look at some of the configuration that allowed the box to simulate AWS inside HTB.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 17, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/04/17/htb-laboratory.html">
                HTB: Laboratory
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-laboratory " class="post-tag">htb-laboratory</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#gitlab " class="post-tag">gitlab</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#cve-2020-10977 " class="post-tag">cve-2020-10977</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#hackerone " class="post-tag">hackerone</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#ruby " class="post-tag">ruby</a> <a href="/tags#irb " class="post-tag">irb</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/laboratory-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/laboratory-cover.png" alt="Laboratory" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>As the name hints at, Laboratory is largely about exploiting a GitLab instance. I’ll exploit a CVE to get arbitrary read and then code execution in the GitLab container. From there, I’ll use that access to get access to the admin’s private repo, which happens to have an SSH key. To escalate to root, I’ll exploit a SUID binary that is calling <code class="language-plaintext highlighter-rouge">system("chmod ...")</code> in an unsafe way, dropping my own binary and modifying the PATH so that mine gets run as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 10, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/04/10/htb-apt.html">
                HTB: APT
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-apt " class="post-tag">htb-apt</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ipv6 " class="post-tag">ipv6</a> <a href="/tags#rpc " class="post-tag">rpc</a> <a href="/tags#ioxidresolver " class="post-tag">ioxidresolver</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#domain-controller " class="post-tag">domain-controller</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#ntds " class="post-tag">ntds</a> <a href="/tags#kerbrute " class="post-tag">kerbrute</a> <a href="/tags#wail2ban " class="post-tag">wail2ban</a> <a href="/tags#pykerbrute " class="post-tag">pykerbrute</a> <a href="/tags#mimikatz " class="post-tag">mimikatz</a> <a href="/tags#passthehash " class="post-tag">passthehash</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#remote-registry " class="post-tag">remote-registry</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#reg-py " class="post-tag">reg-py</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#history " class="post-tag">history</a> <a href="/tags#lmcompatibilitylevel " class="post-tag">lmcompatibilitylevel</a> <a href="/tags#net-ntlmv1 " class="post-tag">net-ntlmv1</a> <a href="/tags#winpeas " class="post-tag">winpeas</a> <a href="/tags#seatbelt " class="post-tag">seatbelt</a> <a href="/tags#amsi " class="post-tag">amsi</a> <a href="/tags#defender " class="post-tag">defender</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#roguepotato " class="post-tag">roguepotato</a> <a href="/tags#ntlmrelayx " class="post-tag">ntlmrelayx</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#crack-sh " class="post-tag">crack-sh</a> <a href="/tags#powershell-history " class="post-tag">powershell-history</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/apt-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/apt-cover.png" alt="APT" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>APT was a clinic in finding little things to exploit in a Windows host. I’ll start with access to only RPC and HTTP, and the website has nothing interesting. I’ll use RPC to identify an IPv6 address, which when scanned, shows typical Windows DC ports. Over SMB, I’ll pull a zip containing files related to an Active Directory environment. After cracking the password, I’ll use these files to dump 2000 users / hashes. Kerbrute will identify one user that is common between the backup and the AD on APT. The hash for that user doesn’t work, and brute forcing using NTLM hashes gets me blocked using SMB, so I’ll modify pyKerbrute to test all the hashes from the backup with the user, finding one that works. With that hash, I can access the registry and find additional creds that provide WinRM access. With a shell, I’ll notice that the system still allows Net-NTLMv1, which is an insecure format. I’ll show two ways to get the Net-NTLMv1 challenge response, first an unintended path using Defender and Responder, and then the intended path using RoguePotato and a custom RPC server created by modifying NTLMRelayX.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 3, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/04/03/htb-time.html">
                HTB: Time
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-time " class="post-tag">htb-time</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#cve-2019-12384 " class="post-tag">cve-2019-12384</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#json-deserialization " class="post-tag">json-deserialization</a> <a href="/tags#sql " class="post-tag">sql</a> <a href="/tags#linpeas " class="post-tag">linpeas</a> <a href="/tags#systemd " class="post-tag">systemd</a> <a href="/tags#short-lived-shells " class="post-tag">short-lived-shells</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/time-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/time-cover.png" alt="Time" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Time is a straight forward box with two steps and low enumeration. The first step involves looking at the error code coming off a web application and some Googling to find an associated CVE. From there, I’ll build a serialized JSON payload using the template in some of the CVE writeups, and get code execution and a shell. There’s a Systemd timer running every few seconds, and the script being run is world writable. To get root, I’ll just add some commands to that script and let it run. In Beyond Root, I look at the webserver and if I could write a file in the webroot, and also at handling the initial short-lived shell I got from the Systemd timer.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 27, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/03/27/htb-luanne.html">
                HTB: Luanne
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-luanne " class="post-tag">htb-luanne</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#netbsd " class="post-tag">netbsd</a> <a href="/tags#supervisor-process-manager " class="post-tag">supervisor-process-manager</a> <a href="/tags#default-creds " class="post-tag">default-creds</a> <a href="/tags#http-basic-auth " class="post-tag">http-basic-auth</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#lua " class="post-tag">lua</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#htpasswd " class="post-tag">htpasswd</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#doas " class="post-tag">doas</a> <a href="/tags#pgp " class="post-tag">pgp</a> <a href="/tags#netpgp " class="post-tag">netpgp</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/luanne-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/luanne-cover.png" alt="Luanne" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Luanne was the first NetBSD box I’ve done on HTB. I’ll gain access to an instance of Supervisor Process Manager, and use that to leak a process list, which shows where to look on the port 80 webserver. I’ll find an API that I know is backed by a Lua script, and exploit a command injection vulnerability to get execution and a shell. I’ll get credentials for a webserver listening on localhost and find an SSH key hosted there to get to the second user. That user can doas (like sudo on BSD) arbitrary commands as root, the password is needed. It’s in an encrypted backup file which can be decrypted using PGP on the host. In Beyond Root, I’ll look at the Lua script, figure out how it works, where the injection vulnerability is, and compare that to the patched dev version to see how it was fixed.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 20, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/03/20/htb-crossfit.html">
                HTB: CrossFit
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-crossfit " class="post-tag">htb-crossfit</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ftp-tls " class="post-tag">ftp-tls</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#xmlhttprequest " class="post-tag">xmlhttprequest</a> <a href="/tags#cors " class="post-tag">cors</a> <a href="/tags#csrf " class="post-tag">csrf</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#lftp " class="post-tag">lftp</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#ansible " class="post-tag">ansible</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#php-shellcommand " class="post-tag">php-shellcommand</a> <a href="/tags#vsftpd " class="post-tag">vsftpd</a> <a href="/tags#pam " class="post-tag">pam</a> <a href="/tags#hidepid " class="post-tag">hidepid</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/crossfit-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/crossfit-cover.png" alt="CrossFit" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>CrossFit is all about chaining attacks together to get the target to do my bidding. It starts with a cross-site scripting (XSS) attack against a website. The site detects the attack, and forwards my user agent to the admins to investigation. An XSS payload in the user-agent will trigger, giving some access there. I’ll abuse cross-origin resource sharing (CORS) to identify another subdomain, and then use the XSS to do a cross-site request forgery, having the admins create an account for me on that subdomain, which provides FTP access, where I can upload a webshell, and use the XSS once again to trigger it for a reverse shell. I’ll dig a hash out of ansible configs and crack it to get the next user. To escalate again, I’ll exploit a command injection vulnerability in a PHP plugin, php-shellcommand, by writing to the database. To get root, I’ll reverse engineer a binary that runs on a cron and figure out how to trick it to write a SSH key into root’s authorized_keys file.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 17, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/03/17/htb-optimum.html">
                HTB: Optimum
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-optimum " class="post-tag">htb-optimum</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#httpfileserver " class="post-tag">httpfileserver</a> <a href="/tags#hfs " class="post-tag">hfs</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#cve-2014-6287 " class="post-tag">cve-2014-6287</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#winpeas " class="post-tag">winpeas</a> <a href="/tags#watson " class="post-tag">watson</a> <a href="/tags#sherlock " class="post-tag">sherlock</a> <a href="/tags#process-architechure " class="post-tag">process-architechure</a> <a href="/tags#ms16-032 " class="post-tag">ms16-032</a> <a href="/tags#cve-2016-0099 " class="post-tag">cve-2016-0099</a> <a href="/tags#htb-bounty " class="post-tag">htb-bounty</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/optimum-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/optimum-cover.png" alt="Optimum" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Optimum was sixth box on HTB, a Windows host with two CVEs to exploit. The first is a remote code execution vulnerability in the HttpFileServer software. I’ll use that to get a shell. For privesc, I’ll look at unpatched kernel vulnerabilities. Today to enumerate these I’d use Watson (which is also built into winPEAS), but getting the new version to work on this old box is actually challenging, so I’ll use Sherlock (a predecessor to Watson) to identify these vulnerabilities. I got hung up for a bit not realizing my shell was running in a 32-bit process, causing my kernel exploits to fail. I’ll show some analysis of that as well.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 15, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/03/15/reel2-root-shell.html">
                Reel2: Root Shell
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-reel2 " class="post-tag">htb-reel2</a> <a href="/tags#htb-reel " class="post-tag">htb-reel</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wallstant " class="post-tag">wallstant</a> <a href="/tags#apache " class="post-tag">apache</a> <a href="/tags#xampp " class="post-tag">xampp</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#chisel " class="post-tag">chisel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/reel2-more-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/reel2-more-cover.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Both YB1 and JKR suggested a neat method for getting a shell on Reel2 that involves abusing the Apache Web server running as SYSTEM to write a webshell. It’s a neat path that involves identifying where the config files are and getting access to the database using the arbitrary read intended to get the root flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 13, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/03/13/htb-reel2.html">
                HTB: Reel2
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-reel2 " class="post-tag">htb-reel2</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#owa " class="post-tag">owa</a> <a href="/tags#wallstant " class="post-tag">wallstant</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#sprayingtoolkit " class="post-tag">sprayingtoolkit</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#ps-remoting " class="post-tag">ps-remoting</a> <a href="/tags#jea " class="post-tag">jea</a> <a href="/tags#jea-escape " class="post-tag">jea-escape</a> <a href="/tags#stickynotes " class="post-tag">stickynotes</a> <a href="/tags#htb-reel " class="post-tag">htb-reel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/reel2-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/reel2-cover.png" alt="Reel2" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Much like it’s predascor, Reel, Reel2 was focused on realistic attacks against a Windows environment. This time I’ll collect names from a social media site and use them to password spray using the SprayingToolkit. Once I find a working password, I’ll send a link from that account and get an NTLM hash using responder. From there I need to break out of a JEA limited PowerShell, find creds to another account, and trick a custom command from that account into reading root.txt.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 11, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/03/11/htb-sense.html">
                HTB: Sense
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-sense " class="post-tag">htb-sense</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#pfsense " class="post-tag">pfsense</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#dirbuster " class="post-tag">dirbuster</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#feroxbuster " class="post-tag">feroxbuster</a> <a href="/tags#cve-2016-10709 " class="post-tag">cve-2016-10709</a> <a href="/tags#burp " class="post-tag">burp</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sense-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sense-cover.png" alt="Sense" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Sense is a box my notes show I solved almost exactly three years ago. It’s a short box, using directory brute forcing to find a text file with user credentials, and using those to gain access to a PF Sense Firewall. From there I’ll exploit a code injection using Metasploit to get code execution and a shell as root. In Beyond Root, I’ll look at a couple things that I would do differently today. First, I’ll show out Feroxbuster to do the recurrsive directory brute force, and then I’ll dig into the exploit and how it works and how it might be done without Metasploit.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 6, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/03/06/htb-passage.html">
                HTB: Passage
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-passage " class="post-tag">htb-passage</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#cutenews " class="post-tag">cutenews</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#github " class="post-tag">github</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#base64 " class="post-tag">base64</a> <a href="/tags#penglab " class="post-tag">penglab</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#vim " class="post-tag">vim</a> <a href="/tags#usbcreator " class="post-tag">usbcreator</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> <a href="/tags#arbitrary-read " class="post-tag">arbitrary-read</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#passwd " class="post-tag">passwd</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/passage-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/passage-cover.png" alt="Passage" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>In Passage, I’ll find and exploit CuteNews with a webshell upload. I’ll have to analyze the CuteNews source to figure out how it stores user data in files to find the hash for the next user, which I’ll crack. That user shares an SSH key with the next user on the box. To root, I’ll exploit a bug in USBCreator that allows me to run sudo without knowing the user’s password. In Beyond Root, I’ll dive into the basics of base64 and how to search for strings in large amounts of base64 data.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 2, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/03/02/htb-sneaky.html">
                HTB: Sneaky
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-sneaky " class="post-tag">htb-sneaky</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#udp " class="post-tag">udp</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#mibs " class="post-tag">mibs</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#auth-bypass " class="post-tag">auth-bypass</a> <a href="/tags#onesixtyone " class="post-tag">onesixtyone</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#ipv6 " class="post-tag">ipv6</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#pwn " class="post-tag">pwn</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sneaky-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sneaky-cover.png" alt="Sneaky" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Sneaky presented a website that after some basic SQL injection, leaked an SSH key. But SSH wasn’t listening. At least not on IPv4. I’ll show three ways to find the IPv6 address of Sneaky, and then SSH using that address to get user. For root, there’s a simple buffer overflow with no protections. I’ll show a basic attack, writing shellcode onto the stack and then returning into it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 27, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/02/27/htb-academy.html">
                HTB: Academy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-academy " class="post-tag">htb-academy</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#cve-2018-15133 " class="post-tag">cve-2018-15133</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#adm " class="post-tag">adm</a> <a href="/tags#logs " class="post-tag">logs</a> <a href="/tags#aureport " class="post-tag">aureport</a> <a href="/tags#composer " class="post-tag">composer</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/academy-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/academy-cover.png" alt="Academy" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>HackTheBox releases a new training product, Academy, in the most HackTheBox way possible - By putting out a vulnerable version of it to hack on. There’s a website with a vulnerable registration page that allows me to register as admin and get access to a status dashboard. There I find a new virtual host, which is crashing, revealing a Laravel crash with data including the APP_KEY. I can use that to create a serialized payload to submit as an HTTP header or cookie to get execution. From there, I’ll reuse database creds to get to the next user, and then find more creds in auth logs, and finally get root with sudo composer.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 23, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/02/23/htb-beep.html">
                HTB: Beep
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-beep " class="post-tag">htb-beep</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#elastix " class="post-tag">elastix</a> <a href="/tags#pbx " class="post-tag">pbx</a> <a href="/tags#dirsearch " class="post-tag">dirsearch</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#webmin " class="post-tag">webmin</a> <a href="/tags#smtp " class="post-tag">smtp</a> <a href="/tags#svwar " class="post-tag">svwar</a> <a href="/tags#sslscan " class="post-tag">sslscan</a> <a href="/tags#shellshock " class="post-tag">shellshock</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-unattended " class="post-tag">htb-unattended</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/beep-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/beep-cover.png" alt="Beep" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Even when it was released there were many ways to own Beep. I’ll show five, all of which were possible when this box was released in 2017. Looking a the timestamps on my notes, I completed Beep in August 2018, so this writeup will be a mix of those plus new explorations. The box is centered around PBX software. I’ll exploit an LFI, RCE, two different privescs, webmin, credential reuse, ShellShock, and webshell upload over SMTP.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 20, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/02/20/htb-feline.html">
                HTB: Feline
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-feline " class="post-tag">htb-feline</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#cve-2020-9484 " class="post-tag">cve-2020-9484</a> <a href="/tags#ysoserial " class="post-tag">ysoserial</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#saltstack " class="post-tag">saltstack</a> <a href="/tags#cve-2020-11651 " class="post-tag">cve-2020-11651</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#docker-sock " class="post-tag">docker-sock</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#socat " class="post-tag">socat</a> <a href="/tags#htb-fatty " class="post-tag">htb-fatty</a> <a href="/tags#htb-arkham " class="post-tag">htb-arkham</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/feline-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/feline-cover.png" alt="Feline" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Feline was another Tomcat box, this time exploiting a neat CVE that allowed me to upload a malcious serialized payload and then trigger it by giving a cookie that points the session to that file. The rest of the box focuses on Salt Stack, an IT automation platform. My foothold shell is on the main host, but Salt is running in a container. I’ll exploit another CVE to get a shell in the Salt container, and then exploit that containers access to the docker socket to get root on the host. In Beyond Root, I’ll show an alternative way of interacting with the docker socket by uploading the docker binary, and I’ll look at the permissions on that socket and how it’s shared into the container.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 16, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/02/16/htb-charon.html">
                HTB: Charon
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-charon " class="post-tag">htb-charon</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#rsactftool " class="post-tag">rsactftool</a> <a href="/tags#history " class="post-tag">history</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#ltrace " class="post-tag">ltrace</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/charon-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/charon-cover.png" alt="Charon" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Another 2017 box, but this one was a lot of fun. There’s an SQL injection the designed to break sqlmap (I didn’t bother to go into sqlmap, but once I finished saw from others). Then there’s a file upload, some crypto, and a command injection. I went into good detail on the manual SQLI and the RSA crypto. In Beyond Root, I’ll look at a second SQLI that didn’t prove usefu, and at the filters I had to bypass on the useful SQLI.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 13, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/02/13/htb-jewel.html">
                HTB: Jewel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-jewel " class="post-tag">htb-jewel</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gitweb " class="post-tag">gitweb</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#ruby " class="post-tag">ruby</a> <a href="/tags#rails " class="post-tag">rails</a> <a href="/tags#gemfile " class="post-tag">gemfile</a> <a href="/tags#cve-2020-8164 " class="post-tag">cve-2020-8164</a> <a href="/tags#irb " class="post-tag">irb</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#google-authenticator " class="post-tag">google-authenticator</a> <a href="/tags#totp " class="post-tag">totp</a> <a href="/tags#postgresql " class="post-tag">postgresql</a> <a href="/tags#penglab " class="post-tag">penglab</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#oathtool " class="post-tag">oathtool</a> <a href="/tags#gem " class="post-tag">gem</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/jewel-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/jewel-cover.png" alt="Jewel" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Jewel was all about Ruby, with a splash of Google Authenticator 2FA in the middle. I’ll start with an instance of GitWeb providing the source for a website. That source allows me to identify a Ruby on Rails deserialization exploit that provides code execution. To escalate, I’ll find the user’s password in the database, and the seed for the Google Authenticator to calculate the time-based one time password, both of which are needed to run sudo. From there, I can use GTFObins to get execution from the gem program.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 9, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/02/09/htb-apocalyst.html">
                HTB: Apocalyst
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-apocalyst " class="post-tag">htb-apocalyst</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#steghide " class="post-tag">steghide</a> <a href="/tags#passwd " class="post-tag">passwd</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/apocalyst-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/apocalyst-cover.png" alt="Apocalyst" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Apocalyst wasn’t my favorite box. It is all about building a wordlist to find a specific image file on the site, and then extracting another list from that image using StegHide. That list contains the WordPress user’s password, giving access to the admin panel and thus execution. To root, I’ll find a writable passwd file and add in a root user.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 6, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/02/06/htb-doctor.html">
                HTB: Doctor
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-doctor " class="post-tag">htb-doctor</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#splunk " class="post-tag">splunk</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#adm " class="post-tag">adm</a> <a href="/tags#linpeas " class="post-tag">linpeas</a> <a href="/tags#splunk-whisperer2 " class="post-tag">splunk-whisperer2</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-secnotes " class="post-tag">htb-secnotes</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/doctor-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/doctor-cover.png" alt="Doctor" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Doctor was about attacking a message board-like website. I’ll find two vulnerabilities in the site, Server-Side Template injection and command injection. Either way, the shell I get back has access to read logs, where I’ll find a password sent to a password reset url, which works for both the next user and to log into the Splunk Atom Feed. I’ll exploit that with SplunkWhisperer2 to get RCE and a root shell. In Beyond Root, I’ll look at a strange artifact I found on the box where, and examine the source for both web exploit.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 2, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/02/02/htb-europa.html">
                HTB: Europa
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-europa " class="post-tag">htb-europa</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#preg-replace " class="post-tag">preg_replace</a> <a href="/tags#cron " class="post-tag">cron</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/europa-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/europa-cover.png" alt="Europa" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Europa was a relatively easy box by today’s HTB standards, but it offers a good chance to play with the most basic of SQL injections, the auth bypass. I’ll also use sqlmap to dump the database. The foothold involves exploiting the PHP preg_replace function, which is something you’ll only see on older hosts at this point. To get root, I’ll find a cron job that calls another script that I can write.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 30, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/01/30/htb-worker.html">
                HTB: Worker
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-worker " class="post-tag">htb-worker</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#svn " class="post-tag">svn</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#azure " class="post-tag">azure</a> <a href="/tags#azure-devops " class="post-tag">azure-devops</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#devops " class="post-tag">devops</a> <a href="/tags#pipeline " class="post-tag">pipeline</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#azure-pipelines " class="post-tag">azure-pipelines</a> <a href="/tags#potato " class="post-tag">potato</a> <a href="/tags#roguepotato " class="post-tag">roguepotato</a> <a href="/tags#juicypotato " class="post-tag">juicypotato</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#socat " class="post-tag">socat</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#cicd " class="post-tag">cicd</a> <a href="/tags#htb-sizzle " class="post-tag">htb-sizzle</a> <a href="/tags#htb-json " class="post-tag">htb-json</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/worker-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/worker-cover.png" alt="Worker" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Worker is all about exploiting an Azure DevOps environment. I’ll find creds in an old SVN repository and use them to get into the Azure DevOps control panel where several websites are managed. I’ll upload a webshell into one of the sites and rebuild it, gaining execution and a shell. With the shell I’ll find creds for another user, and use that to get back into Azure DevOps, this time as someone with permission to create pipelines, which I’ll use to get a shell as System. In Beyond Root, I’ll show RoguePotato, as this was one of the first vulnerable boxes to release after that came out.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 23, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/01/23/htb-compromised.html">
                HTB: Compromised
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-compromised " class="post-tag">htb-compromised</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#litecart " class="post-tag">litecart</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#mysql-udf " class="post-tag">mysql-udf</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#php-disable-functions " class="post-tag">php-disable-functions</a> <a href="/tags#phpinfo " class="post-tag">phpinfo</a> <a href="/tags#strace " class="post-tag">strace</a> <a href="/tags#pam-backdoor " class="post-tag">pam-backdoor</a> <a href="/tags#ldpreload-backdoor " class="post-tag">ldpreload-backdoor</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#ghidra-version-tracking " class="post-tag">ghidra-version-tracking</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ldpreload " class="post-tag">ldpreload</a> <a href="/tags#htb-stratosphere " class="post-tag">htb-stratosphere</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/compromised-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/compromised-cover.png" alt="Compromised" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Compromised involves a box that’s already been hacked, and so  the challenge is to follow the hacker and both exploit public vulnerabilities as well as make use of backdoors left behind by the hacker. I’ll find a website backup file that shows how the login page was backdoored to record admin credentials to a web accessible file. With those creds, I’ll exploit a vulnerable LiteCart instance, though the public exploit doesn’t work. I’ll troubleshot that to find that the PHP functions typically used for execution are disabled. I’ll show two ways to work around that to get access to the database and execution as the mysql user, who’s shell has been enabled by the hacker. As the mysql user, I’ll find a strace log, likely a makeshift keylogger used by the hacker with creds to pivot to the next user. To get root, I’ll take advantage of either of two backdoors left on the box by the attacker, a PAM backdoor and a LDPRELOAD backdoor. In Beyond Root, I’ll show how to run commands as root using the PAM backdoor from the webshell as www-data.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 16, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/01/16/htb-ropetwo.html">
                HTB: RopeTwo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-ropetwo " class="post-tag">htb-ropetwo</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#pwn " class="post-tag">pwn</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#c " class="post-tag">c</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#v8 " class="post-tag">v8</a> <a href="/tags#d8 " class="post-tag">d8</a> <a href="/tags#gef " class="post-tag">gef</a> <a href="/tags#pwngdb " class="post-tag">pwngdb</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#heap " class="post-tag">heap</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#realloc " class="post-tag">realloc</a> <a href="/tags#fake-chunk " class="post-tag">fake-chunk</a> <a href="/tags#tcache " class="post-tag">tcache</a> <a href="/tags#unsorted-bin " class="post-tag">unsorted-bin</a> <a href="/tags#main-arena " class="post-tag">main-arena</a> <a href="/tags#fsop " class="post-tag">fsop</a> <a href="/tags#free-hook " class="post-tag">free-hook</a> <a href="/tags#heapinfo " class="post-tag">heapinfo</a> <a href="/tags#kernel-pwn " class="post-tag">kernel-pwn</a> <a href="/tags#kernel-debug " class="post-tag">kernel-debug</a> <a href="/tags#rop " class="post-tag">rop</a> <a href="/tags#kernel-rop " class="post-tag">kernel-rop</a> <a href="/tags#kaslr " class="post-tag">kaslr</a> <a href="/tags#ropgadget " class="post-tag">ropgadget</a> <a href="/tags#stack-pivot " class="post-tag">stack-pivot</a> <a href="/tags#prepare-kernel-cred " class="post-tag">prepare-kernel-cred</a> <a href="/tags#commit-creds " class="post-tag">commit-creds</a> <a href="/tags#apport " class="post-tag">apport</a> <a href="/tags#htb-traceback " class="post-tag">htb-traceback</a> <a href="/tags#apt " class="post-tag">apt</a> <a href="/tags#http-proxy " class="post-tag">http-proxy</a> <a href="/tags#cve-2020-8831 " class="post-tag">cve-2020-8831</a> <a href="/tags#wasm " class="post-tag">wasm</a> <a href="/tags#wasm-fiddle " class="post-tag">wasm-fiddle</a> <a href="/tags#webassembly " class="post-tag">webassembly</a> <a href="/tags#htb-playertwo " class="post-tag">htb-playertwo</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ropetwo-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ropetwo-cover.png" alt="RopeTwo" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>RopeTwo, much like Rope, was just a lot of binary exploitation. It starts with a really neat attack on Google’s v8 JavaScript engine, with a couple of newly added vulnerable functions to allow out of bounds read and write. I’ll use that with an XSS vulnerability in the website to get code execution and a shell. To privesc to user, I’ll use a heap exploit in a SUID binary. The binary was very limiting on the way I could interact with the heap, which lead to my having to re-write my exploit from scratch several times. From user, I’ll escalate again by attacking a kernel module that created a vulnerable device. I’ll leak the kernel memory to get past KASLR, and use some common kernel exploit techniques to execute a ROP chain and return a root shell. In Beyond Root, I’ll look at the unintended method used to get first blood on this box.</p>

</li>
        












          <li class="post-list-li"><span class="post-meta">Jan 12, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/holidayhack2020/">
                Holiday Hack 2020: &#39;Zat You, Santa Claus? featuring KringleCon 3: French Hens
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#sans-holiday-hack " class="post-tag">sans-holiday-hack</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hh20-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hh20-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:180px;" class="include_image " />
</picture>

<p>The 2020 SANS Holiday Hack Challenge was less of a challenge to figure out who did it, and more picking apart how Jack Frost managed to hack Santa’s processes. This all takes place at the third annual Kringle Con, where the worlds leading security practitioners show up for talks and challenges. Hosted at back at a currently-being-renovated North Pole, this years conference included <a href="https://www.youtube.com/playlist?list=PLjLd1hNA7YVwqXqaBJfbXqkFb7LKw3r31">13 talks from leaders in information security</a>, as well as 12 terminals / in-game puzzles and 11 objectives to solve. In solving all of these, the Jack Frost’s plot was foiled. As usual, the challenges were interesting and set up in such a way that it was very beginner friendly, with lots of hints and talks to ensure that you learned something while solving.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 9, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2021/01/09/htb-omni.html">
                HTB: Omni
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-omni " class="post-tag">htb-omni</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#windows-iot-core " class="post-tag">windows-iot-core</a> <a href="/tags#sirep " class="post-tag">sirep</a> <a href="/tags#sireprat " class="post-tag">sireprat</a> <a href="/tags#powershell-credential " class="post-tag">powershell-credential</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#penglab " class="post-tag">penglab</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#windows-device-portal " class="post-tag">windows-device-portal</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/omni-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/omni-cover.png" alt="Omni" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Omni looks like a normal Windows host at first, but it’s actually Windows IOT Core, the flavor of Windows that will run on a Raspberry Pi. I’ll abuse Sirep protocol to get code execution as SYSTEM. From there, I’ll get access as both the app user and as administrator to decrypt the flags in each of their home directories. I’ll show multiple ways to get the user’s credentials.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 1, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2020/leet">
                Hackvent 2020 - leet(ish)
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#polyglot " class="post-tag">polyglot</a> <a href="/tags#binwalk " class="post-tag">binwalk</a> <a href="/tags#jsnice " class="post-tag">jsnice</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#chef " class="post-tag">chef</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#docker-tar " class="post-tag">docker-tar</a> <a href="/tags#steghide " class="post-tag">steghide</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#cve-2020-9484 " class="post-tag">cve-2020-9484</a> <a href="/tags#ysoserial " class="post-tag">ysoserial</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#elf " class="post-tag">elf</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#lru-cache " class="post-tag">lru-cache</a> <a href="/tags#ios " class="post-tag">ios</a> <a href="/tags#itunes " class="post-tag">itunes</a> <a href="/tags#itunes-backup2hashcat " class="post-tag">itunes-backup2hashcat</a> <a href="/tags#fonepaw " class="post-tag">fonepaw</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#rsactftool " class="post-tag">rsactftool</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#pcap " class="post-tag">pcap</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackvent2020-leet-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackvent2020-leet-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:150px;" class="include_image " />
</picture>

<p>The leet challenges started on day 20, but then followed an additional three hard challenges before the second and final leet one. These were all really good challenges. My favorite was a binary and a PCAP of an attacker exploiting the binary, where I needed to reverse the crypto operations in the binary and the exploit to recover the data that was stolen. I really liked one that was another polyglot file where an image turned into an HTML page that dropped a Python script which pull out a docker image containing images that contained a flag. There was also more web exploitation of a Tomcat deserialization CVE, a really interesting ELF reversing challenge, and pulling data from an iOS backup.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 1, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2020/hard">
                Hackvent 2020 - Hard
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#xls " class="post-tag">xls</a> <a href="/tags#excel " class="post-tag">excel</a> <a href="/tags#forensic " class="post-tag">forensic</a> <a href="/tags#cbc " class="post-tag">cbc</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#gimp " class="post-tag">gimp</a> <a href="/tags#polyglot " class="post-tag">polyglot</a> <a href="/tags#mbr " class="post-tag">mbr</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#bochs " class="post-tag">bochs</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#rubiks " class="post-tag">rubiks</a> <a href="/tags#stl " class="post-tag">stl</a> <a href="/tags#rubik-cube " class="post-tag">rubik-cube</a> <a href="/tags#ja3 " class="post-tag">ja3</a> <a href="/tags#go " class="post-tag">go</a> <a href="/tags#ja3transport " class="post-tag">ja3transport</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#ecryptfs " class="post-tag">ecryptfs</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#ecryptfs2john " class="post-tag">ecryptfs2john</a> <a href="/tags#pyyaml " class="post-tag">pyyaml</a> <a href="/tags#yaml-deserialization " class="post-tag">yaml-deserialization</a> <a href="/tags#binwalk " class="post-tag">binwalk</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackvent2020-hard-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackvent2020-hard-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:150px;" class="include_image " />
</picture>

<p>The first seven hard challenges included my favorite challenge of the year, Santa’s Special GIFt, where the given file is both a GIF image and a master boot record. Handing it as such allowed me to reverse the code and emulate it to get two flags. There’s another challenge that looks at the failures of CBC on encrypting an raw bitmap image, three web exploitation challenges exploiting command injection, JA3 impresonation, and Python YAML deserialization, and another Rubik’s cube to solve.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 1, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2020/medium">
                Hackvent 2020 - Medium
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#rubiks " class="post-tag">rubiks</a> <a href="/tags#py222 " class="post-tag">py222</a> <a href="/tags#python-pil " class="post-tag">python-pil</a> <a href="/tags#scrambles " class="post-tag">scrambles</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#perl " class="post-tag">perl</a> <a href="/tags#obfuscation " class="post-tag">obfuscation</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#jinja2 " class="post-tag">jinja2</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#werkzeug-debug " class="post-tag">werkzeug-debug</a> <a href="/tags#colb " class="post-tag">colb</a> <a href="/tags#networkx " class="post-tag">networkx</a> <a href="/tags#graphs " class="post-tag">graphs</a> <a href="/tags#cliques " class="post-tag">cliques</a> <a href="/tags#mobilefish " class="post-tag">mobilefish</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#wiener " class="post-tag">wiener</a> <a href="/tags#mpz " class="post-tag">mpz</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackvent2020-medium-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackvent2020-medium-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:150px;" class="include_image " />
</picture>

<p>Medium continues with another seven challenges over seven days. There’s a really good crypto challenge involving recovering RSA parameters recovered from a PCAP file and submitted to a Wiener attack, web hacking through an server-side template injection, dotNet reversing, a Rubik’s cube challenge, and what is becoming the annual obfuscated Perl game.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 1, 2021</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2020/easy">
                Hackvent 2020 - Easy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#encoding " class="post-tag">encoding</a> <a href="/tags#gimp " class="post-tag">gimp</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#stegsolve " class="post-tag">stegsolve</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#known-plaintext " class="post-tag">known-plaintext</a> <a href="/tags#bkcrack " class="post-tag">bkcrack</a> <a href="/tags#binwalk " class="post-tag">binwalk</a> <a href="/tags#steghide " class="post-tag">steghide</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackvent2020-easy-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackvent2020-easy-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:150px;" class="include_image " />
</picture>

<p>Hackvent started out early with a -1 day released on 29 November. There were seven easy challenges, including -1, one hidden, and five daily challenges. These challenges were heavy in crypto, image editing / steg, and encoding. My favorite in the group was Chinese Animals, where I spent way more figuring out what was going on after solving than actually solving.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 26, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/25">
                Advent of Code 2020: Day 25
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#modular-arithmetic " class="post-tag">modular-arithmetic</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-25-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-25-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 25 is an encryption problem using modular arithmetic. I’ve given two public keys, both of which are of the form 7<sup>d</sup> mod 20201227 where d is unknown. The challenge is to find each d.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 24, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/24">
                Advent of Code 2020: Day 24
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-24-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-24-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The twist on day 24 is that it takes place on a grid of hexagons, so each tile has six neighbors, and a normal x,y or r,c coordinate system will be very difficult to use. I’ll use an x, y, z coordinate system to flip tiles based on some input and then watch it evolve based on it’s neighbors.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 23, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/23">
                Advent of Code 2020: Day 23
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-23-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-23-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Today is another game. This time I’m given a list of numbers and asked to mix it according to some given rules a certain number of times. Today is also the first time this year where I wrote part one, and then completely started over given part two.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 22, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/22">
                Advent of Code 2020: Day 22
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-22-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-22-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>I’m asked to play out a game between two players that in part one looks like the classic card game of war, and in part two goes off in a different direction of “recursive combat”. Both parts came together pretty quickly, though part two had a few places where small mistakes made identifying mistakes difficult.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 22, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/21">
                Advent of Code 2020: Day 21
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-21-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-21-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 21 was welcome relief after day 20. In this one, I’ll parse a list of foods, each with an ingredients list and a listing of some (not necessarily all) of the allergies. I’ll use that list to pair up allergens to ingredients.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 22, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/20">
                Advent of Code 2020: Day 20
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-20-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-20-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 20 was almost the end of my 2020 Advent of Code. I managed to solve part one in 15 minutes, but then part two got me for days. I finally solved it, but I can’t promise pretty code.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 19, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/19">
                Advent of Code 2020: Day 19
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-19-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-19-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Another day with a section of convoluted validation rules and a series of items to be validated. Today’s rules apply to a string, and I’ll actually use a recursive algorithm to generate a single regex string that can then be applied to each input to check validity. It gets slightly more difficult in the second part, where loops are introduced into the rules. In order to work around this, I’ll guess at a depth at which I can start to ignore further loops.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 19, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/12/19/htb-laser.html">
                HTB: Laser
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-laser " class="post-tag">htb-laser</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#jetdirect " class="post-tag">jetdirect</a> <a href="/tags#pret " class="post-tag">pret</a> <a href="/tags#printer " class="post-tag">printer</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#proto3 " class="post-tag">proto3</a> <a href="/tags#grpc " class="post-tag">grpc</a> <a href="/tags#solr " class="post-tag">solr</a> <a href="/tags#cve-2019-17558 " class="post-tag">cve-2019-17558</a> <a href="/tags#gopher " class="post-tag">gopher</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#sshpass " class="post-tag">sshpass</a> <a href="/tags#socat " class="post-tag">socat</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#htb-playertwo " class="post-tag">htb-playertwo</a> <a href="/tags#htb-travel " class="post-tag">htb-travel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/laser-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/laser-cover.png" alt="Laser" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Laser starts without the typical attack paths, offering only SSH and two unusual ports. One of those is a printer, which gives the opportunity to leak data including a print job and the memory with the encryption key for that job. The PDF gives details of how the second port works, using protocol buffers over gRPC. I’ll use this spec to write my own client, and use that to build a port scanner and scan the box for other open ports on localhost. When I find Apache Solr, I’ll use create another exploit to go through the gRPC service and send a POST request using Gopher to exploit Solr and get code execution and a shell. To escalate to root, I’ll collect SSH credentials for the root user in a container, and then use socat to redirect a cron SCP and SSH job back at the host box and exploit that to get code execution and root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 18, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/18">
                Advent of Code 2020: Day 18
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-18-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-18-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 18 is reimplementing a simple math system with addition, multiplication, and parentheses, where the order of operations changes. I’ll write a single calc function that takes in the string to evaluate as well as the order of operations to apply.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 17, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/17">
                Advent of Code 2020: Day 17
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#conway " class="post-tag">conway</a> <a href="/tags#game-of-life " class="post-tag">game-of-life</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-17-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-17-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 17 was a modified version of Conway’s Game of Life, played across three and four dimensions, where a cells state in the next time step is determined by the its current state and the state of its neighbors.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 16, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/16">
                Advent of Code 2020: Day 16
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-16-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-16-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 16 was an interesting one to think about, as the algorithm for solving it wasn’t obvious. It wasn’t the case like some of the previous ones where there was an intuitive way to think about it but it would take too long. It was more a case of wrapping your head around the problem and how to organize the data so that you could match keys to values using validity rules and a bunch of examples. I made a guess that the data might clean up nicely in a certain way, and when it did, it made the second part much easier.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 15, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/15">
                Advent of Code 2020: Day 15
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#defaultdict " class="post-tag">defaultdict</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-15-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-15-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 15 is a game the elves play, where you have to remember the numbers said in a list, and append the next number based on when it was previously said. I’ll solve by storing the numbers not in a list and searching it each time, but rather in a dictionary of lists, where the key is the number and the value is a list of indexes. It still runs a bit slow in part two, but it works.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 14, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/14">
                Advent of Code 2020: Day 14
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-14-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-14-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Part one of day 14 looked to be some basic binary masking and manipulation. But in part two, it got trickier, as now I need to handle Xs in the mask as both 0 and 1, meaning that there would be 2<sup>num X</sup> results. I used a recursive function to generate the list of indexes there.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 13, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/13">
                Advent of Code 2020: Day 13
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#chinese-remainder-theorem " class="post-tag">chinese-remainder-theorem</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-13-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-13-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 13 is looking at a series of buses that are running on their own time cycles, and trying to find times where the buses arrive in certain patterns. It brings in a somewhat obscure number theory concept called the Chinese Remainder Theorem, which has to do with solving a series of modular linear equations that all equal the same value.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 12, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/12/12/htb-openkeys.html">
                HTB: OpenKeyS
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-openkeys " class="post-tag">htb-openkeys</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vim " class="post-tag">vim</a> <a href="/tags#bsd " class="post-tag">bsd</a> <a href="/tags#openbsd " class="post-tag">openbsd</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#auth-userokay " class="post-tag">auth-userokay</a> <a href="/tags#cve-2019-19521 " class="post-tag">cve-2019-19521</a> <a href="/tags#cve-2019-19520 " class="post-tag">cve-2019-19520</a> <a href="/tags#cve-2019-19522 " class="post-tag">cve-2019-19522</a> <a href="/tags#shared-object " class="post-tag">shared-object</a> <a href="/tags#skey " class="post-tag">skey</a> <a href="/tags#cve-2020-7247 " class="post-tag">cve-2020-7247</a> <a href="/tags#htb-onetwoseven " class="post-tag">htb-onetwoseven</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/openkeys-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/openkeys-cover.png" alt="OpenKeyS" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>OpenKeyS was all about a series of OpenBSD vulnerabilities published by Qualys in December 2019. I’ll enumerate a web page to find a vim swap file that provides some hints about how the login form is doing auth. I’ll use that to construct an attack that allows me to bypass the authentication and login as Jennifer, retrieving Jennifer’s SSH key. To root, I’ll exploit two more vulnerabilities, first to get access to the auth group using a shared library attack on xlock, and then abusing S/Key authentication. In Beyond Root, I’ll look at another OpenBSD vulnerability that was made public just after the box was released, and play with PHP and the $_REQUEST variable.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 12, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/12">
                Advent of Code 2020: Day 12
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-12-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-12-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 12 is about moving a ship across a coordinate plane using directions and a way point that moves and rotates around the ship. There’s a bit of geometry, and I made a really dumb mistake that took me a long time to figure out.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 11, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/11">
                Advent of Code 2020: Day 11
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-11-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-11-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 11 is grid-based challenge, where I’m giving a grid floor, empty seat, and occupied seat, and asked to step through time using rules that define how a seat will be occupied at time t+1 given the state of it and it’s neighbors at time t. My code gets really ugly today, but it solves.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 10, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/10">
                Advent of Code 2020: Day 10
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#lru-cache " class="post-tag">lru-cache</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-10-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-10-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 10 is about looking at a list of numbers. In the first part I’ll just need to make a histogram of the differences between the numbers when sorted. For part two, it’s the first challenge this year where I’ll need to come up with an efficient algorithm to handle it. I’m asked to come up with the number of valid combinations according to some constraints. I’ll use recursion to solve it, and it only works in reasonable time with caching on that recursion.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 9, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/9">
                Advent of Code 2020: Day 9
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-9-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-9-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 9 is two challenges about looking across lists of ints to find pairs or slices with a given sum.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 8, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/8">
                Advent of Code 2020: Day 8
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-8-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-8-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Today I’m asked to build a small three instruction computer, and parse a series of instructions (puzzle input). I’m told that the instructions form an infinite loop, which is easy to identify in this simple computer any time an instruction is executed a second time. I’ll look at finding where that infinite loop is entered, as well as finding the one instruction that can be patched to fix the code. I’ll create a class for the computer with the thinking that I might be coming back to use it again and build on it later.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 7, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/7">
                Advent of Code 2020: Day 7
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#lru-cache " class="post-tag">lru-cache</a> <a href="/tags#defaultdict " class="post-tag">defaultdict</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-7-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-7-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 7 gives me a list of bags, and what bags must go into those bags. The two parts are based on looking for what can hold what and how many. I’ll use defaultdicts to manage the rules, and two recurrsive functions (including one that benefits from lru_cache) to solve the parts.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 6, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/6">
                Advent of Code 2020: Day 6
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-6-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-6-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 6 was another text parsing challenge, breaking the input into groups and then counting across the users within each group. Both parts were similar, with the first counting if any user said yes to a given question, and the latter if every user said yes to a given question. Python makes this a breeze either way.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 5, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/12/05/htb-unbalanced.html">
                HTB: Unbalanced
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-unbalanced " class="post-tag">htb-unbalanced</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#squid " class="post-tag">squid</a> <a href="/tags#http-proxy " class="post-tag">http-proxy</a> <a href="/tags#foxy-proxy " class="post-tag">foxy-proxy</a> <a href="/tags#rsync " class="post-tag">rsync</a> <a href="/tags#encfs " class="post-tag">encfs</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#squidclient " class="post-tag">squidclient</a> <a href="/tags#xpath-injection " class="post-tag">xpath-injection</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pihole " class="post-tag">pihole</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#htb-joker " class="post-tag">htb-joker</a> <a href="/tags#htb-zetta " class="post-tag">htb-zetta</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/unbalanced-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/unbalanced-cover.png" alt="Unbalanced" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Unbalanced starts with a Squid proxy and RSync. I’ll use RSync to pull back the files that underpin an Encrypted Filesystem (EncFS) instance, and crack the password to gain access to the backup config files. In those files I’ll find the Squid config, which includes the internal site names, as well as the creds to manage the Squid. Looking at the proxy stats, I can find two internal IPs, and guess the existence of a third, which is currently out of order for security fixes. In the site on the third IP, I’ll find XPath injection allowing me to leak a bunch of usernames and passwords, one of which provides SSH access to the host. I’ll exploit into a Pi-Hole container using an exploit to upload a webshell, and find a script which contains the root creds for the host. In Beyond Root, I’ll look at why the searchsploit version of the PiHole exploit didn’t work.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 5, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/5">
                Advent of Code 2020: Day 5
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-5-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-5-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 5 is wrapped in a story about plane ticket seat finding, but really it boils down to a simple binary to integer conversion, and then finding the difference of two sets and cleaning up what’s left based on some simple rules.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 4, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/4">
                Advent of Code 2020: Day 4
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#regex " class="post-tag">regex</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-4-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-4-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Day 4 presented another text parsing challenge. In the first part, I just needed to validate if each section contained a specific seven strings, which is easy enough to solve in Python. For part two, I need to now look at the text following each of these strings, and apply some validation rules. At first I thought I’d throw out my part 1 work and start processing all the data into a Python dict. But then I realized I could just write a regex for each validation, and use the same pattern.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 3, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/3">
                Advent of Code 2020: Day 3
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-3-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-3-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Advent of code always dives into visual mapping in a way that makes you conceptualize 2D (or 3D) space and move through it. I’ve got a map that represents a slope with clear spaces and trees, and that repeats moving to the right. As this is an early challenge, it’s still relatively simple to handle the map with just an array of strings, which I’ll do to count the trees I encounter on different trajectories moving across the map.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 2, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/2">
                Advent of Code 2020: Day 2
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-2-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-2-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;" class="include_image " />
</picture>

<p>Day 2 was about processing lines that contained two numbers, a character, and a string which is referred to as a password. Both parts are about using the numbers and the character to determine if the password is “valid”. How the numbers and character become a rule is different in parts 1 and 2.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2020/1">
                Advent of Code 2020: Day 1
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2020-1-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2020-1-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;" class="include_image " />
</picture>

<p>Advent of Code is a CTF put on by Google every December, providing coding challenges, and it’s a favorite of mine to practice. There are 25 days to collect 50 stars. For Day 1, the puzzle was basically reading a list of numbers, and looking through them for a pair and a set of three that summed to 2020. For each part, I’ll multiple the identified numbers together to get the solution.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 28, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/11/28/htb-sneakymailer.html">
                HTB: SneakyMailer
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-sneakymailer " class="post-tag">htb-sneakymailer</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#swaks " class="post-tag">swaks</a> <a href="/tags#htb-xen " class="post-tag">htb-xen</a> <a href="/tags#imap " class="post-tag">imap</a> <a href="/tags#smtp " class="post-tag">smtp</a> <a href="/tags#evolution " class="post-tag">evolution</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#pypi " class="post-tag">pypi</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#htpasswd " class="post-tag">htpasswd</a> <a href="/tags#setup-py " class="post-tag">setup-py</a> <a href="/tags#htb-chaos " class="post-tag">htb-chaos</a> <a href="/tags#htb-canape " class="post-tag">htb-canape</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#pip " class="post-tag">pip</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sneakymailer-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sneakymailer-cover.png" alt="SneakyMailer" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>SneakyMailer starts with web enumeration to find a list of email addresses, which I can use along with SMTP access to send phishing emails. One of the users will click on the link, and return a POST request with their login creds. That provides access to the IMAP inbox for that user, where I’ll find creds for FTP. The FTP access is in the web directory, and while there’s nothing interesting there, I can write a webshell and get execution, and a shell. To privesc, I’ll submit a malicious Python package to the local PyPi server, which provides execution and a shell as that user. For root, I’ll abuse a sudo rule to run pip, installing the same package again. In Beyond Root, I’ll look at the automation on the box running as services.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 21, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/11/21/htb-buff.html">
                HTB: Buff
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-buff " class="post-tag">htb-buff</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#gym-management-system " class="post-tag">gym-management-system</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#cloudme " class="post-tag">cloudme</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#defender " class="post-tag">defender</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/buff-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/buff-cover.png" alt="Buff" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Buff is a really good OSCP-style box, where I’ll have to identify a web software running on the site, and exploit it using a public exploit to get execution through a webshell. To privesc, I’ll find another service I can exploit using a public exploit. I’ll update with my own shellcode to make a reverse shell, and set up a tunnel so that I can connect to the service that listens only on localhost. From there, the exploit script returns an administrator shell. In Beyond Root, I’ll step through the first script and perform the exploit manually, and look at how Defender was blocking some of my attempts.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 14, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/11/14/htb-intense.html">
                HTB: Intense
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-intense " class="post-tag">htb-intense</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#penglab " class="post-tag">penglab</a> <a href="/tags#cookies " class="post-tag">cookies</a> <a href="/tags#hash-extension " class="post-tag">hash-extension</a> <a href="/tags#hash-extender " class="post-tag">hash-extender</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#snmp-shell " class="post-tag">snmp-shell</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#logic-error " class="post-tag">logic-error</a> <a href="/tags#htb-rope " class="post-tag">htb-rope</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#peda " class="post-tag">peda</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/intense-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/intense-cover.png" alt="Intense" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Intense presented some cool challenges. I’ll start by finding a SQL injection vulnerability into an SQLlite database. I’m able to leak the admin hash, but not crack it. Using the source code for the site, I’ll see that if I can use a hash extension attack, I can use the hash trick the site into providing admin access. From there, I’ll use a directory traversal bug in a log reading API to find SNMP read/write creds, which I’ll use to get a shell with snmp-shell. I can use that to find a custom binary listening on localhost, as well as it’s source code. I’ll use the snmp account to create an SSH tunnel, and exploit a logic bug in the code to overflow the buffer, bypass protections, and get a shell as root. In Beyond Root, I’ll look at why I didn’t have success with the system libc call in my ROP, figure out why, and fix it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 7, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/11/07/htb-tabby.html">
                HTB: Tabby
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-tabby " class="post-tag">htb-tabby</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#host-manager " class="post-tag">host-manager</a> <a href="/tags#tomcat-manager " class="post-tag">tomcat-manager</a> <a href="/tags#war " class="post-tag">war</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#zip2john " class="post-tag">zip2john</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#penglab " class="post-tag">penglab</a> <a href="/tags#lxc " class="post-tag">lxc</a> <a href="/tags#lxd " class="post-tag">lxd</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#htb-jerry " class="post-tag">htb-jerry</a> <a href="/tags#htb-teacher " class="post-tag">htb-teacher</a> <a href="/tags#htb-popcorn " class="post-tag">htb-popcorn</a> <a href="/tags#htb-lightweight " class="post-tag">htb-lightweight</a> <a href="/tags#htb-sunday " class="post-tag">htb-sunday</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-mischief " class="post-tag">htb-mischief</a> <a href="/tags#htb-obscurity " class="post-tag">htb-obscurity</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/tabby-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/tabby-cover.png" alt="Tabby" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Tabby was a well designed easy level box that required finding a local file include (LFI) in a website to leak the credentials for the Tomcat server on that same host. The user who’s creds I gain access to only has access to the command line manager API, not the GUI, but I can use that to upload a WAR file, get execution, and a shell. I’ll crack the password on a backup zip archive and then use that same password to change to the next user. That user is a member of the lxd group, which allows them to start containers. I’ve shown this root before, but this time I’ll include a really neat trick from m0noc that saves several steps. In Beyond Root, I’ll pull apart the WAR file and show what’s actually in it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 2, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/break">
                Flare-On 2020: break
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-break " class="post-tag">flare-on-break</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#ptrace " class="post-tag">ptrace</a> <a href="/tags#hook " class="post-tag">hook</a> <a href="/tags#ldpreload " class="post-tag">ldpreload</a> <a href="/tags#pre-main " class="post-tag">pre-main</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#feistel-cipher " class="post-tag">feistel-cipher</a> <a href="/tags#unpack " class="post-tag">unpack</a> <a href="/tags#modinv " class="post-tag">modinv</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#htb-mischief " class="post-tag">htb-mischief</a> <a href="/tags#htb-obscurity " class="post-tag">htb-obscurity</a> <a href="/tags#htb-teacher " class="post-tag">htb-teacher</a> <a href="/tags#htb-popcorn " class="post-tag">htb-popcorn</a> <a href="/tags#htb-lightweight " class="post-tag">htb-lightweight</a> <a href="/tags#htb-sunday " class="post-tag">htb-sunday</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-break-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-break-cover.png" alt="break" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>break was an amazing challenge. Just looking at main, it looks like a simple comparison against a static flag. But there’s an init function that runs first, forking a child process that then attaches a debugger to the parent, hooking all of it’s system calls and crashes. The child itself forks a second child, which attaches to the first child, handling several intentional crash points in the first child’s code. The effectively prevents my debugging the parent for first child, as only one debugger can attach at a time. I’ll use two different approaches - hooking library calls and patching the second child’s functionality directly into the first child, allowing me to debug the first child. Using these techniques, I’ll wind through three parts of the flag, each successively more difficult to break out.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/crackinstaller">
                Flare-On 2020: crackinstaller
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-crackinstaller " class="post-tag">flare-on-crackinstaller</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#capcom-sys " class="post-tag">capcom-sys</a> <a href="/tags#driver " class="post-tag">driver</a> <a href="/tags#kernel-debug " class="post-tag">kernel-debug</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-crackinstaller-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-crackinstaller-cover.png" alt="crackinstaller" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>crackinstaller.exe was a complicated binary that installed the Capcom.sys driver, and then exploited it to load another driver into memory. It also dropped and installed another DLL, a credential helper. I used kernel debugging to see how the second driver is loaded, and eventually find a password, which I can feed into the credential helper to get the flag. I spent over two of the six weeks working crackinstaller.exe, and unfortunately, I stopped taking meaningful notes very early in that process, so this won’t be much of a writeup, but rather a high level overview.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/aardvark">
                Flare-On 2020: Aardvark
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-aardvark " class="post-tag">flare-on-aardvark</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#wsl " class="post-tag">wsl</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#resource-hacker " class="post-tag">resource-hacker</a> <a href="/tags#process-hacker " class="post-tag">process-hacker</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#peda " class="post-tag">peda</a> <a href="/tags#pwndbg " class="post-tag">pwndbg</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-aardvark-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-aardvark-cover.png" alt="aardvark" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Aardvark was a game of tik-tac-toe where the computer always goes first, and can’t lose. Instead of having the decision logic of the computer in the program, it drops an ELF binary to act as the computer, and communicates with it over a unix socket, all of which is possible on Windows with the Windows Subsystem for Linux (WSL). Once I understand how the computer is playing, I’ll modify the computers logic so that I can win, and get the flag. I’ll play with different ways to patch the binary, starting manually with gdb, and moving to patching the ELF resource a couple different ways.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 31, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/10/31/htb-fuse.html">
                HTB: Fuse
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-fuse " class="post-tag">htb-fuse</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#rpc " class="post-tag">rpc</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#rpcclient " class="post-tag">rpcclient</a> <a href="/tags#papercut " class="post-tag">papercut</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#cewl " class="post-tag">cewl</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#smbpasswd " class="post-tag">smbpasswd</a> <a href="/tags#rpcclient " class="post-tag">rpcclient</a> <a href="/tags#capcom-sys " class="post-tag">capcom-sys</a> <a href="/tags#driver " class="post-tag">driver</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#eoploaddriver " class="post-tag">eoploaddriver</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#scheduled-task " class="post-tag">scheduled-task</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/fuse-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/fuse-cover.png" alt="Fuse" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Fuse was all about pulling information out of a printer admin page. I’ll collect usernames and use cewl to make a wordlist, which happens to find the password for a couple accounts. I’ll need to change the password on the account to use it, and then I can get RPC access, where I’ll find more creds in the comments. I can use those creds for WinRM access, where I’ll find myself with privileges to load a driver. I’ll use the popular Capcom.sys driver to load a payload that returns a shell as system. In Beyond Root, I’ll look at the scheduled tasks that are managing the users passwords and trying to uninstall drivers put in place by HTB players.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 30, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/recrowd">
                Flare-On 2020: RE Crowd
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-re-crowd " class="post-tag">flare-on-re-crowd</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#pcap " class="post-tag">pcap</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#tshark " class="post-tag">tshark</a> <a href="/tags#cve-2017-7269 " class="post-tag">cve-2017-7269</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> <a href="/tags#scdbg " class="post-tag">scdbg</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#cff-explorer " class="post-tag">cff-explorer</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#procmon " class="post-tag">procmon</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-recrowd-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-recrowd-cover.png" alt="recrowd" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>RE Crowd was a different kind of reversing challenge. I’m given a PCAP that includes someone trying to exploit an IIS webserver using CVE-2017-7269. This exploit uses alphanumeric shellcode to run on success. I’ll pull the shellcode and analyze it, seeing that it’s a Metasploit loader that connects to a host and then the host sends back an encrypted blob. The host then sends another encrypted blob back to the attcker. I’ll use what I can learn about the attacker’s commands to decrypt that exfil and find the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 29, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/codeit">
                Flare-On 2020: CodeIt
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-codeit " class="post-tag">flare-on-codeit</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#autoit " class="post-tag">autoit</a> <a href="/tags#exe2aut " class="post-tag">exe2aut</a> <a href="/tags#upx " class="post-tag">upx</a> <a href="/tags#myauttoexe " class="post-tag">myauttoexe</a> <a href="/tags#script-obfuscation " class="post-tag">script-obfuscation</a> <a href="/tags#crypto " class="post-tag">crypto</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-codeit-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-codeit-cover.png" alt="codeit" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The sixth Flare-On7 challenge was tricky in a way that’s hard to put on the page. It really was just a AutoIt script wrapped in a Windows exe. I’ll use a tool to revert it back to a large, obfuscated script, and then get to work deobfuscating it. Eventually I’ll see that it is looking for a specific hostname, and on switching my hostname to match, I get a QRcode that contains the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 28, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/tkapp">
                Flare-On 2020: TKApp
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-tkapp " class="post-tag">flare-on-tkapp</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#tizen " class="post-tag">tizen</a> <a href="/tags#tpk " class="post-tag">tpk</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#emulation " class="post-tag">emulation</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-tkapp-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-tkapp-cover.png" alt="tkapp" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>TKApp was a Tizen mobile application that was made to run on a smart watch. Inside the archive, there’s a .NET dll that drives the application, so I can break it open with dnSpy. Four variables are initialized through different user actions or different aspects of the files on the watch, and then used to generate a key to decrypt a buffer. I’ll show both static analysis to pull the keys and then decrypt in Python, as well as how to emulate a watch and then go through the steps to get it to display the flag in the gallery.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 27, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/report">
                Flare-On 2020: report.xls
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-report " class="post-tag">flare-on-report</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#xls " class="post-tag">xls</a> <a href="/tags#vba " class="post-tag">vba</a> <a href="/tags#olevba " class="post-tag">olevba</a> <a href="/tags#evil-clippy " class="post-tag">evil-clippy</a> <a href="/tags#pcode " class="post-tag">pcode</a> <a href="/tags#vba-stomp " class="post-tag">vba-stomp</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pcodedmp " class="post-tag">pcodedmp</a> <a href="/tags#pcode2code " class="post-tag">pcode2code</a> <a href="/tags#script-obfuscation " class="post-tag">script-obfuscation</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-report-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-report-cover.png" alt="report" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>report.xls was my kind of challenge. It’s an Excel book with an macro with some relatively standard obfuscation and sandbox evasion. In analyzing the VBA, I see more and more hints that something odd is going on. Eventually I’ll extract an mp3 file with several more hints that the VBA has been stomped, replacing the p-code with something different from the VBA. When I dump the p-code and analyze it, I’ll find an image with the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 26, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/wednesday">
                Flare-On 2020: wednesday
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-wednesday " class="post-tag">flare-on-wednesday</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#nimlang " class="post-tag">nimlang</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#patching " class="post-tag">patching</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-wednesday-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-wednesday-cover.png" alt="wednesday" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>wednesday was a game that involved getting my dude to the end jumping over and going under blocks. The game was written in Nim lang, and had a lot of complex functions to manage the game. It was a long way to go, so I patched it to just let me run through blocks and not worry about under vs over.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 26, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/garbage">
                Flare-On 2020: garbage
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-garbage " class="post-tag">flare-on-garbage</a> <a href="/tags#upx " class="post-tag">upx</a> <a href="/tags#pe " class="post-tag">pe</a> <a href="/tags#cff-explorer " class="post-tag">cff-explorer</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#resource-hacker " class="post-tag">resource-hacker</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-garbage-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-garbage-cover.png" alt="garbage" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>garbage was all about understanding the structure of an exe file, and how to repair it when the last few hundred bytes were truncated. I’ll troubleshoot the binary and eventually get it working to the point that I can unpack it, do static analysis, and get the flag. I’ll also show how to fix the binary so that it will just run and print the flag in a message box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 26, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2020/fidler">
                Flare-On 2020: Fidler
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-fidler " class="post-tag">flare-on-fidler</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pygame " class="post-tag">pygame</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2020-fidler-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2020-fidler-cover.png" alt="garbage" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Flare-On 7 got off to an easy start with a Windows executable that was generated with PyGame, and included the Python source. That made this challenge more of a Python source code analysis exercise than a reversing challenge. I’ll find the password and the win conditions in the source, and win both by decrypting the flag and by modifying the source.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 24, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/10/24/htb-dyplesher.html">
                HTB: Dyplesher
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-dyplesher " class="post-tag">htb-dyplesher</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#memcached " class="post-tag">memcached</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#gogs " class="post-tag">gogs</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#gitdumper " class="post-tag">gitdumper</a> <a href="/tags#memcached-binary " class="post-tag">memcached-binary</a> <a href="/tags#memcached-auth " class="post-tag">memcached-auth</a> <a href="/tags#memcached-cli " class="post-tag">memcached-cli</a> <a href="/tags#memcat " class="post-tag">memcat</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#git-bundle " class="post-tag">git-bundle</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#bukkit " class="post-tag">bukkit</a> <a href="/tags#minecraft " class="post-tag">minecraft</a> <a href="/tags#spigot " class="post-tag">spigot</a> <a href="/tags#intellij " class="post-tag">intellij</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#jar " class="post-tag">jar</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#packet-capture " class="post-tag">packet-capture</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#cuberite " class="post-tag">cuberite</a> <a href="/tags#rabbitmq " class="post-tag">rabbitmq</a> <a href="/tags#amqp-publish " class="post-tag">amqp-publish</a> <a href="/tags#lua " class="post-tag">lua</a> <a href="/tags#htb-canape " class="post-tag">htb-canape</a> <a href="/tags#htb-waldo " class="post-tag">htb-waldo</a> <a href="/tags#htb-dab " class="post-tag">htb-dab</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/dyplesher-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/dyplesher-cover.png" alt="Dyplesher" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Dyplesher pushed server modern technologies that are not common in CTFs I’ve done. Initial access requires finding a virtual host with a .git directory that allows me to find the credentials used for the memcache port. After learning about the binary memcache protocol that supports authentication, I’m able to connect and dump usernames and password from the cache, which provide access to a Gogs instance. In Gogs, I’ll find four git bundles (repo backups), one of which contains custom code with an SQLite db containing password hashes. One cracks, providing access to the web dashboard. In this dashboard, I’m able to upload and run Bukkit plugins. I’ll write a malicious one that successfully writes both a webshell and an SSH key, both of which provide access to the box as the same first user. This user has access to a dumpcap binary, which I’ll use to capture traffic finding Rabbit message queue traffic that contains the usernames and password for the next user. This user has instructions to send a url over the messaging queue, which will cause the box to download and run a cuberite plugin. I’ll figure out how to publish my host into the queue, and write a malicious Lua script that will provide root access. In Beyond Root, I’ll look more deeply at the binary memcache protocol.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 17, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/10/17/htb-blunder.html">
                HTB: Blunder
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-blunder " class="post-tag">htb-blunder</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#bludit " class="post-tag">bludit</a> <a href="/tags#cms " class="post-tag">cms</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#github " class="post-tag">github</a> <a href="/tags#cewl " class="post-tag">cewl</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#cve-2019-14287 " class="post-tag">cve-2019-14287</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htaccess " class="post-tag">htaccess</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/blunder-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/blunder-cover.png" alt="Blunder" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Blunder starts with a blog that I’ll find is hosted on the BludIt CMS. Some version enumeration and looking at releases on GitHub shows that this version is vulnerable to a bypass of the bruteforce protections, as well as an upload and execute filter bypass on the PHP site. I’ll write my own scripts for each of these, and use them to get a shell. From there, I’ll find creds for the next user, where I’ll find the first flag. Now I can also access sudo, where I’ll see I can run sudo to get a bash shell as any non-root user. I’ll exploit CVE-2019-14287 to run that as root, and get a root shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 10, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/10/10/htb-cache.html">
                HTB: Cache
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-cache " class="post-tag">htb-cache</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#openemr " class="post-tag">openemr</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#auth-bypass " class="post-tag">auth-bypass</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#memcached " class="post-tag">memcached</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#htb-dab " class="post-tag">htb-dab</a> <a href="/tags#htb-olympus " class="post-tag">htb-olympus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/cache-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/cache-cover.png" alt="Cache" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Cache rates medium based on number of steps, none of which are particularly challenging. There’s a fair amount of enumeration of a website, first, to find a silly login page that has hardcoded credentials that I’ll store for later, and then to find a new VHost that hosts a vulnerable OpenEMR system. I’ll exploit that system three ways, first to bypass authentication, which provides access to a page vulnerable to SQL-injection, which I’ll use to dump the hashes. After cracking the hash, I’ll exploit the third vulnerability with a script from ExploitDB which provides authenticated code execution. That RCE provides a shell. I’ll escalate to the next user reusing the creds from the hardcoded website. I’ll find creds for the next user in memcached. This user is in the docker group, which I’ll exploit to get root access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 3, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/10/03/htb-blackfield.html">
                HTB: Blackfield
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-blackfield " class="post-tag">htb-blackfield</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#as-rep-roast " class="post-tag">as-rep-roast</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#bloodhound-py " class="post-tag">bloodhound-py</a> <a href="/tags#rpc-password-reset " class="post-tag">rpc-password-reset</a> <a href="/tags#pypykatz " class="post-tag">pypykatz</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#sebackupprivilege " class="post-tag">sebackupprivilege</a> <a href="/tags#copy-filesepackupprivilege " class="post-tag">copy-filesepackupprivilege</a> <a href="/tags#efs " class="post-tag">efs</a> <a href="/tags#diskshadow " class="post-tag">diskshadow</a> <a href="/tags#ntds " class="post-tag">ntds</a> <a href="/tags#vss " class="post-tag">vss</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#icacls " class="post-tag">icacls</a> <a href="/tags#cipher " class="post-tag">cipher</a> <a href="/tags#windows-sessions " class="post-tag">windows-sessions</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#htb-forest " class="post-tag">htb-forest</a> <a href="/tags#htb-multimaster " class="post-tag">htb-multimaster</a> <a href="/tags#htb-re " class="post-tag">htb-re</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/blackfield-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/blackfield-cover.png" alt="Blackfield" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Blackfield was a beautiful Windows Activity directory box where I’ll get to exploit AS-REP-roasting, discover privileges with bloodhound from my remote host using BloodHound.py, and then reset another user’s password over RPC. With access to another share, I’ll find a bunch of process memory dumps, one of which is lsass.exe, which I’ll use to dump hashes with pypykatz. Finally with a hash that gets a WinRM shell, I’ll abuse backup privileges to read the ntds.dit file that contains all the hashes for the domain (as well as a copy of the SYSTEM reg hive). I’ll use those to dump the hashes, and get access as the administrator. In Beyond Root, I’ll look at the EFS that prevented my reading root.txt using backup privs, as well as go down a rabbit hole into Windows sessions and why the cipher command was returning weird results.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 26, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/09/26/htb-admirer.html">
                HTB: Admirer
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-admirer " class="post-tag">htb-admirer</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#robots-text " class="post-tag">robots-text</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#adminer " class="post-tag">adminer</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#pythonpath " class="post-tag">pythonpath</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#python-library-hijack " class="post-tag">python-library-hijack</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-nineveh " class="post-tag">htb-nineveh</a> <a href="/tags#htb-kryptos " class="post-tag">htb-kryptos</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/admirer-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/admirer-cover.png" alt="Admirer" style="float: right; margin-right:50px; margin-left:50px; height:160px;" class="include_image " />
</picture>

<p>Admirer provided a twist on abusing a web database interface, in that I don’t have creds to connect to any databases on Admirer, but I’ll instead connect to a database on myhost and use queries to get local file access to Admirer. Before getting there, I’ll do some web enumeration to find credentials for FTP which has some outdated source code that leads me to the Adminer web interface. From there, I can read the current source, and get a password which works for SSH access. To privesc, I’ll abuse sudo configured to allow me to pass in a PYTHONPATH, allowing a Python library hijack.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 19, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/09/19/htb-multimaster.html">
                HTB: Multimaster
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-multimaster " class="post-tag">htb-multimaster</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#unicode " class="post-tag">unicode</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#tamper " class="post-tag">tamper</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#rid " class="post-tag">rid</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#cef-debugging " class="post-tag">cef-debugging</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#amsi " class="post-tag">amsi</a> <a href="/tags#powersploit " class="post-tag">powersploit</a> <a href="/tags#as-rep-roast " class="post-tag">as-rep-roast</a> <a href="/tags#server-operators " class="post-tag">server-operators</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#service-hijack " class="post-tag">service-hijack</a> <a href="/tags#sebackupprivilege " class="post-tag">sebackupprivilege</a> <a href="/tags#serestoreprivilege " class="post-tag">serestoreprivilege</a> <a href="/tags#robocopy " class="post-tag">robocopy</a> <a href="/tags#cve-2020-1472 " class="post-tag">cve-2020-1472</a> <a href="/tags#zerologon " class="post-tag">zerologon</a> <a href="/tags#htb-forest " class="post-tag">htb-forest</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/multimaster-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/multimaster-cover.png" alt="Multimaster" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Multimaster was a lot of steps, some of which were quite difficult. I’ll start by identifying a SQL injection in a website. I’ll have to figure out the WAF and find a way past that, dumping credentials but also writing a script to use MSSQL to enumerate the domain users. To pivot to the second user, I’ll exploit an instance of Visual Studio Code that’s left an open CEF debugging socket open. That user has access to a DLL in the web directory, in which I’ll find more credentials to pivot to another user. This user has GenericWrite privileges on another user, so I’ll abuse that to get a shell. This final user is in the Server Operators group, allowing me to modify services to get a shell as SYSTEM. I’ll show two alternative roots, abusing the last user’s SeBackupPrivilege and SeRestorePrivilege with robotcopy to read the flag, and using ZeroLogon to go right to administrator in one step.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 17, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/09/17/zerologon-owning-htb-machines-with-cve-2020-1472.html">
                ZeroLogon - Owning HTB machines with CVE-2020-1472
              </a>
            </h3>

<span class="tag-list"><a href="/tags#cve-2020-1472 " class="post-tag">cve-2020-1472</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#domain-controller " class="post-tag">domain-controller</a> <a href="/tags#htb-monteverde " class="post-tag">htb-monteverde</a> <a href="/tags#zerologon " class="post-tag">zerologon</a> <a href="/tags#impacket " class="post-tag">impacket</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#virtualenv " class="post-tag">virtualenv</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/zero-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/zero-cover.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>CVE-2020-1472 was patched in August 2020 by Microsoft, but it didn’t really make a splash until the last week when proof of concept exploits started hitting GutHub. It truly is a short path to domain admin. I’ll look at the exploit and own some machines from HTB with it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 12, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/09/12/htb-travel.html">
                HTB: Travel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-travel " class="post-tag">htb-travel</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#awesome-rss " class="post-tag">awesome-rss</a> <a href="/tags#simplepie " class="post-tag">simplepie</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#gittools " class="post-tag">gittools</a> <a href="/tags#gitdumper " class="post-tag">gitdumper</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#memcached " class="post-tag">memcached</a> <a href="/tags#ssrf " class="post-tag">ssrf</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#gopher " class="post-tag">gopher</a> <a href="/tags#gopherus " class="post-tag">gopherus</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#database " class="post-tag">database</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#viminfo " class="post-tag">viminfo</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#authorizedkeyscommand " class="post-tag">authorizedkeyscommand</a> <a href="/tags#ldif " class="post-tag">ldif</a> <a href="/tags#ldapadd " class="post-tag">ldapadd</a> <a href="/tags#getent " class="post-tag">getent</a> <a href="/tags#htb-ypuffy " class="post-tag">htb-ypuffy</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/travel-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/travel-cover.png" alt="Travel" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Travel was just a great box because it provided a complex and challenging puzzle with new pieces that were fun to explore. I’ll start off digging through various vhosts until I eventually find an exposed .git folder on one. That provides me the source for another, which includes a custom RSS feed that’s cached using memcache. I’ll evaluate that code to find a deserialization vulnerability on the read from memcache. I’ll create an exploit using a server-side request forgery attack to poison the memcache with a serialized PHP payload that will write a webshell, and then trigger it, gaining execution and eventually a shell inside a container. I’ll find a hash in the database which I can crack to get a password for the user on the main host. This user is also the LDAP administrator, and SSH is configured to check LDAP for logins. I’ll pick an arbitrary user and add an SSH private key, password, and the sudo group to their LDAP such that then when I log in as that user, I can just sudo to root. In Beyond Root I’ll explore a weird behavior I observed in the RSS feed.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 10, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/09/10/htb-haircut.html">
                HTB: Haircut
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-haircut " class="post-tag">htb-haircut</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#parameter-injection " class="post-tag">parameter-injection</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#curl " class="post-tag">curl</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#screen " class="post-tag">screen</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/haircut-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/haircut-cover.png" alt="Haircut" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Haircut started with some web enumeration where I’ll find a PHP site invoking curl. I’ll use parameter injection to write a webshell to the server and get execution. I’ll also enumerate the filters and find a way to get command execution in the page itself. To jump to root, I’ll identify a vulnerable version of screen that is set SUID (which is normal). I’ll walk through this exploit. In Beyond Root, I’ll take a quick look at the filtering put in place in the PHP page.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 8, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/09/08/roguepotato-on-remote.html">
                RoguePotato on Remote
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-remote " class="post-tag">htb-remote</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#seimpersonate " class="post-tag">seimpersonate</a> <a href="/tags#roguepotato " class="post-tag">roguepotato</a> <a href="/tags#lonelypotato " class="post-tag">lonelypotato</a> <a href="/tags#juicypotato " class="post-tag">juicypotato</a> <a href="/tags#ippsec " class="post-tag">ippsec</a> <a href="/tags#socat " class="post-tag">socat</a> <a href="/tags#htb-re " class="post-tag">htb-re</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/roguepotato-remote-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/roguepotato-remote-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>JuicyPotato was a go-to exploit whenever I found myself with a Windows shell with SeImpersonatePrivilege, which typically was whenever there was some kind of webserver exploit. But Microsoft changed things in Server 2019 to brake JuicyPotato, so I was really excited when splinter_code and decoder came up with RoguePotato, a follow-on exploit that works around the protections put into place in Server 2019. When I originally solved Remote back in March, RoguePotato had not yet been released. I didn’t have time last week to add it to my Remote write-up, so I planned to do a follow up post to show it. While in the middle of this post, I also watched IppSec’s video where he tries to use RoguePotato on Remote in a way that worked but shouldn’t have, raising a real mystery. I’ll dig into that and show what happened as well.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 5, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/09/05/htb-remote.html">
                HTB: Remote
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-remote " class="post-tag">htb-remote</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#nfs " class="post-tag">nfs</a> <a href="/tags#umbraco " class="post-tag">umbraco</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#teamviewer " class="post-tag">teamviewer</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#evilwinrm " class="post-tag">evilwinrm</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/remote-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/remote-cover.png" alt="Remote" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>To own Remote, I’ll need to find a hash in a config file over NFS, crack the hash, and use it to exploit a Umbraco CMS system. From there, I’ll find TeamView Server running, and find where it stores credentials in the registry. After extracting the bytes, I’ll write a script to decrypt them providing the administrator user’s credentials, and a shell over WinRM or PSExec.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 3, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/09/03/htb-mantis.html">
                HTB: Mantis
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-mantis " class="post-tag">htb-mantis</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#rcpclient " class="post-tag">rcpclient</a> <a href="/tags#kerbrute " class="post-tag">kerbrute</a> <a href="/tags#orchard-cms " class="post-tag">orchard-cms</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#mssqlclient " class="post-tag">mssqlclient</a> <a href="/tags#dbeaver " class="post-tag">dbeaver</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#ms14-068 " class="post-tag">ms14-068</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#kinit " class="post-tag">kinit</a> <a href="/tags#golden-ticket " class="post-tag">golden-ticket</a> <a href="/tags#goldenpac " class="post-tag">goldenpac</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/mantis-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/mantis-cover.png" alt="Mantis" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Mantis was one of those Windows targets where it’s just a ton of enumeration until you get a System shell. The only exploit on the box was something I remember reading about years ago, where a low level user was allowed to make a privileged Kerberos ticket. To get there, I’ll have to avoid a few rabbit holes and eventually find creds for the SQL Server instance hidden on a webpage. The database has domain credentials for a user. I’ll use those to perform the attack, which will return SYSTEM access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 29, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/29/htb-quick.html">
                HTB: Quick
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-quick " class="post-tag">htb-quick</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#quic " class="post-tag">quic</a> <a href="/tags#http3 " class="post-tag">http3</a> <a href="/tags#curl " class="post-tag">curl</a> <a href="/tags#edgeside-include-injection " class="post-tag">edgeside-include-injection</a> <a href="/tags#esi " class="post-tag">esi</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#race-condition " class="post-tag">race-condition</a> <a href="/tags#cracking " class="post-tag">cracking</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#su " class="post-tag">su</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/quick-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/quick-cover.png" alt="Quick" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Quick was a chance to play with two technologies that I was familiar with, but I had never put hands on with either. First it was finding a website hosted over Quic / HTTP version 3. I’ll build curl so that I can access that, and find creds to get into a ticketing system. In that system, I will exploit an edge side include injection to get execution, and with a bit more work, a shell. Next I’ll exploit a new website available on localhost and take advantage of a race condition that allows me to read and write arbitrary files as the next user. Finally, to get root I’ll find creds in a cached config file. In Beyond Root, I’ll use a root shell to trouble-shoot my difficulties getting a shell and determine where things were breaking.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 27, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/27/htb-calamity.html">
                HTB: Calamity
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-calamity " class="post-tag">htb-calamity</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#scripting " class="post-tag">scripting</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#phpbash " class="post-tag">phpbash</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#audacity " class="post-tag">audacity</a> <a href="/tags#lxd " class="post-tag">lxd</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#peda " class="post-tag">peda</a> <a href="/tags#checksec " class="post-tag">checksec</a> <a href="/tags#nx " class="post-tag">nx</a> <a href="/tags#mprotect " class="post-tag">mprotect</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#ret2libc " class="post-tag">ret2libc</a> <a href="/tags#youtube " class="post-tag">youtube</a> <a href="/tags#htb-obscurity " class="post-tag">htb-obscurity</a> <a href="/tags#htb-frolic " class="post-tag">htb-frolic</a> <a href="/tags#htb-mischief " class="post-tag">htb-mischief</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/calamity-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/calamity-cover.png" alt="Calamity" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Calamity was released as Insane, but looking at the user ratings, it looked more like an easy/medium box. The user path to through the box was relatively easy. Some basic enumeration gives access to a page that will run arbitrary PHP, which provides execution and a shell. There’s an audio steg challenge to get the user password and a user shell. People likely rated the box because there was an unintended root using lxd. I’ve done that before, and won’t show it here. The intended path was a contrived but interesting pwn challenge that involved three stages of input, the first two exploiting a very short buffer overflow to get access to a longer buffer overflow and eventually a root shell. In Beyond Root, I’ll look at some more features of the source code for the final binary to figure out what some assembly did, and why a simple return to libc attack didn’t work.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 22, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/22/htb-magic.html">
                HTB: Magic
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-magic " class="post-tag">htb-magic</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#mysqldump " class="post-tag">mysqldump</a> <a href="/tags#su " class="post-tag">su</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#apache " class="post-tag">apache</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-networked " class="post-tag">htb-networked</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/magic-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/magic-cover.png" alt="Magic" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Magic has two common steps, a SQLI to bypass login, and a webshell upload with a double extension to bypass filtering. From there I can get a shell, and find creds in the database to switch to user. To get root, there’s a binary that calls popen without a full path, which makes it vulnerable to a path hijack attack. In Beyond Root, I’ll look at the Apache config that led to execution of a .php.png file, the PHP code that filtered uploads, and the source for the suid binary.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 15, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/15/htb-traceback.html">
                HTB: Traceback
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-traceback " class="post-tag">htb-traceback</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#vim " class="post-tag">vim</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#smevk " class="post-tag">smevk</a> <a href="/tags#lua " class="post-tag">lua</a> <a href="/tags#luvit " class="post-tag">luvit</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#motd " class="post-tag">motd</a> <a href="/tags#linpeas " class="post-tag">linpeas</a> <a href="/tags#linenum " class="post-tag">linenum</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/traceback-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/traceback-cover.png" alt="Traceback" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Traceback starts with finding a webshell that’s already one the server with some enumeration and a bit of open source research. From there, I’ll pivot to the next user with sudo that allows me to run Luvit, a Lua interpreter. To get root, I’ll notice that I can write to the message of the day directory. These scripts are run by root whenever a user logs in. I actually found this by seeing the cron that cleans up scripts dropped in this directory, but I’ll also show how to find it with some basic enumeration as well. In Beyond Root, I’ll take a quick look at the cron that’s cleaning up every thiry seconds.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 13, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/13/htb-joker.html">
                HTB: Joker
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-joker " class="post-tag">htb-joker</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#udp " class="post-tag">udp</a> <a href="/tags#tftp " class="post-tag">tftp</a> <a href="/tags#squid " class="post-tag">squid</a> <a href="/tags#http-proxy " class="post-tag">http-proxy</a> <a href="/tags#foxyproxy " class="post-tag">foxyproxy</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#penglab " class="post-tag">penglab</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#werkzeug " class="post-tag">werkzeug</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#socat " class="post-tag">socat</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#sudoedit " class="post-tag">sudoedit</a> <a href="/tags#sudoedit-follow " class="post-tag">sudoedit-follow</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#tar " class="post-tag">tar</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#wildcard " class="post-tag">wildcard</a> <a href="/tags#symbolic-link " class="post-tag">symbolic-link</a> <a href="/tags#checkpoint " class="post-tag">checkpoint</a> <a href="/tags#htb-tartarsauce " class="post-tag">htb-tartarsauce</a> <a href="/tags#htb-shrek " class="post-tag">htb-shrek</a> <a href="/tags#flask-debug " class="post-tag">flask-debug</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/joker-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/joker-cover.png" alt="Joker" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Rooting Joker had three steps. The first was using TFTP to get the Squid Proxy config and creds that allowed access to a webserver listening on localhost that provided a Python console. To turn that into a shell, I’ll have to enumerate the firewall and find that I can use UDP. I’ll show two ways to abuse a sudo rule to make the second step. I can take advantage of the sudoedit_follow flag, or just abuse the wildcards in the rule. The final pivot to root exploits a cron running creating tar archives, and I’ll show three different ways to abuse it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 10, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/10/tunneling-with-chisel-and-ssf-update.html">
                Tunneling with Chisel and SSF
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#ssf " class="post-tag">ssf</a> <a href="/tags#htb-reddish " class="post-tag">htb-reddish</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/pipes-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/pipes-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>[Update 2020-08-10] Chisel now has a built in SOCKS proxy! I also added a cheat sheet since I reference this post too often. [Original] Having just <a href="/2019/01/26/htb-reddish.html">written up HTB Reddish</a>, pivoting without SSH was at the top of my mind, and I’ve since learned of two programs that enable pivots, Chisel and Secure Socket Funneling (SSF). I learned about Chisel from Ippsec, and you can see <a href="https://www.youtube.com/watch?v=Yp4oxoQIBAM&amp;t=1469s">his using it to solve Reddish in his video</a>. I wanted to play with it, and figured I’d document what I learned here. I learned about SSF from another HTB user, <a href="https://www.hackthebox.eu/home/users/profile/77141">jkr</a>, who not only introduced me to SSF, but pulled together the examples in this post.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 8, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/08/htb-fatty.html">
                HTB: Fatty
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-fatty " class="post-tag">htb-fatty</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#update-alternatives " class="post-tag">update-alternatives</a> <a href="/tags#jar " class="post-tag">jar</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#procyon " class="post-tag">procyon</a> <a href="/tags#javac " class="post-tag">javac</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#tar " class="post-tag">tar</a> <a href="/tags#scp " class="post-tag">scp</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#ysoserial " class="post-tag">ysoserial</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#htb-arkham " class="post-tag">htb-arkham</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/fatty-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/fatty-cover.png" alt="Fatty" style="float: right;margin-right:50px; margin-left:50px; height:170px;" class="include_image " />
</picture>

<p>Fatty forced me way out of my comfort zone. The majority of the box was reversing and modifying a Java thick client. First I had to modify the client to get the client to connect. Then I’ll take advantage of a directory traversal vulnerability to get a copy of the server binary, which I can reverse as well. In that binary, first I’ll find a SQL injection that allows me to log in as an admin user, which gives me access to additional functionality. One of the new functions uses serialized objects, which I can exploit using a deserialization attack to get a shell in the container running the server. Escalation to root attacks a recurring process that is using SCP to copy an archive of log files off the container to the host. By guessing that the log files are extracted from the archive, I’m able to create a malicious archive that allows me over the course of two SCPs to overwrite the root authorized_keys file and then SSH into Fatty as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 8, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/08/jar-files-analysis-and-modifications.html">
                Jar Files: Analysis and Modifications
              </a>
            </h3>

<span class="tag-list"><a href="/tags#java " class="post-tag">java</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#decompile " class="post-tag">decompile</a> <a href="/tags#jar " class="post-tag">jar</a> <a href="/tags#recompile " class="post-tag">recompile</a> <a href="/tags#procyon " class="post-tag">procyon</a> <a href="/tags#javac " class="post-tag">javac</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/jar-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/jar-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>I recently ran into a challenge where I was given a Java Jar file that I needed to analyze and patch to exploit. I didn’t find many good tutorials on how to do this, so I wanted to get my notes down. For now it’s just a cheat sheet table of commands. <em>Updated 8 Aug 2020</em>: Now that Fatty from HackTheBox has retired, I’ve updated this post to reflect some examples.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 4, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/04/htb-pwnbox-review.html">
                HTB Pwnbox Review
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#pwnbox " class="post-tag">pwnbox</a> <a href="/tags#parrot " class="post-tag">parrot</a> <a href="/tags#vm " class="post-tag">vm</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#scp " class="post-tag">scp</a> <a href="/tags#tmux " class="post-tag">tmux</a> <a href="/tags#api " class="post-tag">api</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/pwnbox-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/pwnbox-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>I was recently talking with some of the folks over at HackTheBox, and they asked my thoughts about Pwnbox. My answer was that I’d never really used it, but that I would give it a look and provide feedback. The system is actually quite feature packed. It is only available to VIP members, but if you are VIP, it’s worth spending a few minutes setting up the customizations. That way, if you should find yourself in need of an attack VM, you have it, and you might even just switch there.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/08/01/htb-oouch.html">
                HTB: Oouch
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-oouch " class="post-tag">htb-oouch</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#oauth " class="post-tag">oauth</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#vsftpd " class="post-tag">vsftpd</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#csrf " class="post-tag">csrf</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#dbus " class="post-tag">dbus</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#uwsgi " class="post-tag">uwsgi</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#htb-lame " class="post-tag">htb-lame</a> <a href="/tags#htb-secnotes " class="post-tag">htb-secnotes</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/oouch-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/oouch-cover.png" alt="Oouch" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>The first half of Oouch built all around OAuth, a technology that is commonplace on the internet today, and yet I didn’t understand well coming into the challenge. This box forced me to gain an understanding, and writing this post cemented that even further. To get user, I’ll exploit an insecure implementation of OAuth via a CSRF twice. The first time to get access to qtc’s account on the consumer application, and then to get access to qtc’s data on the authorization server, which includes a private SSH key. With a shell, I’ll drop into the consumer application container and look at how the site was blocking XSS attacks, which includes some messaging over DBus leading to iptables blocks. I’ll pivot to the www-data user via a uWSGI exploit and then use command injection to get execution as root. In Beyond Root, I’ll look at the command injection in the root DBus server code.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 29, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/07/29/htb-lazy.html">
                HTB: Lazy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-lazy " class="post-tag">htb-lazy</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#cookies " class="post-tag">cookies</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#padding-oracle " class="post-tag">padding-oracle</a> <a href="/tags#padbuster " class="post-tag">padbuster</a> <a href="/tags#firefox " class="post-tag">firefox</a> <a href="/tags#bit-flip " class="post-tag">bit-flip</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#penglab " class="post-tag">penglab</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#ltrace " class="post-tag">ltrace</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#des " class="post-tag">des</a> <a href="/tags#peda " class="post-tag">peda</a> <a href="/tags#debug " class="post-tag">debug</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/lazy-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/lazy-cover.png" alt="Lazy" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Lazy was a really solid old HackTheBox machine. It’s a medium difficulty box that requires identifying a unique and interesting cookie value and messing with it to get access to the admin account. I’ll show both a padding oracle attack and a bit-flipping attack that each allow me to change the encrypted data to grant admin access. That access provides an SSH key and a shell. To privesc, there’s a SetUID binary that is vulnerable to a path hijack attack. In Beyond Root, I’ll poke at the PHP source for the site, identify a third way to get logged in as admin, and do a bit of debugging on the SetUID binary.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 25, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/07/25/htb-cascade.html">
                HTB: Cascade
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-cascade " class="post-tag">htb-cascade</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#rpc " class="post-tag">rpc</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#tightvnc " class="post-tag">tightvnc</a> <a href="/tags#vncpwd " class="post-tag">vncpwd</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#debug " class="post-tag">debug</a> <a href="/tags#ad-recycle " class="post-tag">ad-recycle</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/cascade-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/cascade-cover.png" alt="cascade" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Cascade was an interesting Windows all about recovering credentials from Windows enumeration. I’ll find credentials for an account in LDAP results, and use that to gain SMB access, where I find a TightVNC config with a different users password. From there, I get a shell and access to a SQLite database and a program that reads and decrypts a password from it.  That password allows access to an account that is a member of the AD Recycle group, which I can use to find a deleted temporary admin account with a password, which still works for the main administrator accoun, providing a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 22, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/07/22/htb-shrek.html">
                HTB: Shrek
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-shrek " class="post-tag">htb-shrek</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#audacity " class="post-tag">audacity</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#ecc " class="post-tag">ecc</a> <a href="/tags#seccure " class="post-tag">seccure</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#chown " class="post-tag">chown</a> <a href="/tags#wildcard " class="post-tag">wildcard</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#passwd " class="post-tag">passwd</a> <a href="/tags#extended-attributes " class="post-tag">extended-attributes</a> <a href="/tags#xattr " class="post-tag">xattr</a> <a href="/tags#lsattr " class="post-tag">lsattr</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#suid " class="post-tag">suid</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/shrek-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/shrek-cover.png" alt="Shrek" style="float: right;margin-right:50px; margin-left:50px; height:160px;" class="include_image " />
</picture>

<p>Shrek is another 2018 HackTheBox machine that is more a string of challenges as opposed to a box. I’ll find an uploads page in the website that doesn’t work, but then also find a bunch of malware (or malware-ish) files in the uploads directory. One of them contains a comment about a secret directory, which I’ll check to find an MP3 file. Credentials for the FTP server are hidden in a chunk of the file at the end. On the FTP server, there’s an encrypted SSH key, and a bunch of files full of base64-encoded data. Two have a passphrase and an encrypted blob, which I’ll decrypt to get the SSH key password, and use to get a shell. To privesc, I’ll find a process running chmod with a wildcard, and exploit that to change the ownership of the passwd file to my user, so I can edit it and get a root shell. In Beyond Root, I’ll examine the text file in the directory and why it doesn’t get it changed ownership, look at the automation and find a curious part I wasn’t expecting, and show an alternative root based on that automation (which may be the intended path).</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 18, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/07/18/htb-sauna.html">
                HTB: Sauna
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-sauna " class="post-tag">htb-sauna</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#ldapsearch " class="post-tag">ldapsearch</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#kerberos " class="post-tag">kerberos</a> <a href="/tags#seclists " class="post-tag">seclists</a> <a href="/tags#as-rep-roast " class="post-tag">as-rep-roast</a> <a href="/tags#getnpusers " class="post-tag">getnpusers</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#winpeas " class="post-tag">winpeas</a> <a href="/tags#autologon-credentials " class="post-tag">autologon-credentials</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#sharphound " class="post-tag">sharphound</a> <a href="/tags#neo4j " class="post-tag">neo4j</a> <a href="/tags#dcsync " class="post-tag">dcsync</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#mimikatz " class="post-tag">mimikatz</a> <a href="/tags#wmiexec " class="post-tag">wmiexec</a> <a href="/tags#psexec " class="post-tag">psexec</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sauna-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sauna-cover.png" alt="Sauna" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Sauna was a neat chance to play with Windows Active Directory concepts packaged into an easy difficulty box. I’ll start by using a Kerberoast brute force on usernames to identify a handful of users, and then find that one of them has the flag set to allow me to grab their hash without authenticating to the domain. I’ll AS-REP Roast to get the hash, crack it, and get a shell. I’ll find the next users credentials in the AutoLogon registry key. BloodHound will show that user has privileges the allow it to perform a DC Sync attack, which provides all the domain hashes, including the administrators, which I’ll use to get a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 14, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/07/14/htb-tenten.html">
                HTB: Tenten
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-tenten " class="post-tag">htb-tenten</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wp-job-manager " class="post-tag">wp-job-manager</a> <a href="/tags#cve-2015-6668 " class="post-tag">cve-2015-6668</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#steghide " class="post-tag">steghide</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#mysql " class="post-tag">mysql</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/tenten-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/tenten-cover.png" alt="Tenten" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Tenten had a lot of the much more CTF-like aspects that were more prevalent in the original HTB machine, like a uploaded hacker image file from which I will extract an SSH private key from it using steganography. I learned a really interesting lesson about wpscan and how to feed it an API key, and got to play with a busted WordPress plugin. In Beyond Root I’ll poke a bit at the WordPress database and see what was leaking via the plugin exploit.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 11, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/07/11/htb-book.html">
                HTB: Book
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-book " class="post-tag">htb-book</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#sql-truncation " class="post-tag">sql-truncation</a> <a href="/tags#sql " class="post-tag">sql</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#logrotate " class="post-tag">logrotate</a> <a href="/tags#logrotten " class="post-tag">logrotten</a> <a href="/tags#crontab " class="post-tag">crontab</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/book-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/book-cover.png" alt="Book" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Getting a foothold on Book involved identifying and exploiting a few vulnerabilities in a website for a library. First there’s a SQL truncation attack against the login form to gain access as the admin account. Then I’ll use a cross-site scripting (XSS) attack against a PDF export to get file read from the local system. This is interesting because typically I think of XSS as something that I present to another user, but in this case, it’s the PDF generate software. I’ll use this to find a private SSH key and get a shell on the system. To get root, I’ll exploit a regular logrotate cron using the logrotten exploit, which is a timing against against how logrotate worked. In Beyond Root, I’ll look at the various crons on the box and how they made it work and cleaned up.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 7, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/07/07/htb-bank.html">
                HTB: Bank
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-bank " class="post-tag">htb-bank</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#dig " class="post-tag">dig</a> <a href="/tags#zone-transfer " class="post-tag">zone-transfer</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#regex " class="post-tag">regex</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#passwd " class="post-tag">passwd</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bank-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bank-cover.png" alt="Bank" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Bank was an pretty straight forward box, though two of the major steps had unintended alternative methods. I’ll enumerate DNS to find a hostname, and use that to access a bank website. I can either find creds in a directory of data, or bypass creds all together by looking at the data in the HTTP 302 redirects. From there, I’ll upload a PHP webshell, bypassing filters, and get a shell. To get root, I can find a backdoor SUID copy of dash left by the administrator, or exploit write privileges in /etc/passwd. In Beyond Root, I’ll look at the coding mistake in the 302 redirects, and show how I determined the SUID binary was dash.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 4, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/07/04/htb-forwardslash.html">
                HTB: ForwardSlash
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-forwardslash " class="post-tag">htb-forwardslash</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#rfi " class="post-tag">rfi</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#luks " class="post-tag">luks</a> <a href="/tags#crypto " class="post-tag">crypto</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/forwardslash-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/forwardslash-cover.png" alt="ForwardSlash" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>ForwardSlash starts with enumeration of a hacked website to identify and exploit at least one of two LFI vulnerabilities (directly using filters to base64 encode or using XXE) to leak PHP source which includes a password which can be used to get a shell. From there, I’ll exploit a severely non-functional “backup” program to get file read as the other user. With this, I’ll find a backup of the website, and find different credentials in one of the pages, which I can use for a shell as the second user. To root, I’ll break a homespun encryption algorithm to load an encrypted disk image which contains root’s private SSH key. In Beyond Root, I’ll dig into the website source to understand a couple surprising things I found while enumerating.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 30, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/30/htb-blocky.html">
                HTB: Blocky
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-blocky " class="post-tag">htb-blocky</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#jar " class="post-tag">jar</a> <a href="/tags#decompile " class="post-tag">decompile</a> <a href="/tags#jd-gui " class="post-tag">jd-gui</a> <a href="/tags#phpmyadmin " class="post-tag">phpmyadmin</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/blocky-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/blocky-cover.png" alt="Blocky" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Blocky really was an easy box, but did require some discipline when enumerating. It would be easy to miss the /plugins path that hosts two Java Jar files. From one of those files, I’ll find creds, which as reused by a user on the box, allowing me to get SSH access. To escalate to root, the user is allowed to run any command with sudo and password, which I’ll use to sudo su returning a session as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 27, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/27/htb-playertwo.html">
                HTB: PlayerTwo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-playertwo " class="post-tag">htb-playertwo</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#twirp " class="post-tag">twirp</a> <a href="/tags#proto3 " class="post-tag">proto3</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#totp " class="post-tag">totp</a> <a href="/tags#signing " class="post-tag">signing</a> <a href="/tags#binwalk " class="post-tag">binwalk</a> <a href="/tags#hexedit " class="post-tag">hexedit</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#mqtt " class="post-tag">mqtt</a> <a href="/tags#paho " class="post-tag">paho</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#htb-rope " class="post-tag">htb-rope</a> <a href="/tags#heap " class="post-tag">heap</a> <a href="/tags#tcache " class="post-tag">tcache</a> <a href="/tags#ldd " class="post-tag">ldd</a> <a href="/tags#patchelf " class="post-tag">patchelf</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#checksec " class="post-tag">checksec</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#type-juggling " class="post-tag">type-juggling</a> <a href="/tags#pwngdb " class="post-tag">pwngdb</a> <a href="/tags#htb-ellingson " class="post-tag">htb-ellingson</a> <a href="/tags#htb-player " class="post-tag">htb-player</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/playertwo-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/playertwo-cover.png" alt="PlayerTwo" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>PlayerTwo was just a monster of a box. Enumeration across three virtual hosts reveals a Twirp API where I can leak some credentials. Another API can be enumerated to find backup codes for for the 2FA for the login. With creds and backup codes, I can log into the site, which has a firmware upload section. The example firmware is signed, but only the first roughly eight thousand bytes. I’ll find a way to modify the arguments to a call to system to get execution and a shell. With a shell, I see a MQTT message queue on localhost, and connecting to it, I’ll find a private SSH key being sent, which I can use to get a shell as the next user. Finally, to get to root, I’ll do a heap exploit against a root SUID binary to get a shell. In a Beyond Root section that could be its own blog post, I’ll dig into a few unintended ways to skips parts of the intended path, and dig deeper on others.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 23, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/23/htb-popcorn.html">
                HTB: Popcorn
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-popcorn " class="post-tag">htb-popcorn</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#karmic " class="post-tag">karmic</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#torrent-hoster " class="post-tag">torrent-hoster</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#cve-2010-0832 " class="post-tag">cve-2010-0832</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> <a href="/tags#passwd " class="post-tag">passwd</a> <a href="/tags#dirtycow " class="post-tag">dirtycow</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-nineveh " class="post-tag">htb-nineveh</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/popcorn-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/popcorn-cover.png" alt="Popcorn" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Popcorn was a medium box that, while not on TJ Null’s list, felt very OSCP-like to me. Some enumeration will lead to a torrent hosting system, where I can upload, and, bypassing filters, get a PHP webshell to run. From there, I will exploit CVE-2010-0832, a vulnerability in the linux authentication system (PAM) where I
can get it to make my current user the owner of any file on the system. There’s a slick exploit script, but I’ll show manually exploiting it as well. I’ll quickly also show DirtyCow since it does work here.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 20, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/20/htb-servmon.html">
                HTB: ServMon
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-servmon " class="post-tag">htb-servmon</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#nvms-1000 " class="post-tag">nvms-1000</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#exploit-db " class="post-tag">exploit-db</a> <a href="/tags#nsclient " class="post-tag">nsclient++</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/servmon-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/servmon-cover.png" alt="ServMon" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>ServMon was an easy Windows box that required two exploits. There’s a hint in the anonymous FTP as to the location of a list of passwords. I can use a directory traversal bug in a NVMS 1000 web instance that will allow me to leak those passwords, and use one of them over SSH to get a shell. Then I can get the local config for the  NSClient++ web instance running on TCP 8443, and use those credentials plus another exploit to get a SYSTEM shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 17, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/17/endgame-xen.html">
                HTB Endgame: XEN
              </a>
            </h3>

<span class="tag-list"><a href="/tags#endgame " class="post-tag">endgame</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-xen " class="post-tag">htb-xen</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#citrix " class="post-tag">citrix</a> <a href="/tags#xenapp " class="post-tag">xenapp</a> <a href="/tags#smtp " class="post-tag">smtp</a> <a href="/tags#smtp-user-enum " class="post-tag">smtp-user-enum</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#swaks " class="post-tag">swaks</a> <a href="/tags#escape " class="post-tag">escape</a> <a href="/tags#alwaysinstallelevated " class="post-tag">alwaysinstallelevated</a> <a href="/tags#powerup " class="post-tag">powerup</a> <a href="/tags#uac-bypass " class="post-tag">uac-bypass</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#kerberoast " class="post-tag">kerberoast</a> <a href="/tags#getuserspns " class="post-tag">getuserspns</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#password-spray " class="post-tag">password-spray</a> <a href="/tags#ppk " class="post-tag">ppk</a> <a href="/tags#puttygen " class="post-tag">puttygen</a> <a href="/tags#proxychains " class="post-tag">proxychains</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#kwprocessor " class="post-tag">kwprocessor</a> <a href="/tags#keyboard-walks " class="post-tag">keyboard-walks</a> <a href="/tags#netscaler " class="post-tag">netscaler</a> <a href="/tags#tcpdump " class="post-tag">tcpdump</a> <a href="/tags#packet-capture " class="post-tag">packet-capture</a> <a href="/tags#scp " class="post-tag">scp</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#sharphound " class="post-tag">sharphound</a> <a href="/tags#xfreerdp " class="post-tag">xfreerdp</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#sebackupprivilege " class="post-tag">sebackupprivilege</a> <a href="/tags#ntds " class="post-tag">ntds</a> <a href="/tags#diskshadow " class="post-tag">diskshadow</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#wmiexec " class="post-tag">wmiexec</a> <a href="/tags#copy-filesebackupprivilege " class="post-tag">copy-filesebackupprivilege</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/endgame-xen-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/endgame-xen-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Endgame XEN is all about owning a small network behind a Citrix virtual desktop environment. I’ll phish creds for the Citrix instance from users in the sales department, and then use them to get a foothold. I’ll break out of the restrictions in that environment, and then get administrator access. From there I’ll pivot into the domain, finding a Kerberoastable user and breaking the hash to get access to an SMB share with an encrypted SSH key. I’ll break that, and get access to the NetScaler device, where I’ll capture network traffic to find service creds in LDAP traffic. I’ll spray those creds against the domain to find they also work for a backup service, which I’ll use to access the DC, and to exfil the Active Directory database, where I can find the domain administrator hash.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 13, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/13/htb-monteverde.html">
                HTB: Monteverde
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-monteverde " class="post-tag">htb-monteverde</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#rpc " class="post-tag">rpc</a> <a href="/tags#rpcclient " class="post-tag">rpcclient</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#password-spray " class="post-tag">password-spray</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#azure-active-directory " class="post-tag">azure-active-directory</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#azure-connect " class="post-tag">azure-connect</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#sqlcmd " class="post-tag">sqlcmd</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/monteverde-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/monteverde-cover.jpg" alt="Monteverde" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>For the third week in a row, a Windows box on the easier side of the spectrum with no web server retires. Monteverde was focused on Azure Active Directory. First I’ll look at RPC to get a list of users, and then check to see if any used their username as their password. With creds for SABatchJobs, I’ll gain access to SMB to find an XML config file with a password for one of the users on the box who happens to have WinRM permissions. From there, I can abuse the Azure active directory database to leak the administrator password. In Beyond Root, I’ll look deeper into two versions of the PowerShell script I used to leak the creds, and how they work or don’t work.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 8, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/08/endgame-poo.html">
                HTB Endgame: P.O.O.
              </a>
            </h3>

<span class="tag-list"><a href="/tags#endgame " class="post-tag">endgame</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-poo " class="post-tag">htb-poo</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#ds-store " class="post-tag">ds-store</a> <a href="/tags#iis-shortname " class="post-tag">iis-shortname</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#mssqlclient " class="post-tag">mssqlclient</a> <a href="/tags#mssql-linked-servers " class="post-tag">mssql-linked-servers</a> <a href="/tags#xp-cmdshell " class="post-tag">xp-cmdshell</a> <a href="/tags#mssql-triggers " class="post-tag">mssql-triggers</a> <a href="/tags#sp-execute-external-script " class="post-tag">sp_execute_external_script</a> <a href="/tags#web-config " class="post-tag">web-config</a> <a href="/tags#ipv6 " class="post-tag">ipv6</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#sharphound " class="post-tag">sharphound</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#kerberoast " class="post-tag">kerberoast</a> <a href="/tags#invoke-kerberoast " class="post-tag">invoke-kerberoast</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#juicypotato " class="post-tag">juicypotato</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/endgame-poo-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/endgame-poo-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Endgame Professional Offensive Operations (P.O.O.) was the first Endgame lab released by HTB. Endgame labs require at least Guru status to attempt (though now that P.O.O. is retired, it is available to all VIP). The lab contains two Windows hosts, and I’m given a single IP that represents the public facing part of the network. To collect all five flags, I’ll take advantage of DS_STORE files and Windows short filenames to get creds for the MSSQL instance, abuse trust within MSSQL to escalate my access to allow for code execution. Basic xp_cmdshell runs as a user without much access, but Python within MSSQL runs as a more privileged user, allowing me access to a config file with the administrator credentials. I’ll observe that WinRM is not blocked on IPv6, and get a shell. To pivot to the DC, I’ll run SharpHound and see that a kerberoastable user has Generic All on the Domain Admins group, get the hash, break it, and add that user to DA.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 6, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/06/htb-nest.html">
                HTB: Nest
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-nest " class="post-tag">htb-nest</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#vb " class="post-tag">vb</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#dotnetfiddle " class="post-tag">dotnetfiddle</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#alternative-data-streams " class="post-tag">alternative-data-streams</a> <a href="/tags#psexec " class="post-tag">psexec</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> <a href="/tags#htb-dropzone " class="post-tag">htb-dropzone</a> <a href="/tags#htb-bighead " class="post-tag">htb-bighead</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/nest-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/nest-cover.png" alt="Nest" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Next was unique in that it was all about continually increasing SMB access, with a little bit of easy .NET RE thrown in. I probably would rate the box medium instead of easy, because of the RE, but that’s nitpicking. I’ll start with unauthenticated access to a share, and find a password for tempuser. With that access, I’ll find an encrypted password for C.Smith. I’ll also use a Notepad++ config to find a new directory I can access (inside one I can’t), which reveals a Visual Basic Visual Studio project that includes the code to decrypt the password. With access as C.Smith, I can find the debug password for a custom application listening on 4386, and use that to leak another encrypted password. This time I’ll debug the binary to read the decrpyted administrator password from memory, and use it to get a shell as SYSTEM with PSExec. When this box was first released, there was an error where the first user creds could successfully PSExec. I wrote a post on that back in January, but I’ve linked that post to this one on the left. In Beyond Root, I’ll take a quick look at why netcat can’t connect to the custom service on 4386, but telnet can.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/06/01/resolute-more-beyond-root.html">
                Debugging CME, PSexec on HTB: Resolute
              </a>
            </h3>

<span class="tag-list"><a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-resolute " class="post-tag">htb-resolute</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#scmanager " class="post-tag">scmanager</a> <a href="/tags#sddl " class="post-tag">sddl</a> <a href="/tags#dacl " class="post-tag">dacl</a> <a href="/tags#psexec " class="post-tag">psexec</a> <a href="/tags#github " class="post-tag">github</a> <a href="/tags#source-code " class="post-tag">source-code</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#wireshark-smb " class="post-tag">wireshark smb</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#scdbg " class="post-tag">scdbg</a> <a href="/tags#htb-nest " class="post-tag">htb-nest</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/resolute-br-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/resolute-br-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>When I ran CrackMapExec with ryan’s creds against Resolute, it returned Pwn3d!, which is weird, as none of the standard PSExec exploits I attempted worked. Beyond that, ryan wasn’t an administrator, and didn’t have any writable shares. I’ll explore the CME code to see why it returned Pwn3d!, look at the requirements for a standard PSExec, and then debug the Metasploit exploit that does go directly to SYSTEM with ryan’s creds.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 30, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/30/htb-resolute.html">
                HTB: Resolute
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-resolute " class="post-tag">htb-resolute</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#rpcclient " class="post-tag">rpcclient</a> <a href="/tags#rpc " class="post-tag">rpc</a> <a href="/tags#password-spray " class="post-tag">password-spray</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#pstranscript " class="post-tag">pstranscript</a> <a href="/tags#net-use " class="post-tag">net-use</a> <a href="/tags#dnscmd " class="post-tag">dnscmd</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#lolbas " class="post-tag">lolbas</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#htb-forest " class="post-tag">htb-forest</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/resolute-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/resolute-cover.png" alt="Resolute" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>It’s always interesting when the initial nmap scan shows no web ports as was the case in Resolute. The attack starts with enumeration of user accounts using Windows RPC, including a list of users and a default password in a comment. That password works for one of the users over WinRM. From there I find the next users creds in a PowerShell transcript file. That user is in the DnsAdmins group, which allows for an attack against dnscmd to get SYSTEM. In beyond root, I’ll identify the tool the box creator used to connect to the box and generate the PowerShell transcript.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 28, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/28/htb-grandpa.html">
                HTB: Grandpa
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-grandpa " class="post-tag">htb-grandpa</a> <a href="/tags#windows-2003 " class="post-tag">windows-2003</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#webdav " class="post-tag">webdav</a> <a href="/tags#davtest " class="post-tag">davtest</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#cve-2017-7269 " class="post-tag">cve-2017-7269</a> <a href="/tags#explodingcan " class="post-tag">explodingcan</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#icacls " class="post-tag">icacls</a> <a href="/tags#systeminfo " class="post-tag">systeminfo</a> <a href="/tags#windows-exploit-suggester " class="post-tag">windows-exploit-suggester</a> <a href="/tags#seimpersonate " class="post-tag">seimpersonate</a> <a href="/tags#churrasco " class="post-tag">churrasco</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-granny " class="post-tag">htb-granny</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/grandpa-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/grandpa-cover.png" alt="Grandpa" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Grandpa was one of the really early HTB machines. It’s the kind of box that wouldn’t show up in HTB today, and frankly, isn’t as fun as modern targets. Still, it’s a great proxy for the kind of things that you’ll see in OSCP, and does teach some valuable lessons, especially if you try to work without Metasploit. With Metasploit, this box can probably be solved in a few minutes. Typically, the value in avoiding Metasploit comes from being able to really understand the exploits and what’s going on. In this case, it’s more about the struggle of moving files, finding binarys, etc.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 23, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/23/htb-rope.html">
                HTB: Rope
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-rope " class="post-tag">htb-rope</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#format-string " class="post-tag">format-string</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#pwn " class="post-tag">pwn</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#aslr " class="post-tag">aslr</a> <a href="/tags#pie " class="post-tag">pie</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#library " class="post-tag">library</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#canary " class="post-tag">canary</a> <a href="/tags#rop " class="post-tag">rop</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/rope-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/rope-cover.png" alt="Rope" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Rope was all about binary exploitation. For initial access, I’ll use a directory traversal bug in the custom webserver to get a copy of that webserver as well as it’s memory space. From there, I can use a format string vulnerability to get a shell. To get to the next user, I’ll take advantage of an unsafe library load in a program that the current user can run with sudo. Finally, for root, I’ll exploit a locally running piece of software that requires brute forcing the canary, RBP, and return addresses to allows for an overflow and defeat PIE, and then doing a ROP libc leak to get past ASLR, all to send another ROP which provides a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 19, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/19/htb-arctic.html">
                HTB: Arctic
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-arctic " class="post-tag">htb-arctic</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#coldfusion " class="post-tag">coldfusion</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#jsp " class="post-tag">jsp</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#windows-exploit-suggester " class="post-tag">windows-exploit-suggester</a> <a href="/tags#ms10-095 " class="post-tag">ms10-095</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/arctic-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/arctic-cover.png" alt="Arctic" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Arctic would have been much more interesting if not for the 30-second lag on each HTTP request. Still, there’s enough of an interface for me to find a ColdFusion webserver. There are two different paths to getting a shell, either an unauthenticated file upload, or leaking the login hash, cracking or using it to log in, and then uploading a shell jsp. From there, I’ll use MS10-059 to get a root shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 16, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/16/htb-patents.html">
                HTB: Patents
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-patents " class="post-tag">htb-patents</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#libreoffice " class="post-tag">libreoffice</a> <a href="/tags#office " class="post-tag">office</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#docx " class="post-tag">docx</a> <a href="/tags#custom-folder " class="post-tag">custom-folder</a> <a href="/tags#sans-holiday-hack " class="post-tag">sans-holiday-hack</a> <a href="/tags#dtd " class="post-tag">dtd</a> <a href="/tags#log-poisoning " class="post-tag">log-poisoning</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#pwn " class="post-tag">pwn</a> <a href="/tags#onegadget " class="post-tag">onegadget</a> <a href="/tags#rop " class="post-tag">rop</a> <a href="/tags#libc " class="post-tag">libc</a> <a href="/tags#libc-database " class="post-tag">libc-database</a> <a href="/tags#df " class="post-tag">df</a> <a href="/tags#mount " class="post-tag">mount</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/patents-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/patents-cover.png" alt="Patents" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Patents was a really tough box, that probably should have been rated insane. I’ll find two listening services, a webserver and a custom service. I’ll exploit XXE in Libre Office that’s being used to convert docx files to PDFs to leak a configuration file, which uncovers another section of the site. In that section, there is a directory traversal vulnerability that allows me to use log poisoning to get execution and a shell in the web docker container. To get root in that container, I’ll find a password in the process list. As root, I get access to an application that’s communicating with the custom service on the host machine. I’ll also find a Git repo with the server binary, which I can reverse and find an exploit in, resulting in a shell as root on the host machine. In Beyond Root, I’ll look at chaining PHP filters to exfil larger data over XXE.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 12, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/12/ngrok-ftw.html">
                ngrok FTW
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#ngrok " class="post-tag">ngrok</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ngrok-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ngrok-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>When I did the COVID-19 CTF, I needed a way to exploit one of the targets and have it callback to me. I spent a lot of time trying to get socket reuse shellcode to work, and if I had just tried a reverse shell payload, I would have gotten there a lot sooner. But getting the connection back to me seemed hard. I’d heard of ngrok for years as some kind of tunneling service. I’d seen malware use it. But I never really looked into how it worked or how I could use it, and it turns out to be super handy and really dead simple. This is barely worth a blog post, and it won’t help with HackTheBox, but it’s just one of those things that when you have a need for it, it’s so easy and useful.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 9, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/09/htb-obscurity.html">
                HTB: Obscurity
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-obscurity " class="post-tag">htb-obscurity</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#dirsearch " class="post-tag">dirsearch</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#python-injection " class="post-tag">python-injection</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#code-analysis " class="post-tag">code-analysis</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#race-condition " class="post-tag">race-condition</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#lxd " class="post-tag">lxd</a> <a href="/tags#lxc " class="post-tag">lxc</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> <a href="/tags#python-path " class="post-tag">python-path</a> <a href="/tags#htb-mischief " class="post-tag">htb-mischief</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/obscurity-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/obscurity-cover.jpg" alt="Obscurity" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Obscuirt was a medium box that centered on finding bugs in Python implementions of things - a webserver, an encryption scheme, and an SSH client. I’ll start by locating the source for the custom Python webserver, and injecting into it to get code execution and a shell. I’ll pivot to the next user abusing a poor custom cipher to decrypt a password. To get root, I’ll show four different ways. Two involve an SSH-like script that I can abuse both via a race condition to leak the system hashes and via injection to run a command as root instead of the authed user. The other two were patches after the box was released, but I’ll show them, exploiting the Python path, and exploiting the lxd group.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 4, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/04/covid-19-ctf-covidscammers.html">
                COVID-19 CTF: CovidScammers
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ltrace " class="post-tag">ltrace</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#fuzz " class="post-tag">fuzz</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> <a href="/tags#dup2 " class="post-tag">dup2</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/covid19ctf-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/covid19ctf-cover.png" alt="" style="float: right; height:120px;" class="include_image " />
</picture>

<p>Last Friday I competed with the Neutrino Cannon CTF team in the COVID-19 CTF created by Threat Simulations and RunCode as a part of DERPCON 2020. I focused much of my efforts on a section named CovidScammers. It was a really interesting challenge that encompassed forensics, reverseing, programming, fuzzing, and exploitation. I managed to get a shell on the C2 server just as I had to sign off for the day, so I didn’t complete the next steps that unlocked after that. Still, I really enjoyed the challenge and wanted to show the steps up to that point.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 2, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/05/02/htb-openadmin.html">
                HTB: OpenAdmin
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-openadmin " class="post-tag">htb-openadmin</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#opennetadmin " class="post-tag">opennetadmin</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/openadmin-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/openadmin-cover.png" alt="OpenAdmin" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>OpenAdmin provided a straight forward easy box. There’s some enumeration to find an instance of OpenNetAdmin, which has a remote coded execution exploit that I’ll use to get a shell as www-data. The database credentials are reused by one of the users. Next I’ll pivot to the second user via an internal website which I can either get code execution on or bypass the login to get an SSH key. Finally, for root, there’s a sudo on nano that allows me to get a root shell using GTFObins.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 30, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/30/htb-solidstate.html">
                HTB: SolidState
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-solidstate " class="post-tag">htb-solidstate</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#james " class="post-tag">james</a> <a href="/tags#pop3 " class="post-tag">pop3</a> <a href="/tags#smtp " class="post-tag">smtp</a> <a href="/tags#bash-completion " class="post-tag">bash-completion</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#rbash " class="post-tag">rbash</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/solidstate-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/solidstate-cover.png" alt="SolidState" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>The biggest trick with SolidState was not focusing on the website but rather moving to a vulnerable James mail client. In fact, if I take advantage of a restrictred shell escape, I don’t even need to exploit James, but rather just use the admin interface with default creds to gain access to the various mailboxes, find SSH creds, escape rbash, and continue from there. But I will also show how to exploit James using a directory traversal vulnerability to write a bash completion script and then trigger that with a SSH login. For root, there’s a cron running an writable python script, which I can add a reverse shell to. In Beyond Root, I’ll look at payloads for the James exploit, both exploring what didn’t work, and improving the OPSEC.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 25, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/25/htb-control.html">
                HTB: Control
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-control " class="post-tag">htb-control</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#http-header " class="post-tag">http-header</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#mysql-file-write " class="post-tag">mysql-file-write</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#powershell-run-as " class="post-tag">powershell-run-as</a> <a href="/tags#winpeas " class="post-tag">winpeas</a> <a href="/tags#registry-win " class="post-tag">registry-win</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#windows-service " class="post-tag">windows-service</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#htb-nest " class="post-tag">htb-nest</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/control-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/control-cover.png" alt="Control" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Control was a bit painful for someone not comfortable looking deep at Windows objects and permissions. It starts off simply enough, with a website where I’ll have to forge an HTTP header to get into the admin section, and then identify an SQL injection to write a webshell and dump user hashes. I can use the webshell to get a shell, and then one of the cracked hashes to pivot to a different user. From there, I’ll find that users can write the registry keys associated with Services. I’ll construct some PowerShell to find potential services that I can restart, and then modify them to run NetCat to return a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 22, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/22/htb-nineveh.html">
                HTB: Nineveh
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-nineveh " class="post-tag">htb-nineveh</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#phpinfo " class="post-tag">phpinfo</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#phpliteadmin " class="post-tag">phpliteadmin</a> <a href="/tags#sql " class="post-tag">sql</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#strings " class="post-tag">strings</a> <a href="/tags#binwalk " class="post-tag">binwalk</a> <a href="/tags#tar " class="post-tag">tar</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#port-knocking " class="post-tag">port-knocking</a> <a href="/tags#knockd " class="post-tag">knockd</a> <a href="/tags#chkrootkit " class="post-tag">chkrootkit</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/nineveh-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/nineveh-cover.png" alt="Nineveh" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>There were several parts about Nineveh that don’t fit with what I expect in a modern HTB machine - steg, brute forcing passwords, and port knocking. Still, there were some really neat attacks. I’ll show two ways to get a shell, by writing a webshell via phpLiteAdmin, and by abusing PHPinfo. From there I’ll use my shell to read the knockd config and port knock to open SSH and gain access using the key pair I obtained from the steg image. To get root, I’ll exploit chkroot, which is running on a cron.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 18, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/18/htb-mango.html">
                HTB: Mango
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-mango " class="post-tag">htb-mango</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#nosql " class="post-tag">nosql</a> <a href="/tags#mongo " class="post-tag">mongo</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#nosql-injection " class="post-tag">nosql-injection</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#jjs " class="post-tag">jjs</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#sudoers " class="post-tag">sudoers</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/mango-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/mango-cover.png" alt="Mango" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Mango’s focus was exploiting a NoSQL document database to bypass an authorization page and to leak database information. Once I had the users and passwords from the database, password reuse allowed me to SSH as one of the users, and then su to the other. From there, I’ll take advantage of a SUID binary associated with Java, jjs. I’ll show both file read and get a shell by writing a public SSH key into root’s authorized keys file.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 14, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/14/htb-cronos.html">
                HTB: Cronos
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-cronos " class="post-tag">htb-cronos</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#nslookup " class="post-tag">nslookup</a> <a href="/tags#zone-transfer " class="post-tag">zone-transfer</a> <a href="/tags#dig " class="post-tag">dig</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#laravel " class="post-tag">laravel</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#linpeas " class="post-tag">linpeas</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#cve-2018-15133 " class="post-tag">cve-2018-15133</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/cronos-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/cronos-cover.png" alt="Cronos" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Cronos didn’t provide anything too challenging, but did present a good intro to many useful concepts. I’ll enumerate DNS to get the admin subdomain, and then bypass a login form using SQL injection to find another form where I could use command injections to get code execution and a shell. For privesc, I’ll take advantage of a root cron job which executes a file I have write privileges on, allowing me to modify it to get a reverse shell. In Beyond Root, I’ll look at the website and check in on how I was able to do both the SQLi and the command injection, as well as fail to exploit the machine with a Laravel PHP framework deserialization bug, and determine why.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 11, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/11/htb-traverxec.html">
                HTB: Traverxec
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-traverxec " class="post-tag">htb-traverxec</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#nostromo " class="post-tag">nostromo</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#htpasswd " class="post-tag">htpasswd</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#journalctrl " class="post-tag">journalctrl</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/traverxec-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/traverxec-cover.png" alt="Traverxec" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Traverxec was a relatively easy box that involved enumerating and exploiting a less popular webserver, Nostromo. I’ll take advantage of a RCE vulnerability to get a shell on the host. I could only find a Metasploit script, but it was a simple HTTP request I could recreate with curl. Then I’ll pivot into the users private files based on his use of a web home directory on the server. To get root, I’ll exploit sudo used with journalctrl.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 9, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/09/htb-sniper-beyondroot.html">
                HTB: Sniper Beyond Root
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-sniper " class="post-tag">htb-sniper</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#scheduled-task " class="post-tag">scheduled-task</a> <a href="/tags#persistence " class="post-tag">persistence</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#startup " class="post-tag">startup</a> <a href="/tags#magic " class="post-tag">magic</a> <a href="/tags#htb-secnotes " class="post-tag">htb-secnotes</a> <a href="/tags#htb-re " class="post-tag">htb-re</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sniper-br-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sniper-br-cover.png" alt="sniper_br_cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>In Sniper, the administrator user is running CHM files that are dropped into c:\docs, and this is the path from the chris user to administrator. I was asked on Twitter how the CHM was executed, so I went back to take a look.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 8, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/08/htb-lame-more.html">
                HTB: More Lame
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-lame " class="post-tag">htb-lame</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#distcc " class="post-tag">distcc</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#cve-2004-2687 " class="post-tag">cve-2004-2687</a> <a href="/tags#cve-2008-0166 " class="post-tag">cve-2008-0166</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#rsa " class="post-tag">rsa</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-irked " class="post-tag">htb-irked</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/lame-more-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/lame-more-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>After I put out a Lame write-up yesterday, it was pointed out that I skipped an access path entirely - distcc. Yet another vulnerable service on this box, which, unlike the Samba exploit, provides a shell as a user, providing the opportunity to look for PrivEsc paths. This box is so old, I’m sure there are a ton of kernel exploits available. I’ll skip those for now focusing on <s>two</s> three paths to root - finding a weak public SSH key, using SUID nmap, and backdoored UnrealIRCd.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 7, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/07/htb-lame.html">
                HTB: Lame
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-lame " class="post-tag">htb-lame</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#vsftpd " class="post-tag">vsftpd</a> <a href="/tags#samba " class="post-tag">samba</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-lacasadepapel " class="post-tag">htb-lacasadepapel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/lame-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/lame-cover.png" alt="Lame" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Lame was the first box released on HTB (as far as I can tell), which was before I started playing. It’s a super easy box, easily knocked over with a Metasploit script directly to a root shell. Still, it has some very OSCP-like aspects to it, so I’ll show it with and without Metasploit, and analyze the exploits. It does throw one head-fake with a VSFTPd server that is a vulnerable version, but with the box configured to not allow remote exploitation. I’ll dig into VSFTPd in Beyond Root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 4, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/04/htb-registry.html">
                HTB: Registry
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-registry " class="post-tag">htb-registry</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#zcat " class="post-tag">zcat</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#bolt-cms " class="post-tag">bolt-cms</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#docker-fetch " class="post-tag">docker-fetch</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#firewall " class="post-tag">firewall</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#restic " class="post-tag">restic</a> <a href="/tags#cron " class="post-tag">cron</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/registry-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/registry-cover.png" alt="Registry" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Registry provided the chance to play with a private Docker registry that wasn’t protected by anything other than a weak set of credentials. I’ll move past that to get the container and the SSH key and password inside. From there, I’ll exploit an instance of Bolt CMS to pivot to the www-data user. As www-data, I can access the Restic backup agent as root, and exploit that to get both the root flag and a root ssh key.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 2, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/04/02/jar-files-analysis-and-modifications.html">
                Jar Files: Modification Cheat Sheet
              </a>
            </h3>

<span class="tag-list"><a href="/tags#java " class="post-tag">java</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#decompile " class="post-tag">decompile</a> <a href="/tags#jar " class="post-tag">jar</a> <a href="/tags#recompile " class="post-tag">recompile</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/jar-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/jar-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>I recently ran into a challenge where I was given a Java Jar file that I needed to analyze and patch to exploit. I didn’t find many good tutorials on how to do this, so I wanted to get my notes down. For now it’s just a cheat sheet table of commands. When the challenge ends, I’ll update with some narrative.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 28, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/03/28/htb-sniper.html">
                HTB: Sniper
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-sniper " class="post-tag">htb-sniper</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#commando " class="post-tag">commando</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#rfi " class="post-tag">rfi</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#samba " class="post-tag">samba</a> <a href="/tags#log-poisoning " class="post-tag">log-poisoning</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#powershell-run-as " class="post-tag">powershell-run-as</a> <a href="/tags#chm " class="post-tag">chm</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sniper-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sniper-cover.png" alt="Sniper" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Sniper involved utilizing a relatively obvious file include vulnerability in a web page to get code execution and then a shell. The first privesc was a common credential reuse issue. The second involved poisoning a <code class="language-plaintext highlighter-rouge">.chm</code> file to get code execution as the administrator.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 25, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/03/25/update-alternatives.html">
                update-alternatives
              </a>
            </h3>

<span class="tag-list"><a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#update-alternatives " class="post-tag">update-alternatives</a> <a href="/tags#nc " class="post-tag">nc</a> <a href="/tags#java " class="post-tag">java</a> <a href="/tags#namei " class="post-tag">namei</a> <a href="/tags#bash " class="post-tag">bash</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/icons/Linux.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/icons/Linux.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Debian Linux (and its derivatives like Ubuntu and Kali) has a system called alternatives that’s designed to manage having different version of some software, or aliasing different commands to different versions within the system. Most of the time, this is managed by the package management system. When you run apt install x, it may do some of this behind the scenes for you. But there are times when it is really useful to know how to interact with this yourself. For example, I’m currently working on a challenge that requires using an older version of Java to interact with a file. I’ll use update-altneratives to install the new Java version, and then to change what version java, javac, jar, etc utilize.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 21, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/03/21/htb-forest.html">
                HTB: Forest
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-forest " class="post-tag">htb-forest</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#dig " class="post-tag">dig</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#rpc " class="post-tag">rpc</a> <a href="/tags#rpcclient " class="post-tag">rpcclient</a> <a href="/tags#as-rep-roast " class="post-tag">as-rep-roast</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#sharphound " class="post-tag">sharphound</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#dcsync " class="post-tag">dcsync</a> <a href="/tags#aclpwn " class="post-tag">aclpwn</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#scheduled-task " class="post-tag">scheduled-task</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-active " class="post-tag">htb-active</a> <a href="/tags#htb-reel " class="post-tag">htb-reel</a> <a href="/tags#htb-sizzle " class="post-tag">htb-sizzle</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/forest-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/forest-cover.png" alt="Forest" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>One of the neat things about HTB is that it exposes Windows concepts unlike any CTF I’d come across before it. Forest is a great example of that. It is a domain controller that allows me to enumerate users over RPC, attack Kerberos with AS-REP Roasting, and use Win-RM to get a shell. Then I can take advantage of the permissions and accesses of that user to get DCSycn capabilities, allowing me to dump hashes for the administrator user and get a shell as the admin. In Beyond Root, I’ll look at what DCSync looks like on the wire, and look at the automated task cleaning up permissions.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 14, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/03/14/htb-postman.html">
                HTB: Postman
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-postman " class="post-tag">htb-postman</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#webmin " class="post-tag">webmin</a> <a href="/tags#redis " class="post-tag">redis</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#cve-2019-12840 " class="post-tag">cve-2019-12840</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/postman-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/postman-cover.png" alt="Postman" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Postman was a good mix of easy challenges providing a chance to play with Redis and exploit Webmin. I’ll gain initial access by using Redis to write an SSH public key into an authorized_keys file. Then I’ll pivot to Matt by cracking his encrypted SSH key and using the password. That same password provides access to the Webmin instance, which is running as root, and can be exploited to get a shell. In Beyond Root, I’ll look at a Metasploit Redis exploit and why it failed on this box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 7, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/03/07/htb-bankrobber.html">
                HTB: Bankrobber
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-bankrobber " class="post-tag">htb-bankrobber</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#cookies " class="post-tag">cookies</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#csrf " class="post-tag">csrf</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#phantom-js " class="post-tag">phantom-js</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-giddy " class="post-tag">htb-giddy</a> <a href="/tags#htb-querier " class="post-tag">htb-querier</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bankrobber-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bankrobber-cover.png" alt="Bankrobber" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>BankRobber was neat because it required exploiting the same exploit twice. I’ll find a XSS vulnerability that I can use to leak the admin user’s cookie, giving me access to the admin section of the site. From there, I’ll use a SQL injection to leak the source for one of the PHP pages which shows it can provide code execution, but only accepts requests from localhost. I’ll use the same XSS vulnerability to get the admin to send that request from Bankrobber, returning a shell. To privesc to SYSTEM, I’ll find a binary running as SYSTEM and listening only on localhost. I’m not able to grab a copy of the binary as my current user, but I can create a tunnel and poke at it directly. First I’ll brute force a 4-digit pin, and then I’ll discover a simple buffer overflow that allows me to overwrite a string that is the path to an executable that’s later run. I can overwrite that myself to get a shell. In Beyond Root, I’ll look at how the XSS was automated and at the executable now that I have access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 29, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/02/29/htb-scavenger.html">
                HTB: Scavenger
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-scavenger " class="post-tag">htb-scavenger</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#whois " class="post-tag">whois</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#zone-transfer " class="post-tag">zone-transfer</a> <a href="/tags#exim " class="post-tag">exim</a> <a href="/tags#cve-2019-10149 " class="post-tag">cve-2019-10149</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#dirsearch " class="post-tag">dirsearch</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#mantisbt " class="post-tag">mantisbt</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#ir " class="post-tag">ir</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#mkfifo-shell " class="post-tag">mkfifo-shell</a> <a href="/tags#forward-shell " class="post-tag">forward-shell</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#rootkit " class="post-tag">rootkit</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#htb-stratosphere " class="post-tag">htb-stratosphere</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/scavenger-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/scavenger-cover.png" alt="Scavenger" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Scavenger required a ton of enumeration, and I was able to solve it without ever getting a typical shell. The box is all about enumerating the different sites on the box (and using an SQL injection in whois to get them all), and finding one is hacked and a webshell is left behind. The firewall rules make getting a reverse shell impossible, but I’ll use the RCE to enumerate the box (and build a stateful Python shell in the process, though it’s not necessary). Enumerating will turn up several usernames and passwords, which I’ll use for FTP access to get more creds, the user flag, and a copy of a rootkit that’s running on the box. A combination of finding the rootkit described on a webpage via Googling and reversing to see how it’s changed gives me the ability to trigger any session to root. In Beyond Root, I’ll look more in-depth at the SQLi in the whois server, examine the iptables rules that made getting a reverse shell impossible, and show how to use CVE-2019-10149 against the EXIM mail server to get execution as root as well.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 22, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/02/22/htb-zetta.html">
                HTB: Zetta
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-zetta " class="post-tag">htb-zetta</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ftp-bounce " class="post-tag">ftp-bounce</a> <a href="/tags#rfc-2428 " class="post-tag">rfc-2428</a> <a href="/tags#ipv6 " class="post-tag">ipv6</a> <a href="/tags#rsync " class="post-tag">rsync</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#tudu " class="post-tag">tudu</a> <a href="/tags#syslog " class="post-tag">syslog</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#postgresql " class="post-tag">postgresql</a> <a href="/tags#sqli " class="post-tag">sqli</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/zetta-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/zetta-cover.png" alt="Zetta" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Zetta starts off different from the start, using FTP Bounce attacks to identify the IPv6 address of the box, and then finding RSync listening on IPv6 only. I’ll use limited RSync access to get the size of a user’s password, and then brute force it to get access to the roy home directory, where I can write my key to the authorized keys file to get SSH access. I’ll escalate to the postgres user with an SQL injection into Syslog, where the box author cleverly uses Git to show the config but not the most recent password. Finally, I’ll recover the password for root using some logic and the postgres user’s password. In Beyond Root, I’ll look at the authentication for the FTP server that allowed any 32 character user with the username as the password, dig into the RSync config, and look at the bits of the Syslog config that were hidden from me.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 15, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/02/15/htb-json.html">
                HTB: Json
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-json " class="post-tag">htb-json</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#commando " class="post-tag">commando</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#deobfuscation " class="post-tag">deobfuscation</a> <a href="/tags#jsnice " class="post-tag">jsnice</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#oauth " class="post-tag">oauth</a> <a href="/tags#ysoserial-net " class="post-tag">ysoserial.net</a> <a href="/tags#filezilla " class="post-tag">filezilla</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#des " class="post-tag">des</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#juicypotato " class="post-tag">juicypotato</a> <a href="/tags#potato " class="post-tag">potato</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> <a href="/tags#htb-arkham " class="post-tag">htb-arkham</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/json-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/json-cover.png" alt="Json" style="float: right;margin-right:50px; margin-left:50px; height:120px; background-color: rgba(255,255,255,0.5); padding: 5px 5px 10px 5px;" class="include_image " />
</picture>

<p>Json involved exploiting a .NET deserialization vulnerability to get initial access, and then going one of three ways to get root.txt. I’ll show each of the three ways I’m aware of to escalate: Connecting to the FileZilla Admin interface and changing the users password; reversing a custom application to understand how to decrypt a username and password, which can then be used over the same FTP interface; and JuicyPotato to get a SYSTEM shell. Since this is a Windows host, I’ll work it almost entirely from my Windows Commando VM.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/02/01/htb-re.html">
                HTB: RE
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-re " class="post-tag">htb-re</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#jekyll " class="post-tag">jekyll</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#libreoffice " class="post-tag">libreoffice</a> <a href="/tags#office " class="post-tag">office</a> <a href="/tags#ods " class="post-tag">ods</a> <a href="/tags#macro " class="post-tag">macro</a> <a href="/tags#invoke-obfuscation " class="post-tag">invoke-obfuscation</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#zipslip " class="post-tag">zipslip</a> <a href="/tags#winrar " class="post-tag">winrar</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#usosvc " class="post-tag">usosvc</a> <a href="/tags#accesschk " class="post-tag">accesschk</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#service-hijack " class="post-tag">service-hijack</a> <a href="/tags#diaghub " class="post-tag">diaghub</a> <a href="/tags#esf " class="post-tag">esf</a> <a href="/tags#mimikatz " class="post-tag">mimikatz</a> <a href="/tags#hashes-org " class="post-tag">hashes-org</a> <a href="/tags#htb-ai " class="post-tag">htb-ai</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> <a href="/tags#htb-helpline " class="post-tag">htb-helpline</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/re-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/re-cover.png" alt="RE" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>RE was a box I was really excited about, and I was crushed when the final privesc didn’t work on initial deployment. Still, it got patched, and two unintended paths came about as well, and everything turned out ok. I’ll approach this write-up how I expected people to solve it, and call out the alternative paths (and what mistakes on my part allowed them) as well. I’ll upload a malicious ods file to a malware sandbox where it is run as long as it is obfuscated. From there, I’ll abuse WinRar slip vulnerability to write a webshell. Now as IIS user, I can access a new folder where Ghidra project files can be dropped to exploit an XXE in Ghidra. There’s two unintended paths from IIS to SYSTEM using the UsoSvc and Zipslip and Diaghub, where then I have to get coby’s creds to read root.txt. I’ll show all of these, and look at some of the automation scripts (including what didn’t work on initial deployment) in Beyond Root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 26, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/01/26/digging-into-psexec-with-htb-nest.html">
                Digging into PSExec with HTB Nest
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-nest " class="post-tag">htb-nest</a> <a href="/tags#psexec " class="post-tag">psexec</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#scmanager " class="post-tag">scmanager</a> <a href="/tags#sddl " class="post-tag">sddl</a> <a href="/tags#dacl " class="post-tag">dacl</a> <a href="/tags#sacl " class="post-tag">sacl</a> <a href="/tags#ace " class="post-tag">ace</a> <a href="/tags#icacls " class="post-tag">icacls</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/nest-unintended-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/nest-unintended-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>“You have to have administrator to PSExec.” That’s what I’d always heard. Nest released on HTB yesterday, and on release, it had an unintended path where a low-priv user was able to PSExec, providing a shell as SYSTEM. This has now been patched, but I thought it was interesting to see what was configured that allowed this non-admin user to get a shell with PSExec. Given this is a live box, I won’t go into any of the details that still matter, saving that for a write-up in 20ish weeks or so.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 25, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/01/25/htb-ai.html">
                HTB: AI
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-ai " class="post-tag">htb-ai</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#text2speech " class="post-tag">text2speech</a> <a href="/tags#flite " class="post-tag">flite</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#jdwp " class="post-tag">jdwp</a> <a href="/tags#jdb " class="post-tag">jdb</a> <a href="/tags#jwdp-shellifier " class="post-tag">jwdp-shellifier</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ai-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ai-cover.png" alt="AI" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>AI was a really clever box themed after smart speakers like Echo and Google Home. I’ll find a web interface that accepts sound files, and use that to find SQL injection that I have to pass using words. Of course I’ll script the creation of the audio files, and use that to dump credentials from the database that I can use to access the server. For privesc, I’ll find an open Java Debug port on Tomcat running as root, and use that to get a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 18, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/01/18/htb-player.html">
                HTB: Player
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-player " class="post-tag">htb-player</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#vhosts " class="post-tag">vhosts</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#codiad " class="post-tag">codiad</a> <a href="/tags#bfac " class="post-tag">bfac</a> <a href="/tags#ffmpeg " class="post-tag">ffmpeg</a> <a href="/tags#lshell " class="post-tag">lshell</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#escape " class="post-tag">escape</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/player-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/player-cover.png" alt="Player" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Player involved a lot of recon, and pulling together pieces to go down multiple different paths to user and root. I’ll start identifying and enumerating four different virtual hosts. Eventually I’ll find a backup file with PHP source on one, and use it to get access to a private area. From there, I can use a flaw in FFMPEG to leak videos that contain the text contents of various files on Player. I can use that information to get credentials where I can SSH, but only with a <em>very</em> limited shell. However, I can use an SSH exploit to get code execution that provides limited and partial file read, which leads to more credentials. Those credentials are good for a Codiad instance running on another of the virtual hosts, which allows me to get a shell as www-data. There’s a PHP script running as a cron as root that I can exploit either by overwriting a file include, or by writing serialized PHP data. In Beyond Root, I’ll look at two more altnerative paths, one jumping right to shell against Codiad, and the other bypassing lshell.</p>

</li>
        
















          <li class="post-list-li"><span class="post-meta">Jan 14, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/holidayhack2019/">
                Holiday Hack 2019: KringleCon2
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#sans-holiday-hack " class="post-tag">sans-holiday-hack</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hh19-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hh19-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:200px;" class="include_image " />
</picture>

<p>The 2019 SANS Holiday Hack Challenge presented a twisted take on how a villain, the Tooth Fairy, tried to take down Santa and ruin Christmas. It all takes place at the second annual Kringle Con, where the worlds leading security practitioners show up to hear talks and solve puzzles. Hosted at Elf-U, this years conference included <a href="https://www.youtube.com/playlist?list=PLjLd1hNA7YVzyhhqBQaW-tF45xnS6oHAP">14 talks from leaders in information security</a>, as well as 11 terminals / in-game puzzles and 13 objectives to figure out. In solving all of these, the Tooth Fairy’s plot was foiled, and Santa was able to deliver presents on Christmas. As usual, the challenges were interesting and set up in such a way that it was very beginner friendly, with lots of hints and talks to ensure that you learned something while solving. While last year really started the trend of defensive themed challenges, 2019 had a ton of interesting defensive challenges, with hands on with machine learning as well as tools like Splunk and Graylog.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 11, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/01/11/htb-bitlab.html">
                HTB: Bitlab
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-bitlab " class="post-tag">htb-bitlab</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#bookmark " class="post-tag">bookmark</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#obfuscation " class="post-tag">obfuscation</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#gitlab " class="post-tag">gitlab</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#ping-sweep " class="post-tag">ping-sweep</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#psql " class="post-tag">psql</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#git-hooks " class="post-tag">git-hooks</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bitlab-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bitlab-cover.png" alt="Bitlab" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Bitlab was a box centered around automation of things, even if the series challenges were each rather unrealistic. It starts with a Gitlab instance where the help link has been changed to give access to javascript encoded credentials. Once logged in, I have access to the codebase for the custom profile pages use in this instance, and there’s automation in place such that when I merge a change into master, it goes live right away. So I can add a webshell and get access to the box. In the database, I’ll find the next users credentials for SSH access. For Root, I’ll reverse engineer a Windows executable which is executing Putty with credentials, and use those creds to get root. In Beyond Root, I’ll look at an unintended path from www-data to root using git hooks, and explore a call to <code class="language-plaintext highlighter-rouge">GetUserNameW</code> that is destined to fail.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 4, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2020/01/04/htb-craft.html">
                HTB: Craft
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-craft " class="post-tag">htb-craft</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gogs " class="post-tag">gogs</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-eval " class="post-tag">python-eval</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#vault-project " class="post-tag">vault-project</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#jwtcat " class="post-tag">jwtcat</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/craft-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/craft-cover.png" alt="Craft" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Craft was a really well designed medium box, with lots of interesting things to poke at, none of which were too difficult. I’ll find credentials for the API in the Gogs instance, as well as the API source, which allows me to identify a vulnerability in the API that gives code execution. Then I’ll use the shell on the API container to find creds that allow me access to private repos back on Gogs, which include an SSH key. With SSH access to the host, I’ll target the vault project software to get SSH access as root. In Beyond Root, I’ll look at the JWT, and my failed attempts to crack the secret.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2019/leet">
                Hackvent 2019 - leet
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#arduino " class="post-tag">arduino</a> <a href="/tags#hex-file " class="post-tag">hex-file</a> <a href="/tags#avr-simulator " class="post-tag">avr-simulator</a> <a href="/tags#binascii " class="post-tag">binascii</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#arm " class="post-tag">arm</a> <a href="/tags#ioctl " class="post-tag">ioctl</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackvent2019-leet-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackvent2019-leet-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:120px; border-radius: 100px;" class="include_image " />
</picture>

<p>There were only three leet challenges, but they were not trivial, and IOT focused. First, I’ll reverse a Arduino binary from hexcode. Then, there’s a web hacking challenge that quickly morphs into a crypto challenge, which I can solve by reimplementing the leaked PRNG from Ida Pro to generate a valid password. Finally, there’s a firmware for a Broadcom wireless chip that I’ll need to find the hooked ioctl function and pull the flag from it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2019/hard">
                Hackvent 2019 - Hard
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#websocket " class="post-tag">websocket</a> <a href="/tags#mqtt " class="post-tag">mqtt</a> <a href="/tags#cve-2017-7650 " class="post-tag">cve-2017-7650</a> <a href="/tags#x32dbg " class="post-tag">x32dbg</a> <a href="/tags#patching " class="post-tag">patching</a> <a href="/tags#unicode " class="post-tag">unicode</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#sql " class="post-tag">sql</a> <a href="/tags#mach-o " class="post-tag">mach-o</a> <a href="/tags#deb " class="post-tag">deb</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#salsa20 " class="post-tag">salsa20</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#emojicode " class="post-tag">emojicode</a> <a href="/tags#ps4 " class="post-tag">ps4</a> <a href="/tags#ecc " class="post-tag">ecc</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackvent2019-hard-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackvent2019-hard-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:120px; border-radius: 100px;" class="include_image " />
</picture>

<p>The hard levels of Hackvent conitnued with more web hacking, reverse engineering, crypto, and an esoteric programming language. In the reversing challenges, there was not only an iPhone debian package, but also a PS4 update file.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 1, 2020</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2019/medium">
                Hackvent 2019 - Medium
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#sql " class="post-tag">sql</a> <a href="/tags#credit-cards " class="post-tag">credit-cards</a> <a href="/tags#rule-30 " class="post-tag">rule-30</a> <a href="/tags#gimp " class="post-tag">gimp</a> <a href="/tags#strace " class="post-tag">strace</a> <a href="/tags#ltrace " class="post-tag">ltrace</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#vb " class="post-tag">vb</a> <a href="/tags#x32dbg " class="post-tag">x32dbg</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#jsf " class="post-tag">jsf</a> <a href="/tags#perl " class="post-tag">perl</a> <a href="/tags#obfuscation " class="post-tag">obfuscation</a> <a href="/tags#deparse " class="post-tag">deparse</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackvent2019-medium-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackvent2019-medium-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:120px; border-radius: 100px;" class="include_image " />
</picture>

<p>The medium levels brought the first reverse enginnering challenges, the first  web hacking challenges, some image manipulation, and of course, some obfuscated Perl.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 31, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2019/easy">
                Hackvent 2019 - Easy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#forensics " class="post-tag">forensics</a> <a href="/tags#stereolithography " class="post-tag">stereolithography</a> <a href="/tags#stl " class="post-tag">stl</a> <a href="/tags#clara-io " class="post-tag">clara-io</a> <a href="/tags#aztec-code " class="post-tag">aztec-code</a> <a href="/tags#hodor " class="post-tag">hodor</a> <a href="/tags#ahk " class="post-tag">ahk</a> <a href="/tags#autohotkey " class="post-tag">autohotkey</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-pil " class="post-tag">python-pil</a> <a href="/tags#bacon " class="post-tag">bacon</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#stegsnow " class="post-tag">stegsnow</a> <a href="/tags#base58 " class="post-tag">base58</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackvent2019-easy-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackvent2019-easy-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; height:120px; border-radius: 100px;" class="include_image " />
</picture>

<p>Hackvent is a fun CTF, offering challenges that start off quite easy and build to much harder over the course of 24 days, with bonus points for submitting the flag within the first 24 hours for each challenge. This was the first year I made it past day 12, and I was excited to finish all the challenges with all time bonuses! I’ll break the solutions into four parts. The first is the easy challenges, days 1-7, which provided some basic image forensics, some interesting file types, an esoteric programming language, and two hidden flags.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 14, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/14">
                Advent of Code 2019: Day 14
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#defaultdict " class="post-tag">defaultdict</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-14-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-14-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>Day 14 is all about stacking requirements and then working them to understand the inputs required to get the output desired. I’ll need to organize my list of reactions in such a way that I can work back from the desired end output to how much ore is required to get there.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 14, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/12/14/htb-smasher2.html">
                HTB: Smasher2
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-smasher2 " class="post-tag">htb-smasher2</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#auth-bypass " class="post-tag">auth-bypass</a> <a href="/tags#logic-error " class="post-tag">logic-error</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#reference-counting " class="post-tag">reference-counting</a> <a href="/tags#kernal-driver " class="post-tag">kernal-driver</a> <a href="/tags#mmap " class="post-tag">mmap</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/smasher2-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/smasher2-cover.png" alt="Smasher2" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Like the first Smasher, Smasher2 was focused on exploitation. However this one didn’t have a buffer overflow or what I typically think of as binary exploitation. It starts with finding a vulnerability in a compiled Python module (written in C) to get access to an API key. Then I’ll have to bypass a WAF to use that API to get execution and then a shell onSmasher2. For PrivEsc, I’ll need to exploit a kernel driver to get a root shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 13, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/13">
                Advent of Code 2019: Day 13
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#intcode-computer " class="post-tag">intcode-computer</a> <a href="/tags#defaultdict " class="post-tag">defaultdict</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-13-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-13-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>Continuing with the computer, now I’m using it to power an arcade game. I’ll use the given intcodes to run the game, and I’m responsible for moving the joystick via input to the game. This challenge was awesome. I made a video of the game running in my terminal, which wasn’t necessary, but turned out pretty good.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 12, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/12">
                Advent of Code 2019: Day 12
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-12-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-12-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>Day 12 asks me to look at moons and calculate their positions based on a simplified gravity between them. In the first part, I’ll run the system for 1000 steps and return a calculation (“energy”) based on each moons position and velocity at that point. In the second part, I’ll have to find when the positions repeat, which I can do by recognizing that the three axes are independent of each other, and that I can find the cycle time for each axis, and then find the least common multiple of them to get when all three are in order.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 11, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/11">
                Advent of Code 2019: Day 11
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#intcode-computer " class="post-tag">intcode-computer</a> <a href="/tags#defaultdict " class="post-tag">defaultdict</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-11-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-11-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>Continuing with the computer, now I’m using it to power a robot. My robot will walk around, reading the current color, submitting that to the program, and getting back the color to paint the current square and instructions for where to move next.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 10, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/10">
                Advent of Code 2019: Day 10
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-10-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-10-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>This challenge gives me a map of asteroids. I’ll need to play with different ways to find which ones are directly in the path of others, first to see which asteroids can see the most others, and then to destroy them one by one with a laser.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 9, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/9">
                Advent of Code 2019: Day 9
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#intcode-computer " class="post-tag">intcode-computer</a> <a href="/tags#defaultdict " class="post-tag">defaultdict</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-9-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-9-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>More computer work in day 9, this time adding what is kind of a stack pointer and an opcode to adjust that pointer. Now I can add a relative address mode, getting positions relative to the stack pointer.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 8, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/8">
                Advent of Code 2019: Day 8
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-8-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-8-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>After spending hours on day 7, I finished day 8 in about 15 minutes. It was simply reading in a series of numbers which represented pixels in various layers in an email. In part one I’ll break the pixels into layers, and evaluate each one. In part two, I’ll actually create the image.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 8, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/7">
                Advent of Code 2019: Day 7
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#intcode-computer " class="post-tag">intcode-computer</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-7-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-7-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>The computer is back again, and this time, I’m chaining it and using it as an amplifier. In the each part, I’ll find the way to get maximum thrust from five amplifiers given that each can take one of five given phases. In part two, there’s a loop of amplification.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 7, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/12/07/htb-wall.html">
                HTB: Wall
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-wall " class="post-tag">htb-wall</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#centreon " class="post-tag">centreon</a> <a href="/tags#cve-2019-13024 " class="post-tag">cve-2019-13024</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#uncompyle6 " class="post-tag">uncompyle6</a> <a href="/tags#screen " class="post-tag">screen</a> <a href="/tags#modsecurity " class="post-tag">modsecurity</a> <a href="/tags#htaccess " class="post-tag">htaccess</a> <a href="/tags#htb-flujab " class="post-tag">htb-flujab</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/wall-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/wall-cover.png" alt="Wall" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Wall presented a series of challenges wrapped around two public exploits. The first exploit was a CVE in Centreon software. But to find it, I had to take advantage of a misconfigured webserver that only requests authenticatoin on GET requests, allowing POST requests to proceed, which leads to the path to the Centreon install. Next, I’ll use the public exploit, but it fails because there’s a WAF blocking requests with certain keywords. I’ll probe to identify the blocks workds, which includes the space character, and use the Linux environment variable ${IFS} instead of space to get command injection. Once I have that, I can get a shell on the box. There’s a compiled Python file in the users home directory, which I can decompile to find the password for the second user. From either of these users, I can exploit SUID screen to get a root shell. In Beyond Root, I’ll look at the webserver configuration, the WAF, improve the exploit script, and look at some trolls the author left around.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 6, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/6">
                Advent of Code 2019: Day 6
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#recursion " class="post-tag">recursion</a> <a href="/tags#defaultdict " class="post-tag">defaultdict</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-6-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-6-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;height: 120px;" class="include_image " />
</picture>

<p>This was a fun challenge, because it seemed really hard at first, but once I figured out how to think about it, it was quite simple. I’m given a set of pairings, each of which contains two objects, the second orbits around the first. I’ll play with counting the number of orbits going on, as well as working a path through the orbits. This was the first time I brought out recurrisive programming this year, and it really fit well.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 5, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/5">
                Advent of Code 2019: Day 5
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#intcode-computer " class="post-tag">intcode-computer</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-5-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-5-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;" class="include_image " />
</picture>

<p>Today I’m tasked with building on the simple computer I built in <a href="/adventofcode2019/2">day 2</a>. I’ll add new instructions for input / output and comparisons / branching. I’ll also get parameter modes, so in addition to reading values from other positions, I can now handle constants (known in computer architecture as immediates).</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 3, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/4">
                Advent of Code 2019: Day 4
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-4-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-4-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;" class="include_image " />
</picture>

<p>I solved day 4 much faster than day 3, probably because it moved away from spacial reasoning and just into input validation. I’m given a range of 6-digit numbers, and asked to pick ones that meet certain criteria.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 3, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/3">
                Advent of Code 2019: Day 3
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-3-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-3-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;" class="include_image " />
</picture>

<p>I always start to struggle when AOC moves into spacial challenges, and this is where the code starts to get a bit ugly. In this challenge, I have to think about two wires moving across a coordinate plane, and look for positions where they intersect. Then I’ll score each intersection, first by Manhattan distance to the origin, and then by total number of steps from the origin along both wires, and return the minimum.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 2, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/2">
                Advent of Code 2019: Day 2
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#intcode-computer " class="post-tag">intcode-computer</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-2-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-2-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;" class="include_image " />
</picture>

<p>This puzzle is to implement a little computer with three op codes, add, multiply, and finish. In the first part, I’m given two starting register values, 12 and 2. In the second part, I need to brute force those values to find a given target output.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 1, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2019/1">
                Advent of Code 2019: Day 1
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/aoc2019-1-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/aoc2019-1-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px;" class="include_image " />
</picture>

<p>This puzzle was basically reading a list of numbers, performing some basic arithmetic, and summing the results. For part two, there’s a twist in that I’ll need to do that same math on the results, and add then as long as they are greater than 0.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 30, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/11/30/htb-heist.html">
                HTB: Heist
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-heist " class="post-tag">htb-heist</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#cisco " class="post-tag">cisco</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#cisco-type-7 " class="post-tag">cisco-type-7</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#rpcclient " class="post-tag">rpcclient</a> <a href="/tags#ipc " class="post-tag">ipc</a> <a href="/tags#lookupsids " class="post-tag">lookupsids</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#firefox " class="post-tag">firefox</a> <a href="/tags#procdump " class="post-tag">procdump</a> <a href="/tags#out-minidump " class="post-tag">out-minidump</a> <a href="/tags#mimikittenz " class="post-tag">mimikittenz</a> <a href="/tags#credentials " class="post-tag">credentials</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/heist-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/heist-cover.png" alt="Heist" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Heist brought new concepts I hadn’t seen on HTB before, yet keep to the easy difficulty. I’ll start by find a Cisco config on the website, which has some usernames and password hashes. After recovering the passwords, I’ll find that one works to get RPC access, which I’ll use to find more usernames. One of those usernames with one of the original passwords works to get a WinRM session on the Heist. From there, I’ll notice that Firefox is running, and dump the process memory to find the password for the original website, which is also the administrator password for the box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 26, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/11/26/htb-chainsaw-rootkit.html">
                LD_PRELOAD Rootkit on Chainsaw
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-chainsaw " class="post-tag">htb-chainsaw</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#rootkit " class="post-tag">rootkit</a> <a href="/tags#ldpreload " class="post-tag">ldpreload</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#nm " class="post-tag">nm</a> <a href="/tags#strace " class="post-tag">strace</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/chainsaw-rootkit-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/chainsaw-rootkit-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>There was something a bit weird going on with Chainsaw from HackTheBox. It turns out there’s a LD_PRELOAD rootkit running to hide the NodeJS processes that serve the smart contracts. Why? I have no idea. But since it’s a really neat concept, I wanted to pull it apart. Big thanks to jkr for helping me get started in this rabbit hole (the good kind), and to h0mbre for his recent blog post about these rootkits.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 23, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/11/23/htb-chainsaw.html">
                HTB: Chainsaw
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-chainsaw " class="post-tag">htb-chainsaw</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#solididy " class="post-tag">solididy</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#web3 " class="post-tag">web3</a> <a href="/tags#remix " class="post-tag">remix</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#ipfs " class="post-tag">ipfs</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#email " class="post-tag">email</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#bmap " class="post-tag">bmap</a> <a href="/tags#df " class="post-tag">df</a> <a href="/tags#debugfs " class="post-tag">debugfs</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#pyinstaller " class="post-tag">pyinstaller</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/chainsaw-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/chainsaw-cover.png" alt="Chainsaw" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Chainsaw was centered around blockchain and smart contracts, with a bit of InterPlanetary File System thrown in. I’ll get the details of a Solididy smart contract over an open FTP server, and find command injection in it to get a shell. I’ll find an SSH key for the bobby user in IPFS files. bobby has access to a SUID binary that I can interact with two ways to get a root shell. But even as root, the flag is hidden, so I’ll have to dig into the slack space around root.txt to find the flag. In Beyond root, I’ll look at the ChainsawClub binaries to see how they apply the same Web3 techniques I used to get into the box in the first place.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 16, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/11/16/htb-networked.html">
                HTB: Networked
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-networked " class="post-tag">htb-networked</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#apache " class="post-tag">apache</a> <a href="/tags#dirsearch " class="post-tag">dirsearch</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#ifcfg " class="post-tag">ifcfg</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/networked-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/networked-cover.png" alt="Networked" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Networked involved abusing an Apache misconfiguration that allowed me to upload an image containing a webshell with a double extension. With that, I got a shell as www-data, and then did two privescs. The first abused command injection into a script that was running to clean up the uploads directory. Then I used access to an ifcfg script to get command execution as root. In Beyond Root, I’ll look a bit more at that Apache configuration.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 9, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/11/09/htb-jarvis.html">
                HTB: Jarvis
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-jarvis " class="post-tag">htb-jarvis</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#phpmyadmin " class="post-tag">phpmyadmin</a> <a href="/tags#cve-2018-12613 " class="post-tag">cve-2018-12613</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#systemctl " class="post-tag">systemctl</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/jarvis-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/jarvis-cover.png" alt="Jarvis" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Jarvis provide three steps that were all relatively basic. First, there’s an SQL injection with a WAF that breaks <code class="language-plaintext highlighter-rouge">sqlmap</code>, at least in it’s default configuration. Then there’s a command injection into a Python script. And finally there’s creating a malicious service. In Beyond root, I’ll look at the WAF and the cleanup script.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 2, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/11/02/htb-haystack.html">
                HTB: Haystack
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-haystack " class="post-tag">htb-haystack</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#elasticsearch " class="post-tag">elasticsearch</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#kibana " class="post-tag">kibana</a> <a href="/tags#cve-2018-17246 " class="post-tag">cve-2018-17246</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#logstash " class="post-tag">logstash</a> <a href="/tags#herokuapp " class="post-tag">herokuapp</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/haystack-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/haystack-cover.png" alt="Haystack" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Haystack wasn’t a realistic pentesting box, but it did provide insight into tools that are common on the blue side of things with Elastic Stack. I’ll find a hint in an image on a webpage, an use that to find credentials in an elastic search instance. Those creds allow SSH access to Haystack, and access to a local Kibana instance. I’ll use a CVE against Kibana to get execution as kibana. From there, I have access to the LogStash config, which is misconfigured to allow a execution via a properly configured log as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 26, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/10/26/htb-safe.html">
                HTB: Safe
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-safe " class="post-tag">htb-safe</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#rop " class="post-tag">rop</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#keepass " class="post-tag">keepass</a> <a href="/tags#kpcli " class="post-tag">kpcli</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#htb-redcross " class="post-tag">htb-redcross</a> <a href="/tags#htb-ellingson " class="post-tag">htb-ellingson</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/safe-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/safe-cover.png" alt="Safe" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Safe was two steps - a relatively simple ROP, followed by cracking a Keepass password database. Personally I don’t believe binary exploitation belongs in a 20-point box, but it is what it is. I’ll show three different ROP strategies to get a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 19, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/10/19/htb-ellingson.html">
                HTB: Ellingson
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-ellingson " class="post-tag">htb-ellingson</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#werkzeug " class="post-tag">werkzeug</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#debugger " class="post-tag">debugger</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#rop " class="post-tag">rop</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#aslr " class="post-tag">aslr</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#peda " class="post-tag">peda</a> <a href="/tags#ret2libc " class="post-tag">ret2libc</a> <a href="/tags#checksec " class="post-tag">checksec</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#onegadget " class="post-tag">onegadget</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#htb-october " class="post-tag">htb-october</a> <a href="/tags#htb-redcross " class="post-tag">htb-redcross</a> <a href="/tags#flask-debug " class="post-tag">flask-debug</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ellingson-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ellingson-cover.png" alt="Ellingson" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Ellingson was a really solid hard box. I’ll start with ssh and http open, and find that they’ve left the Python debugger running on the webpage, giving me the opporutunity to execute commands. I’ll use that access to write my ssh key to the authorized_keys file, and get a shell as hal. I’ll find that hal has access to the shadow.bak file, and from there, I can break margo’s password. Once sshed in as margo, I will find a suid binary that I can overflow to get a root shell. In Beyond Root, I’ll explore two cronjobs. The first breaks the privesc from hal to margo, resetting the permissions on the shadow.bak file to a safe configuration. The second looks like a hint that was disabled, or maybe forgotten.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 12, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/10/12/htb-writeup.html">
                HTB: Writeup
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-writeup " class="post-tag">htb-writeup</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#cmsms " class="post-tag">cmsms</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#injection " class="post-tag">injection</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/writeup-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/writeup-cover.png" alt="Writeup" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Writeup was a great easy box. Neither of the steps were hard, but both were interesting. To get an initial shell, I’ll exploit a blind SQLI vulnerability in CMS Made Simple to get credentials, which I can use to log in with SSH. From there, I’ll abuse access to the staff group to write code to a path that’s running when someone SSHes into the box, and SSH in to trigger it. In Beyond Root, I’ll look at other ways to try to hijack the root process.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 10, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2019/wopr.html">
                Flare-On 2019: wopr
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-wopr " class="post-tag">flare-on-wopr</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pyinstaller " class="post-tag">pyinstaller</a> <a href="/tags#python-exe-unpacker " class="post-tag">python-exe-unpacker</a> <a href="/tags#uncompyle6 " class="post-tag">uncompyle6</a> <a href="/tags#pdb " class="post-tag">pdb</a> <a href="/tags#exe " class="post-tag">exe</a> <a href="/tags#z3 " class="post-tag">z3</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2019-7-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2019-7-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>wopr was like an onion - the layers kept peeling back revealing more layers. I’m given an exe which was created by PyInstaller, which I’ll unpack to get to the Python code. That code has a layer of unpacking based on a binary implementation of tabs and spaces in the doc strings. Once I get to the next layer, I need to calculate the hash of the text segment for the currently running binary, and use that as a key to some equations. Using a solver to solve the system, I can find the input necessary to return the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 9, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2019/bmphide.html">
                Flare-On 2019: bmphide
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-bmphide " class="post-tag">flare-on-bmphide</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#anti-debug " class="post-tag">anti-debug</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2019-6-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2019-6-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>bmphide was my favorite challenge this year (that I got to). It was challenging, yet doable and interesting. I’m given a bitmap image and a Windows .NET executable. That executable is used to hide information in the low bits of the image. I’ll have to reverse the exe to understand how to extract the data. I’ll also have to work around some anti-debug.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 6, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2019/demo.html">
                Flare-On 2019: demo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-demo " class="post-tag">flare-on-demo</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2019-5-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2019-5-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>demo really threw me, to the point that I almost skipped writing it up. The file given is a demoscene, which is a kind of competition to get the best visual performce out of an executable limited in size. To achieve this, packers are used to compress the binary. In the exe for this challenge, a 3D Flare logo comes up and spins, but the flag is missing. I’ll have to unpack the binary and start messing with random DirectX functions until I find two ways to make the flag show up.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 5, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/10/05/htb-ghoul.html">
                HTB: Ghoul
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-ghoul " class="post-tag">htb-ghoul</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#zipslip " class="post-tag">zipslip</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#cewl " class="post-tag">cewl</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#gogs " class="post-tag">gogs</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#gogsownz " class="post-tag">gogsownz</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#ssh-agent-hijack " class="post-tag">ssh-agent-hijack</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#htb-reddish " class="post-tag">htb-reddish</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ghoul-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ghoul-cover.png" alt="Ghoul" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Ghoul was a long box, that involved pioviting between multiple docker containers exploiting things and collecting information to move to the next step. With a level of pivoting not seen in HackTheBox since <a href="/2019/01/26/htb-reddish.html">Reddish</a>, I’ll need to pay careful attention to various passwords and other bits of information as I move through the containers. I’ll exploit a webapp using the ZipSlip vulnerability to get a webshell up and get a shell as www-data, only to find that the exploited webserver is running as root, and with another ZipSlip, I can escalate to root. Still with no flags, I’ll crack an ssh key and pivot to the second container. From there, I can access a third container hosting the self hosted git solution, gogs. With some password reuse and the gogsownz exploit, I’ll get a shell on that container, and use a suid binary to get root. That provides access to a git repo that has a password I can use for root on the second container. As root, I can see ssh sessions connecting through this container and to the main host using ssh agent forwarding, and I’ll hijack that to get root on the final host. In beyond root, I’ll explore the ssh situation on the final host and get myself persistence, look at the crons running to simulate the user using ssh agent forwarding, and show a network map of the entire system.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 4, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2019/dnschess.html">
                Flare-On 2019: DNS Chess
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-dnschess " class="post-tag">flare-on-dnschess</a> <a href="/tags#peda " class="post-tag">peda</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2019-4-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2019-4-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>DNS Chess was really fun. I’m given a pcap, and elf executable, and an elf shared library. The two binaries form a game of chess, where commands are sent to an AI over DNS. I’ll need to figure out how to spoof valid moves by reversing the binary, and then use valid moves to win the game.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 2, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2019/flarebear.html">
                Flare-On 2019: Flarebear
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-flarebear " class="post-tag">flare-on-flarebear</a> <a href="/tags#apk " class="post-tag">apk</a> <a href="/tags#genymotion " class="post-tag">genymotion</a> <a href="/tags#android " class="post-tag">android</a> <a href="/tags#jadx " class="post-tag">jadx</a> <a href="/tags#algebra " class="post-tag">algebra</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2019-3-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2019-3-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Flarebear wsa the first Android challenge, and I’m glad to see it at the beginning while it’s still not too hard. I’ll use GenyMotion cloud to emunlate the application, and then jadx to decompile it and see what the win condition is. Once I find that, I can get the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 30, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2019/overlong.html">
                Flare-On 2019: Overlong
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-overlong " class="post-tag">flare-on-overlong</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2019-2-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2019-2-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Overlong was a challenge that could lead to complex rabbit holes, or, with some intelligent guess work, be solved quite quickly. From the start, with the title and the way that the word <em>overlong</em> was bolded in the prompt, I was looking for an integer to overflow or change in some way. That, plus additional clues, made this one pretty quick work.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 28, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/09/28/htb-swagshop.html">
                HTB: SwagShop
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-swagshop " class="post-tag">htb-swagshop</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#magento " class="post-tag">magento</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/swagshop-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/swagshop-cover.png" alt="SwagShop" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>SwagShop was a nice beginner / easy box centered around a Magento online store interface. I’ll use two exploits to get a shell. The first is an authentication bypass that allows me to add an admin user to the CMS. Then I can use an authenticated PHP Object Injection to get RCE. I’ll also show how got RCE with a malicious Magento package. RCE leads to shell and user. To privesc to root, it’s a simple exploit of <code class="language-plaintext highlighter-rouge">sudo vi</code>.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 28, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/flare-on-2019/memecat-battlestation.html">
                Flare-On 2019: Memecat Battlestation [Shareware Demo Edition]
              </a>
            </h3>

<span class="tag-list"><a href="/tags#flare-on " class="post-tag">flare-on</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#flare-on-memecat-battlestation " class="post-tag">flare-on-memecat-battlestation</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flare2019-1-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flare2019-1-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Memecat Battlestation [Shareware Demo Edition] was a really simple challenge that really involved opening a .NET executable in a debugger and reading the correct phrases from the code. It was a good beginner challenge.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 21, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/09/21/htb-kryptos.html">
                HTB: Kryptos
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-kryptos " class="post-tag">htb-kryptos</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#rc4 " class="post-tag">rc4</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#php-disable-functions " class="post-tag">php-disable-functions</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#vimcrypt " class="post-tag">vimcrypt</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#python-eval " class="post-tag">python-eval</a> <a href="/tags#filter " class="post-tag">filter</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/kryptos-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/kryptos-cover.png" alt="Kryptos" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Kryptos feels different from most insane boxes. It brought an element of math / crypt into most of the challenges in a way that I really enjoyed. But it still layered challenges so that each step involved multiple exploits / bypasses, like all good insane boxes do. I’ll start by getting access to a web page by telling the page to validate logins against a database on my box. The website gives me that ability to return encrypted webpage content that Kryptos can retrieve. I’ll break the encryption to access pages I’m not able to access on my own, finding a sqlite test page that I can inject into to write a webshell that can access the file system. With file system access, I’ll retrieve a Vim-crypted password backup, and crack that to get ssh access to the system. On the system, I’ll access an API available only on localhost and take advantage of a weak random number generator to sign my own commands, bypassing python protections to get code execution as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 14, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/09/14/htb-luke.html">
                HTB: Luke
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-luke " class="post-tag">htb-luke</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#ajenti " class="post-tag">ajenti</a> <a href="/tags#hydra " class="post-tag">hydra</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/luke-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/luke-cover.png" alt="Luke" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Luke was a recon heavy box. In fact, the entire writeup for Luke could reasonably go into the Recon section. I’m presented with three different web interfaces, which I enumerate and bounce between to eventually get credentials for an Ajenti administrator login. Once I’m in Ajenti, I have access to a root shell, and both flags.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 11, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/09/11/htb-holiday.html">
                HTB: Holiday
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-holiday " class="post-tag">htb-holiday</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#dirsearch " class="post-tag">dirsearch</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#npm " class="post-tag">npm</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#oswe-plus " class="post-tag">oswe-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/holiday-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/holiday-cover.png" alt="Holiday" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" class="include_image " />
</picture>

<p>Holiday was a fun, hard, old box. The path to getting a shell involved SQL injection, cross site scripting, and command injection. The root was a bit simpler, taking advantage of a sudo on node package manager install to install a malicious node package.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 7, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/09/07/htb-bastion.html">
                HTB: Bastion
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-bastion " class="post-tag">htb-bastion</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#vhd " class="post-tag">vhd</a> <a href="/tags#mount " class="post-tag">mount</a> <a href="/tags#guestmount " class="post-tag">guestmount</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#mremoteng " class="post-tag">mremoteng</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bastion-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bastion-cover.png" alt="Bastion" style="float: right;margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Bastion was a solid easy box with some simple challenges like mounting a VHD from a file share, and recovering passwords from a password vault program. It starts, somewhat unusually, without a website, but rather with vhd images on an SMB share, that, once mounted, provide access to the registry hive necessary to pull out credentials. These creds provide the ability to ssh into the host as the user. To get administrator access, I’ll exploit the mRemoteNG installation, pulling the profile data and encrypted data, and show several ways to decrypt those. Once I break out the administrator password, I can ssh in as administrator.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 31, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/08/31/htb-onetwoseven.html">
                HTB: OneTwoSeven
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-onetwoseven " class="post-tag">htb-onetwoseven</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#sftp " class="post-tag">sftp</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#chroot " class="post-tag">chroot</a> <a href="/tags#vim " class="post-tag">vim</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#apt " class="post-tag">apt</a> <a href="/tags#mitm " class="post-tag">mitm</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/onetwoseven-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/onetwoseven-cover.png" alt="OneTwoSeven-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>OneTwoSeven was a very cleverly designed box. There were lots of steps, some enumeration, all of which was do-able and fun. I’ll start by finding a hosting provider that gives me SFTP access to their system. I’ll use that to tunnel into the box, and gain access to the admin panel. I’ll find creds for that using symlinks over SFTP. From there, I’ll exploit a logic error in the plugin upload to install a webshell. To get root, I’ll take advantage of my user’s ability to run apt update and apt upgrade as root, and man-in-the-middle the connection to install a backdoored package.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 24, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/08/24/htb-unattended.html">
                HTB: Unattended
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-unattended " class="post-tag">htb-unattended</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#nginx " class="post-tag">nginx</a> <a href="/tags#nginx-aliases " class="post-tag">nginx-aliases</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#session-poisoning " class="post-tag">session-poisoning</a> <a href="/tags#socat " class="post-tag">socat</a> <a href="/tags#hidepid " class="post-tag">hidepid</a> <a href="/tags#noexec " class="post-tag">noexec</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#initrd " class="post-tag">initrd</a> <a href="/tags#cpio " class="post-tag">cpio</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/unattended-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/unattended-cover.png" alt="Unattended-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Users rated Unattended much harder than the Medium rating it was released under. I think that’s because the SQLI vulnerability was easy to find, but dumping the database would take forever. So the trick was knowing when to continue looking and identify the NGINX vulnerability to leak the source code. At that point, the SQLI was much more manageable, providing LFI which I used with PHP session variables to get RCE and a shell. From there, it was injecting into some commands being taken from the database to move to the next user. And in the final step, examining an initrd file to get the root password. In Beyond Root, I’ll reverse the binary that generates the password, and give some references for initrd backdoors.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 17, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/08/17/htb-helpline.html">
                HTB: Helpline
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-helpline " class="post-tag">htb-helpline</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#manageengine " class="post-tag">manageengine</a> <a href="/tags#servicedesk " class="post-tag">servicedesk</a> <a href="/tags#default-creds " class="post-tag">default-creds</a> <a href="/tags#excel " class="post-tag">excel</a> <a href="/tags#cve-2017-9362 " class="post-tag">cve-2017-9362</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#cve-2017-11511 " class="post-tag">cve-2017-11511</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/helpline-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px; width:120px; height:120px;" /> Helpline was a really difficult box, and it was an even more difficult writeup. It has <em>so</em> many paths, and yet all were difficult in some way. It was also one that really required Windows as an attack platform to do the intended way. I got lucky in that this was the box I had chosen to try out <a href="/2019/04/15/commando-vm-lessons.html">Commando VM</a>. Give the two completely different attack paths on Windows and Kali, I’ll break this into three posts. In the first post, I’ll do enumeration up to an initial shell. Then in one post I’ll show how I solved it from Commando (Windows) using the intended paths. In the other post, I’ll show how to go right to a shell as SYSTEM, and work backwards to get the root flag and eventually the user flag.</p>

</li>
        



          <li class="post-list-li"><span class="post-meta">Aug 10, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/08/10/htb-arkham.html">
                HTB: Arkham
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-arkham " class="post-tag">htb-arkham</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#faces " class="post-tag">faces</a> <a href="/tags#jsf " class="post-tag">jsf</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#luks " class="post-tag">luks</a> <a href="/tags#bruteforce-luks " class="post-tag">bruteforce-luks</a> <a href="/tags#cryptsetup " class="post-tag">cryptsetup</a> <a href="/tags#hmac " class="post-tag">hmac</a> <a href="/tags#htb-canape " class="post-tag">htb-canape</a> <a href="/tags#ysoserial " class="post-tag">ysoserial</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#nc " class="post-tag">nc</a> <a href="/tags#http-server " class="post-tag">http.server</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#ost " class="post-tag">ost</a> <a href="/tags#readpst " class="post-tag">readpst</a> <a href="/tags#mbox " class="post-tag">mbox</a> <a href="/tags#mutt " class="post-tag">mutt</a> <a href="/tags#pssession " class="post-tag">pssession</a> <a href="/tags#rlwrap " class="post-tag">rlwrap</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#evil-winrm " class="post-tag">evil-winrm</a> <a href="/tags#uac " class="post-tag">uac</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#greatsct " class="post-tag">greatsct</a> <a href="/tags#msbuild " class="post-tag">msbuild</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#cmstp " class="post-tag">cmstp</a> <a href="/tags#systempropretiesadvanced " class="post-tag">systempropretiesadvanced</a> <a href="/tags#dll " class="post-tag">dll</a> <a href="/tags#mingw32 " class="post-tag">mingw32</a> <a href="/tags#oswe-plus " class="post-tag">oswe-plus</a> <a href="/tags#htb-sizzle " class="post-tag">htb-sizzle</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/arkham-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/arkham-cover.png" alt="Arkham-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>In my opinion, Arkham was the most difficult Medium level box on HTB, as it could have easily been Hard and wouldn’t have been out of place at Insane. But it is still a great box. I’ll start with an encrypted LUKZ disk image, which I have to crack. On it I’ll find the config for a Java Server Faces (JSF) site, which provides the keys that allow me to perform a deserialization attack on the ViewState, providing an initial shell. I’ll find an email file with the password for a user in the administrators group. Once I have that shell, I’ll have to bypass UAC to grab root.txt.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 3, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/08/03/htb-fortune.html">
                HTB: Fortune
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-fortune " class="post-tag">htb-fortune</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#certificate-authority " class="post-tag">certificate-authority</a> <a href="/tags#sslyze " class="post-tag">sslyze</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#burp-repeater " class="post-tag">burp-repeater</a> <a href="/tags#firewall " class="post-tag">firewall</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#authpf " class="post-tag">authpf</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#nfs " class="post-tag">nfs</a> <a href="/tags#pgadmin " class="post-tag">pgadmin</a> <a href="/tags#postgresql " class="post-tag">postgresql</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#sqlite " class="post-tag">sqlite</a> <a href="/tags#pfctl " class="post-tag">pfctl</a> <a href="/tags#tcpdump " class="post-tag">tcpdump</a> <a href="/tags#htb-lacasadepapel " class="post-tag">htb-lacasadepapel</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/fortune-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/fortune-cover.png" alt="Fortune-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Fortune was a different kind of insane box, focused on taking advantage things like authpf and nfs. I’ll start off using command injection to find a key and certificate that allow access to an HTTPS site. On that site, I get instructions and an ssh key to connect via authpf, which doesn’t provide a shell, but opens up new ports in the firewall. From there I can find nfs access to <code class="language-plaintext highlighter-rouge">/home</code>, which I can use with uid spoofing to get ssh access. For privesc, I’ll find credentials in pgadmin’s database which I can use to get a root shell. In Beyond Root, I’ll look the firewall configuration and why I couldn’t turn command injection into a shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 2, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/08/02/bypassing-php-disable_functions-with-chankro.html">
                Bypassing PHP disable_functions with Chankro
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-lacasadepapel " class="post-tag">htb-lacasadepapel</a> <a href="/tags#chankro " class="post-tag">chankro</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#php-disable-functions " class="post-tag">php-disable-functions</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/chankro-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" />I was reading <a href="https://alamot.github.io/lacasadepapel_writeup/#getting-dali-shell-by-escaping-php-restrictions">Alamot’s LaCasaDePapel writeup</a>, and they went a different way once they got the php shell. Instead of just using the php functions to find the certificate and key needed to read the private members https page, Alamot uses Chankro to bypass the disabled execution functions and run arbitrary code anyway. I had to try it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 27, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/07/27/htb-lacasadepapel.html">
                HTB: LaCasaDePapel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-lacasadepapel " class="post-tag">htb-lacasadepapel</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#vsftpd " class="post-tag">vsftpd</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#psy " class="post-tag">psy</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#php-disable-functions " class="post-tag">php-disable-functions</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#client-certificate " class="post-tag">client-certificate</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#supervisord " class="post-tag">supervisord</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#js " class="post-tag">js</a> <a href="/tags#certificate-authority " class="post-tag">certificate-authority</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/lacasadepapel-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/lacasadepapel-cover.png" alt="LaCasaDePapel-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>LaCasaDePapel was a fun easy box that required quite a few steps for a 20 point box, but none of which were too difficult. I’ll start off exploiting a classic backdoor bug in VSFTPd 2.3.4 which has been modified to return a shell in Psy, a php based debugging tool. From there, I can collect a key file which I’ll use to sign a client certificate, gaining access to the private website. I’ll exploit a path traversal bug in the site to get an ssh key for one of the users. To privesc, I’ll find a file that’s controlling how a cron is being run by root. The file is not writable and owned by root, but sits in a directory my current user owns, which allows me to delete the file and then create a new one. In Beyond Root, I’ll look at the modified VSFTPd server and show an alternative path that allows me to skip the certificate generation to get access to the private website.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 20, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/07/20/htb-ctf.html">
                HTB: CTF
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-ctf " class="post-tag">htb-ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#ldap-injection " class="post-tag">ldap-injection</a> <a href="/tags#second-order " class="post-tag">second-order</a> <a href="/tags#second-order-ldap-injection " class="post-tag">second-order-ldap-injection</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#totp " class="post-tag">totp</a> <a href="/tags#stoken " class="post-tag">stoken</a> <a href="/tags#7z " class="post-tag">7z</a> <a href="/tags#listfile " class="post-tag">listfile</a> <a href="/tags#wildcard " class="post-tag">wildcard</a> <a href="/tags#htb-nightmare " class="post-tag">htb-nightmare</a> <a href="/tags#htb-stratosphere " class="post-tag">htb-stratosphere</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ctf-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ctf-cover.png" alt="CTF-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>CTF was hard in a much more straight-forward way than some of the recent insane boxes. It had steps that were difficult to pull off, and not even that many. But it was still quite challenging. I’ll start using ldap injection to determine a username and a seed for a one time password token. Then I’ll use that to log in. On seeing a command page, I’ll need to go back and log-in again, this time with a username that allows me a second-order ldap injection to bypass the user check. Once I do, I can run commands, and find a user password in the php pages. With an SSH shell, I’ll find a backup script that uses Sevenzip in a way that I can hijack to read the root flag. In Beyond root, I’ll look at little bit at SELinux, build a small shell to make running commands over the webpage easier, and look at the actual ldap queries I injected into.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 13, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/07/13/htb-friendzone.html">
                HTB: FriendZone
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-friendzone " class="post-tag">htb-friendzone</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#zone-transfer " class="post-tag">zone-transfer</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#dig " class="post-tag">dig</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#python-library-hijack " class="post-tag">python-library-hijack</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/friendzone-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/friendzone-cover.png" alt="FriendZone-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>FriendZone was a relatively easy box, but as far as easy boxes go, it had a lot of enumeration and garbage trolls to sort through. In all the enumeration, I’ll find a php page with an LFI, and use SMB to read page source and upload a webshell. I’ll uprivesc to the next user with creds from a database conf file, and then to root using a writable python module to exploit a root cron job calling a python script.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 6, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/07/06/htb-hackback.html">
                HTB: Hackback
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-hackback " class="post-tag">htb-hackback</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#jq " class="post-tag">jq</a> <a href="/tags#gophish " class="post-tag">gophish</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#php-disable-functions " class="post-tag">php-disable-functions</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#rot13 " class="post-tag">rot13</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#tio-run " class="post-tag">tio-run</a> <a href="/tags#log-poisoning " class="post-tag">log-poisoning</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#regeorge " class="post-tag">regeorge</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#proxychains " class="post-tag">proxychains</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#named-pipe " class="post-tag">named-pipe</a> <a href="/tags#seimpersonate " class="post-tag">seimpersonate</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> <a href="/tags#diaghub " class="post-tag">diaghub</a> <a href="/tags#visual-studio " class="post-tag">visual-studio</a> <a href="/tags#dll " class="post-tag">dll</a> <a href="/tags#alternative-data-streams " class="post-tag">alternative-data-streams</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#rdesktop " class="post-tag">rdesktop</a> <a href="/tags#rdp " class="post-tag">rdp</a> <a href="/tags#oswe-plus " class="post-tag">oswe-plus</a> <a href="/tags#htb-flujab " class="post-tag">htb-flujab</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/hackback-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/hackback-cover.png" alt="Hackback-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Hackback is the hardest box that I’ve done on HTB. By far. Without question. If you’d like data to back that up, the first blood times of over 1.5 and 2.5 days! I remember vividly working on this box with all my free time, and being the 5th to root it (7th root counting the two box authors) in the 6th day. I’ll start by finding a hosts whose main attack point is a GoPhish interface. This interface gives up some domain names for fake phishing sites on the same host, which I can use to find an admin interface which I can abuse to get file system access via log poisoning. Unfortunately, all the functions I need to get RCE via PHP or ASPX are disabled. I can however upload reGeorge and use it to tunnel a connection to WinRM, where I can use some creds I find in a config file. I’ll then use a named pipe to execute nc as the next user. From there I can abuse a faulty service that allows me to write as SYSTEM wherever I want to overwrite a file in SYSTEM32, and then use DiagHub to get a SYSTEM shell. In Beyond Root, I’ll look at an unintended way to get root.txt as hacker, explore why an aspx webshell fails and find a work around to get it working, check out the PowerShell source for the web server listening on 6666, and look into an RDP connection.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 1, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/07/01/darling-running-macos-binaries-on-linux.html">
                Darling: Running MacOS Binaries on Linux
              </a>
            </h3>

<span class="tag-list"><a href="/tags#tools " class="post-tag">tools</a> <a href="/tags#bsides-london " class="post-tag">bsides-london</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#darling " class="post-tag">darling</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#mach-o " class="post-tag">mach-o</a> <a href="/tags#macos " class="post-tag">macos</a> </span><br/><br/>


<p>`<img src="https://0xdfimages.gitlab.io/img/darling-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; height:120px;" />I attended BSides London almost a month ago now, and of course took a look at the CTF. There were a handful of reversing challenges, but multiple of them were MacOS (Mach-O) binaries. As I looked down at my Windows laptop and my Kali VM, I felt at a bit of a disadvantage. While I was able to solve one of the challenges just with IDA, I went looking for a way to run Mac binaries on a Linux OS. And I found Darwin. It took basically the rest of the day to install, so I didn’t get to any of the additional challenges, but I am happy to be semi-equiped the next time the need comes up.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 29, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/06/29/htb-netmon.html">
                HTB: Netmon
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-netmon " class="post-tag">htb-netmon</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#prtg " class="post-tag">prtg</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#psexec-py " class="post-tag">psexec-py</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#htb-jerry " class="post-tag">htb-jerry</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/netmon-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/netmon-cover.png" alt="Netmon-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Netmon rivals <a href="/2018/11/17/htb-jerry.html">Jerry</a> and Blue for the shortest box I’ve done. The user first blood went in less than 2 minutes, and that’s probably longer than it should have been as the hackthebox page crashed right at open with so many people trying to submit flags. The host presents the full file system over anonymous FTP, which is enough to grab the user flag. It also hosts an instance of PRTG Network Monitor on port 80. I’ll use the FTP access to find old creds in a backup configuration file, and use those to guess the current creds. From there, I can use a command injection vulnerability in PRTG to get a shell as SYSTEM, and the root flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 22, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/06/22/htb-querier.html">
                HTB: Querier
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-querier " class="post-tag">htb-querier</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#olevba " class="post-tag">olevba</a> <a href="/tags#macros " class="post-tag">macros</a> <a href="/tags#vba " class="post-tag">vba</a> <a href="/tags#mssql " class="post-tag">mssql</a> <a href="/tags#mssqlclient " class="post-tag">mssqlclient</a> <a href="/tags#xp-dirtree " class="post-tag">xp-dirtree</a> <a href="/tags#net-ntlmv2 " class="post-tag">net-ntlmv2</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#xp-cmdshell " class="post-tag">xp-cmdshell</a> <a href="/tags#powerup " class="post-tag">powerup</a> <a href="/tags#gpp " class="post-tag">gpp</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#nc " class="post-tag">nc</a> <a href="/tags#wmiexec " class="post-tag">wmiexec</a> <a href="/tags#service " class="post-tag">service</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#htb-giddy " class="post-tag">htb-giddy</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/querier-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/querier-cover.png" alt="Querier-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Querier was a fun medium box that involved some simple document forensices, mssql access, responder, and some very basic Windows Privesc steps. I’ll show how to grab the Excel macro-enabled workbook from an open SMB share, and find database credentials in the macros. I’ll use those credentials to connect to the host’s MSSQL as a limited user. I can use that limited access to get a Net-NTLMv2 hash with responder, which provides enough database access to run commands. That’s enough to provide a shell. For privesc, running PowerUp.ps1 provides administrator credentials from a GPP file. In Beyond Root, I’ll look at the other four things that PowerUp points out, and show how one of them will also provide a shell as SYSTEM.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 15, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/06/15/htb-flujab.html">
                HTB: FluJab
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-flujab " class="post-tag">htb-flujab</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#cookies " class="post-tag">cookies</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#scripting " class="post-tag">scripting</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#ajenti " class="post-tag">ajenti</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#cve-2008-0166 " class="post-tag">cve-2008-0166</a> <a href="/tags#tcp-wrapper " class="post-tag">tcp-wrapper</a> <a href="/tags#rbash " class="post-tag">rbash</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#make " class="post-tag">make</a> <a href="/tags#screen " class="post-tag">screen</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/flujab-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/flujab-cover.png" alt="FluJab-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>FluJab was a long and difficult box, with several complicated steps which require multiple pieces working together and careful enumeration. I’ll start by enumerating a host that hosts websites for many different customers, and is meant to be like a CloudFlare ip. Once identifying the host I’m targeting, I’ll find some weird cookie values that I can manipulate to get access to configuration pages. There I can configure the SMTP to go through my host, and use an SQL injection in one of the forms where I can read the results over email. Information in the database credentials and new subdomain, where I can access an instance of Ajenti server admin panel. That allows me to identify weak ssh keys, and to add my host to an ssh TCP Wrapper whitelist. Then I can ssh in with the weak private key. From there, I’ll find a vulnerable version of screen which I can use to get a root shell. In Beyond Root, I’ll show an unintended path to get a shell through Ajenti using the API, look at the details of the screen exploit, explore the box’s clean up crons, and point out an oddity with nurse jackie.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 8, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/06/08/htb-help.html">
                HTB: Help
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-help " class="post-tag">htb-help</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#graphql " class="post-tag">graphql</a> <a href="/tags#curl " class="post-tag">curl</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#helpdeskz " class="post-tag">helpdeskz</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#exploit-db " class="post-tag">exploit-db</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#blindsqli " class="post-tag">blindsqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#cve-2017-16995 " class="post-tag">cve-2017-16995</a> <a href="/tags#cve-2017-5899 " class="post-tag">cve-2017-5899</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/help-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/help-cover.png" alt="Help-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Help was an easy box with some neat challenges. As far as I can tell, most people took the unintended route which allowed for skipping the initial section. I’ll either enumerate a GraphQL API to get credentials for a HelpDeskZ instance. I’ll use those creds to exploit an authenticated SQLi vulnerability and dump the database. In the database, I’ll find creds which work to ssh into the box. Alternatively, I can use an unauthenticated upload bypass in HelpDeskZ to upload a webshell and get a shell from there. For root, it’s kernel exploits.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 1, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/06/01/htb-sizzle.html">
                HTB: Sizzle
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-sizzle " class="post-tag">htb-sizzle</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#regex " class="post-tag">regex</a> <a href="/tags#regex101 " class="post-tag">regex101</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#scf " class="post-tag">scf</a> <a href="/tags#net-ntlmv2 " class="post-tag">net-ntlmv2</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#ldapdomaindump " class="post-tag">ldapdomaindump</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#certsrv " class="post-tag">certsrv</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#firefox " class="post-tag">firefox</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#constrained-language-mode " class="post-tag">constrained-language-mode</a> <a href="/tags#psbypassclm " class="post-tag">psbypassclm</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#installutil " class="post-tag">installutil</a> <a href="/tags#msbuild " class="post-tag">msbuild</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#kerberoast " class="post-tag">kerberoast</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#rubeus " class="post-tag">rubeus</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#dcsync " class="post-tag">dcsync</a> <a href="/tags#secretsdump " class="post-tag">secretsdump</a> <a href="/tags#crackmapexec " class="post-tag">crackmapexec</a> <a href="/tags#wmiexec " class="post-tag">wmiexec</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#ntlm-http " class="post-tag">ntlm-http</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#htb-active " class="post-tag">htb-active</a> <a href="/tags#htb-reel " class="post-tag">htb-reel</a> <a href="/tags#certificate-authority " class="post-tag">certificate-authority</a> <a href="/tags#client-certificate " class="post-tag">client-certificate</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#adcs " class="post-tag">adcs</a> <a href="/tags#htb-giddy " class="post-tag">htb-giddy</a> <a href="/tags#htb-bighead " class="post-tag">htb-bighead</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/sizzle-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/sizzle-cover.png" alt="Sizzle-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>I <em>loved</em> Sizzle. It was just a really tough box that reinforced Windows concepts that I hear about from pentesters in the real world. I’ll start with some SMB access, use a .scf file to capture a users NetNTLM hash, and crack it to get creds. From there I can create a certificate for the user and then authenticate over WinRM. I’ll Kerberoast to get a second user, who is able to run the DCSync attack, leading to an admin shell. I’ll have two beyond root sections, the first  to show two unintended paths, and the second to exploit NTLM authentication over HTTP, and how Burp breaks it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 25, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/05/25/htb-chaos.html">
                HTB: Chaos
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-chaos " class="post-tag">htb-chaos</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#webmin " class="post-tag">webmin</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#imap " class="post-tag">imap</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#roundcube " class="post-tag">roundcube</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#latex " class="post-tag">latex</a> <a href="/tags#pdftex " class="post-tag">pdftex</a> <a href="/tags#rbash " class="post-tag">rbash</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#tar " class="post-tag">tar</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#firefox " class="post-tag">firefox</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/chaos-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/chaos-cover.png" alt="Chaos-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Choas provided a couple interesting aspects that I had not worked with before. After some web enumeration and password guessing, I found myself with webmail credentials, which I could use on a webmail domain or over IMAP to get access to the mailbox. In the mailbox was an encrypted message, that once broken, directed me to a secret url where I could exploit an instance of pdfTeX to get a shell. From there, I used a shared password to switch to another user, performed an restricted shell escape, and found the root password in the user’s firefox saved passwords. That password was actually for a Webmin instance, which I’ll exploit in Beyond Root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 22, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/05/22/emotet-pivot.html">
                Malware Analysis: Pivoting In VT
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#emotet " class="post-tag">emotet</a> <a href="/tags#olevba " class="post-tag">olevba</a> <a href="/tags#oledump " class="post-tag">oledump</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#virustotal " class="post-tag">virustotal</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/emotet0-pivot-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" /> After pulling apart an Emotet phishing doc in the <a href="/2019/05/21/malware-analysis-unnamed-emotet-doc.html">previous post</a>, I wanted to see if I could find similar docs from the same phishing campaign, and perhaps even different docs from previous phishing campaigns based on artifacts in the seed document. With access to a paid VirusTotal account, this is not difficult to do.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 21, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/05/21/malware-analysis-unnamed-emotet-doc.html">
                Malware Analysis: Unnamed Emotet Doc
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#emotet " class="post-tag">emotet</a> <a href="/tags#olevba " class="post-tag">olevba</a> <a href="/tags#oledump " class="post-tag">oledump</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#virustotal " class="post-tag">virustotal</a> <a href="/tags#cyberchef " class="post-tag">cyberchef</a> <a href="/tags#urlscan " class="post-tag">urlscan</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/emotet-20190521-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" /> I decided to do some VT roulette and check out some recent phishing docs in VT. I searched for documents with only few (5-12) detections, and the top item was an Emotet word doc. The Emotet group continues to tweak their strategy to avoid AV. In this doc, they use TextBox objects to hold both the base64 encoded PowerShell and the PowerShell command line itself, in a way that actually makes it hard to follow with olevba. I’ll use oledump to show the parts that olevba misses.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 18, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/05/18/htb-conceal.html">
                HTB: Conceal
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-conceal " class="post-tag">htb-conceal</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#ike " class="post-tag">ike</a> <a href="/tags#ipsec " class="post-tag">ipsec</a> <a href="/tags#ike-scan " class="post-tag">ike-scan</a> <a href="/tags#strongswan " class="post-tag">strongswan</a> <a href="/tags#iis " class="post-tag">iis</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#juicypotato " class="post-tag">juicypotato</a> <a href="/tags#potato " class="post-tag">potato</a> <a href="/tags#watson " class="post-tag">watson</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#windows10 " class="post-tag">windows10</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-mischief " class="post-tag">htb-mischief</a> <a href="/tags#htb-bounty " class="post-tag">htb-bounty</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/conceal-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/conceal-cover.png" alt="Conceal-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Conceal brought something to HTB that I hadn’t seen before - connecting via an IPSEC VPN to get access to the host. I’ll use clues from SNMP and a lot of guessing and trial and error to get connected, and then it’s a realtively basic Windows host, uploading a webshell over FTP, and then using JuicyPotato to get SYSTEM priv. The box is very much unpatched, so I’ll show Watson as well, and leave exploiting those vulnerabilities as an exercise for the reader. It actually blows my mind that it only took 7 hours for user first blood, but then an additional 16.5 hours to root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 11, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/05/11/htb-lightweight.html">
                HTB: Lightweight
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-lightweight " class="post-tag">htb-lightweight</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#centos " class="post-tag">centos</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#fail2ban " class="post-tag">fail2ban</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#tcpdump " class="post-tag">tcpdump</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#capabilities " class="post-tag">capabilities</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#htb-ethereal " class="post-tag">htb-ethereal</a> <a href="/tags#sudoers " class="post-tag">sudoers</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/lightweight-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/lightweight-cover.png" alt="Lightweight-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Lightweight was relatively easy for a medium box. The biggest trick was figuring out that you needed to capture ldap traffic on localhost to get credentials, and getting that traffic to generate. The box actually starts off with creating an ssh account for me when I visit the webpage. From there I can capture plaintext creds from ldap to escalate to the first user. I’ll crack a backup archive to get creds to the second user, and finally use a copy of <code class="language-plaintext highlighter-rouge">openssl</code> with full Linux capabilities assigned to it to escalate to root. In Beyond root, I’ll look at the backup site and the real one, and how they don’t match, as well as look at the script for creating users based on http visits.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 4, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/05/04/htb-bighead.html">
                HTB: BigHead
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-bighead " class="post-tag">htb-bighead</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#2k8sp2 " class="post-tag">2k8sp2</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#phpinfo " class="post-tag">phpinfo</a> <a href="/tags#dirsearch " class="post-tag">dirsearch</a> <a href="/tags#nginx " class="post-tag">nginx</a> <a href="/tags#github " class="post-tag">github</a> <a href="/tags#john " class="post-tag">john</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#zip " class="post-tag">zip</a> <a href="/tags#7z " class="post-tag">7z</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#bitvise " class="post-tag">bitvise</a> <a href="/tags#reg " class="post-tag">reg</a> <a href="/tags#plink " class="post-tag">plink</a> <a href="/tags#chisel " class="post-tag">chisel</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#bvshell " class="post-tag">bvshell</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#keepass " class="post-tag">keepass</a> <a href="/tags#bash " class="post-tag">bash</a> <a href="/tags#kpcli " class="post-tag">kpcli</a> <a href="/tags#alternative-data-streams " class="post-tag">alternative-data-streams</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bighead-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bighead-cover.png" alt="BigHead-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>BigHead required you to earn your 50 points. The enumeration was a ton. There was an really fun but challenging buffer overflow to get initial access. Then some pivoting across the same host using SSH and the a php vulnerability. And then finding a hidden KeePass database with a keyfile in an ADS stream which gave me the root flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 4, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/05/04/htb-bighead-bof.html">
                BigHead Exploit Dev
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-bighead " class="post-tag">htb-bighead</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#immunity " class="post-tag">immunity</a> <a href="/tags#mona " class="post-tag">mona</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#mingw " class="post-tag">mingw</a> <a href="/tags#nginx " class="post-tag">nginx</a> <a href="/tags#pattern-create " class="post-tag">pattern-create</a> <a href="/tags#egg-hunter " class="post-tag">egg-hunter</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/bighead-bof-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:125px; height: 125px" /> As my buffer overflow experience on Windows targets is relatively limited (only the basic vulnserver jmp esp type exploit previously), BigHeadWebSrv was probably the most complicate exploit chain I’ve written for a Windows target. The primary factor that takes this above something like a basic jmp esp is the space I have to write to is small. I got to learn a new technique, Egg Hunter, which is a small amount of code that will look for a marker I drop into memory earlier and run the shellcode after it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 27, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/04/27/htb-irked.html">
                HTB: Irked
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-irked " class="post-tag">htb-irked</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#exploit-db " class="post-tag">exploit-db</a> <a href="/tags#hexchat " class="post-tag">hexchat</a> <a href="/tags#irc " class="post-tag">irc</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#steghide " class="post-tag">steghide</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#su " class="post-tag">su</a> <a href="/tags#password-reuse " class="post-tag">password-reuse</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#exim " class="post-tag">exim</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/irked-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/irked-cover.png" alt="Irked-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Irked was another beginner level box from HackTheBox that provided an opportunity to do some simple exploitation without too much enumeration. First blood for user fell in  minutes, and root in 19. I’ll start by exploring an IRC server, and not finding any conversation, I’ll exploit it with some command injection. That leads me to a hint to look for steg with a password, which I’ll find on the image on the web server. That password gets me access as the user. I’ll find an setuid binary that’s trying to run a script out of /tmp that doesn’t exist. I’ll add code to that to get a shell. In Beyond Root, I’ll look at the Metasploit Payload for the IRC exploit, as well as some failed privesc exploits.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 20, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/04/20/htb-teacher.html">
                HTB: Teacher
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-teacher " class="post-tag">htb-teacher</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#stretch " class="post-tag">stretch</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#skipfish " class="post-tag">skipfish</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#cve-2018-1133 " class="post-tag">cve-2018-1133</a> <a href="/tags#crackstation " class="post-tag">crackstation</a> <a href="/tags#mysql " class="post-tag">mysql</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#su " class="post-tag">su</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#chmod " class="post-tag">chmod</a> <a href="/tags#passwd " class="post-tag">passwd</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> <a href="/tags#moodle " class="post-tag">moodle</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/teacher-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/teacher-cover.png" alt="Teacher-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Teacher was 20-point box (despite the yellow avatar). At the start, it required enumerating a website and finding a png file that was actually a text file that revealed most of a password. I’ll use hydra to brute force the last character of the password, and gain access to a Moodle instance, software designed for online learning. I’ll abuse a PHP injection in the quiz feature to get code execution and a shell on the box. Then, I’ll find an md5 in the database that is the password for the main user on the box. From there, I’ll take advantage of a root cron that’s running a backup script, and give myself write access to whatever I want, which I’ll use to get root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 15, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/04/15/commando-vm-lessons.html">
                Commando VM: Lessons Learned
              </a>
            </h3>

<span class="tag-list"><a href="/tags#home-lab " class="post-tag">home-lab</a> <a href="/tags#commando " class="post-tag">commando</a> <a href="/tags#fireeye " class="post-tag">fireeye</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#net-view " class="post-tag">net-view</a> <a href="/tags#net-use " class="post-tag">net-use</a> <a href="/tags#firewall " class="post-tag">firewall</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#htb-ethereal " class="post-tag">htb-ethereal</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/commando-lessons-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" /> I worked a HackTheBox target over the last week using CommandoVM as my attack station. I was pleasantly surprised with how much I liked it. In fact, only once on this box did I need to fire up my Kali workstation. Because the target was Windows, there we parts that were made easier (and in one case made possible!). There were a couple additional struggles that arose, and I’m still in search of a good tmux equivalent. I’ll walk through some of the lessons learned from working in this distro.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 13, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/04/13/htb-redcross.html">
                HTB: RedCross
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-redcross " class="post-tag">htb-redcross</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#cookies " class="post-tag">cookies</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#xss " class="post-tag">xss</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#postgresql " class="post-tag">postgresql</a> <a href="/tags#haraka " class="post-tag">haraka</a> <a href="/tags#exploit-db " class="post-tag">exploit-db</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#sudoers " class="post-tag">sudoers</a> <a href="/tags#nss " class="post-tag">nss</a> <a href="/tags#jail " class="post-tag">jail</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#socat " class="post-tag">socat</a> <a href="/tags#rop " class="post-tag">rop</a> <a href="/tags#aslr " class="post-tag">aslr</a> <a href="/tags#htb-frolic " class="post-tag">htb-frolic</a> <a href="/tags#htb-october " class="post-tag">htb-october</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/redcross-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/redcross-cover.png" alt="RedCross-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>RedCross was a maze, with a lot to look at and multiple paths at each stage. I’ll start by enumerating a website, and showing two different ways to get a cookie to use to gain access to the admin panel. Then, I’ll get a shell on the box as penelope, either via an exploit in the Haraka SMTP server or via injection in the webpage and the manipulation of the database that controls the users in the ssh jail. Finally, I’ll show escalation to root three different ways, using the database again in two different ways, and via a buffer overflow in a setuid binary. In Beyond Root, I’ll dig into the SQL injection and check out how the ssh jail is configured.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 10, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/04/10/commando-vm-overview.html">
                Commando VM: Looking Around
              </a>
            </h3>

<span class="tag-list"><a href="/tags#home-lab " class="post-tag">home-lab</a> <a href="/tags#commando " class="post-tag">commando</a> <a href="/tags#fireeye " class="post-tag">fireeye</a> <a href="/tags#openvpn " class="post-tag">openvpn</a> <a href="/tags#burp " class="post-tag">burp</a> <a href="/tags#7zip " class="post-tag">7zip</a> <a href="/tags#winrar " class="post-tag">winrar</a> <a href="/tags#cmder " class="post-tag">cmder</a> <a href="/tags#greenshot " class="post-tag">greenshot</a> <a href="/tags#windump " class="post-tag">windump</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> <a href="/tags#seclists " class="post-tag">seclists</a> <a href="/tags#fuzzdb " class="post-tag">fuzzdb</a> <a href="/tags#foxyproxy " class="post-tag">foxyproxy</a> <a href="/tags#x64dbg " class="post-tag">x64dbg</a> <a href="/tags#dnspy " class="post-tag">dnspy</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#ghidra " class="post-tag">ghidra</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/commando-overview-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" />Having built my CommandoVM in a <a href="/2019/04/09/commando-vm-installation.html">previous post</a>, now I am going to look at what’s installed, and what else I might want to add to the distribution. I’ll start with some tweaks I made to get the box into shape, check out what tools are present, and add some that I notice missing. After this, in I’ll use the VM to work a HTB target, and report back on in a future post.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 9, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/04/09/commando-vm-installation.html">
                Commando VM: Installation
              </a>
            </h3>

<span class="tag-list"><a href="/tags#home-lab " class="post-tag">home-lab</a> <a href="/tags#commando " class="post-tag">commando</a> <a href="/tags#fireeye " class="post-tag">fireeye</a> <a href="/tags#youtube " class="post-tag">youtube</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/commando-install-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:120px; height:120px;" />Ever since Fireeye announced their new CommandoVM, the “Complete Mandiant Offensive VM”, I’d figured next time I had an occasion to target a Windows host, I would try to build a VM and give it a spin. This post is focused on getting up and running. I suspect additional posts on how it works out will follow.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 6, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/04/06/htb-vault.html">
                HTB: Vault
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-vault " class="post-tag">htb-vault</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#qemu " class="post-tag">qemu</a> <a href="/tags#spice " class="post-tag">spice</a> <a href="/tags#openvpn " class="post-tag">openvpn</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#rbash " class="post-tag">rbash</a> <a href="/tags#gpg " class="post-tag">gpg</a> <a href="/tags#remmina " class="post-tag">remmina</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/vault-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/vault-cover.png" alt="Vault-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Vault was a a really neat box in that it required pivoting from a host into various VMs to get to the vault, at least the intended way. There’s an initial php upload filter bypass that gives me execution. Then a pivot with an OpenVPN config RCE. From there I’ll find SSH creds, and need to figure out how to pass through a firewall to get to the vault. Once in the vault, I find the flag encrypted with GPG, and I’ll need to move it back to the host to get the decryption keys to get the flag. In Beyond Root, I’ll look at a couple of unintended paths, including a firewall bypass by adding an IP address, and a way to bypass the entire thing by connecting to the Spice ports, rebooting the VMs into recovery, resetting the root password, and then logging in.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 3, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/04/03/wl-devlife.html">
                Wizard Labs: DevLife
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#wizard-labs " class="post-tag">wizard-labs</a> <a href="/tags#wl-devlife " class="post-tag">wl-devlife</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#debian " class="post-tag">debian</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#credentials " class="post-tag">credentials</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/wl-devlife-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/wl-devlife-cover.png" alt="wl-DevLife-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Another Wizard Lab’s host retired, DevLife. This was another really easy box, that required some simple web enumeration to find a python panel that would run python commands, and display the output. From there, I could get a shell and the first flag. Then, more enumeration to find a python script in a hidden directory that contained the root password. With that, I can escalate to root. There was also a swp file in the hidden directory that I’ll attempt to recover (and then figure out is actually nano), and I’ll look at how the php page runs python commands, and show an injection in that.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 30, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/30/htb-curling.html">
                HTB: Curling
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-curling " class="post-tag">htb-curling</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#joomla " class="post-tag">joomla</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#curl " class="post-tag">curl</a> <a href="/tags#suid " class="post-tag">suid</a> <a href="/tags#cve-2019-7304 " class="post-tag">cve-2019-7304</a> <a href="/tags#dirty-sock " class="post-tag">dirty-sock</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#htb-sunday " class="post-tag">htb-sunday</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/curling-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/curling-cover.png" alt="Curling-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Curling was a solid box easy box that provides a chance to practice some basic enumeration to find a password, using that password to get access to a Joomla instance, and using the access to get a shell. With a shell, I’ll find a compressed and encoded backup file, that after a bit of unpacking, gives a password to privesc to the next user. As that user, I’ll find a root cron running curl with the option to use a configuration file. It happens that I can control that file, and use it to get the root flag and a root shell. In Beyond root, I’ll look at how setuid applies to scripts on most Linux flavors (and how it’s different from Solaris as I showed with Sunday), and how the Dirty Sock snapd vulnerability from a couple months ago will work here to go to root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 27, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/27/analyzing-document-macros-with-yara.html">
                Analyzing Document Macros with Yara
              </a>
            </h3>

<span class="tag-list"><a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#vbscript " class="post-tag">vbscript</a> <a href="/tags#yara " class="post-tag">yara</a> <a href="/tags#documents " class="post-tag">documents</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#powershell " class="post-tag">powershell</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/yara-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:200px; height:100px;" /> This post is actually inspired by a box I’m building for HTB, so if it ever gets released, some of you may see this post again. But Yara is also something I’ve used a ton professionally, and it is super useful. I’ll introduce Yara, a pattern matching tool which is super useful for malware analysis, and just a general use tool that’s useful to know. I’ll also look at the file format for both Microsoft Office and Libre Office documents, and how to decompress them to identify their contents. I’ll show how for Libre Office files, Yara can be applied to the unzipped document to identify macro contents.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 26, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/26/htb-october.html">
                HTB: October
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-october " class="post-tag">htb-october</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#aslr " class="post-tag">aslr</a> <a href="/tags#aslr-brute-force " class="post-tag">aslr-brute-force</a> <a href="/tags#htb-frolic " class="post-tag">htb-frolic</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/october-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/october-cover.png" alt="October-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>October was interesting because it paired a very straight-forward initial access with a simple buffer overflow for privesc. To gain access, I’ll learn about a extension blacklist by pass against the October CMS, allowing me to upload a webshell and get execution. Then I’ll find a SetUID binary that I can overflow to get root. While the buffer overflow exploit was on the more straight-forward side, it still requires a level of skill beyond many of the other easy early boxes I’ve done so far.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 23, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/23/htb-frolic.html">
                HTB: Frolic
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-frolic " class="post-tag">htb-frolic</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#nodered " class="post-tag">nodered</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#playsms " class="post-tag">playsms</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#ook " class="post-tag">ook!</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#brainfuck " class="post-tag">brainfuck</a> <a href="/tags#fcrackzip " class="post-tag">fcrackzip</a> <a href="/tags#xxd " class="post-tag">xxd</a> <a href="/tags#cve-2017-9101 " class="post-tag">cve-2017-9101</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#ret2libc " class="post-tag">ret2libc</a> <a href="/tags#peda " class="post-tag">peda</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-reddish " class="post-tag">htb-reddish</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/frolic-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/frolic-cover.png" alt="Frolic-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Frolic was more a string of challenges and puzzles than the more typical HTB experiences. Enumeration takes me through a series of puzzles that eventually unlock the credentials to a PlaySMS web interface. With that access, I can exploit the service to get execution and a shell. To gain root, I’ll find a setuid binary owned by root, and overflow it with a simple ret2libc attack. In Beyond Root, I’ll at the Metasploit version of the PlaySMS exploit and reverse it’s payload. I’ll also glance through the Bash history files of the two users on the box and see how the author built the box.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 16, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/16/htb-carrier.html">
                HTB: Carrier
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-carrier " class="post-tag">htb-carrier</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#bgp-hijack " class="post-tag">bgp-hijack</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#tcpdump " class="post-tag">tcpdump</a> <a href="/tags#lxc " class="post-tag">lxc</a> <a href="/tags#lxd " class="post-tag">lxd</a> <a href="/tags#ssh " class="post-tag">ssh</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/carrier-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/carrier-cover.png" alt="Carrier-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Carrier was awesome, not because it super hard, but because it provided an opportunity to do something that I hear about all the time in the media, but have never been actually tasked with doing - BGP Hijacking. I’ll use SMNP to find a serial number which can be used to log into a management status interface for an ISP network. From there, I’ll find command injection which actually gives me execution on a router. The management interface also reveals tickets indicting some high value FTP traffic moving between two other ASNs, so I’ll use BGP hijacking to route the traffic through my current access, gaining access to the plaintext credentials. In Beyond Root, I’ll look at an unintended way to skip the BGP hijack, getting a root shell and how the various containers were set up, why I only had to hijack one side of the conversation to get both sides, the website and router interaction and how to log commands sent over ssh, and what “secretdata” really was.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 15, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/15/htb-ethereal-cor.html">
                Applocker Bypass: COR Profiler
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-ethereal " class="post-tag">htb-ethereal</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#applocker " class="post-tag">applocker</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#beryllium " class="post-tag">beryllium</a> <a href="/tags#visualstudio " class="post-tag">visualstudio</a> <a href="/tags#dotnet " class="post-tag">dotnet</a> <a href="/tags#cor-profiler " class="post-tag">cor-profiler</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/ethereal-cor-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px; width:125px; height:125px" />On of the challenges in Ethereal was having to use a shell comprised of two OpenSSL connections over different ports. And each time I wanted to exploit some user action, I had to set my trap in place, kill my shell, start two listeners, and wait. Things would have been a lot better if I could have just gotten a shell to connect back to me over one of the two open ports, but AppLocker made that nearly impossible. IppSec demoed a method to bypass those filters using COR Profiling. I wanted to play with it myself, and get some notes down (in the form of this post).</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 12, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/12/htb-bastard.html">
                HTB: Bastard
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-bastard " class="post-tag">htb-bastard</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#web " class="post-tag">web</a> <a href="/tags#drupal " class="post-tag">drupal</a> <a href="/tags#drupalgeddon2 " class="post-tag">drupalgeddon2</a> <a href="/tags#drupalgeddon3 " class="post-tag">drupalgeddon3</a> <a href="/tags#droopescan " class="post-tag">droopescan</a> <a href="/tags#dirsearch " class="post-tag">dirsearch</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#searchsploit " class="post-tag">searchsploit</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#ms15-051 " class="post-tag">ms15-051</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#htb-devel " class="post-tag">htb-devel</a> <a href="/tags#htb-granny " class="post-tag">htb-granny</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/bastard-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/bastard-cover.png" alt="Bastard-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Bastard was the 7th box on HTB, and it presented a Drupal instance with a known vulnerability at the time it was released. I’ll play with that one, as well as two more, Drupalgeddon2 and Drupalgeddon3, and use each to get a shell on the box. The privesc was very similar to other early Windows challenges, as the box is unpatched, and vulnerable to kernel exploits.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 9, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/09/htb-ethereal.html">
                HTB: Ethereal
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-ethereal " class="post-tag">htb-ethereal</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#pbox " class="post-tag">pbox</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#shell " class="post-tag">shell</a> <a href="/tags#dns-c2 " class="post-tag">dns-c2</a> <a href="/tags#firewall " class="post-tag">firewall</a> <a href="/tags#nslookup " class="post-tag">nslookup</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#lnk " class="post-tag">lnk</a> <a href="/tags#pylnker " class="post-tag">pylnker</a> <a href="/tags#lnkup " class="post-tag">lnkup</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#ca " class="post-tag">ca</a> <a href="/tags#msi " class="post-tag">msi</a> <a href="/tags#windows " class="post-tag">windows</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/ethereal-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/ethereal-cover.png" alt="Ethereal-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Ethereal was quite difficult, and up until a few weeks ago, potentially the hardest on HTB. Still, it was hard in a fun way. The path through the box was relatively clear, and yet, each step presented a technical challenge to figure out what was going on and how I could use it to get what I wanted. I’ll start by breaking into an old password vault that I find on FTP, and using that to authenticate to a website. That site has code injection, and I’ll use that to get exfil and eventually a weak shell over DNS. I’ll discover OpenSSL, and use that to get a more stable shell. From there, I’ll replace a shortcut to escalate to the next user. Then I’ll user CA certs that I find on target to sign an MSI file to give me shell as the administrator. I’ll also attach two additional posts, one going into how I attacked pbox, and another on how I developed a shell over blind command injection and dns.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 9, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/09/htb-ethereal-pbox.html">
                HTB: Ethereal Attacking Password Box
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-ethereal " class="post-tag">htb-ethereal</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#pbox " class="post-tag">pbox</a> <a href="/tags#freebasic " class="post-tag">freebasic</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#basic " class="post-tag">basic</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/ethereal-pbox-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />For Ethereal, I found a DOS application, <code class="language-plaintext highlighter-rouge">pbox.exe</code>, and a <code class="language-plaintext highlighter-rouge">pbox.dat</code> file. These were associated with a program called PasswordBox, which was an early password manager program. To solve this box, most people likely just guessed the password, “password”. But what if I had needed to brute force it? The program was not friendly to taking input from stdin, or from running inside python. So I downloaded the source code, installed the FreeBasic compiler, and started hacking at the source until it ran in a way that I could brute force test 1000 passwords in 5 seconds. I’ll walk through my steps and thought process in this post.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 9, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/09/htb-ethereal-shell.html">
                HTB: Ethereal Shell Development
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-ethereal " class="post-tag">htb-ethereal</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#dns-c2 " class="post-tag">dns-c2</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pdb " class="post-tag">pdb</a> <a href="/tags#python-cmd " class="post-tag">python-cmd</a> <a href="/tags#python-scapy " class="post-tag">python-scapy</a> <a href="/tags#injection " class="post-tag">injection</a> <a href="/tags#python-requests " class="post-tag">python-requests</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/ethereal-shell-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />It would have been possible to get through the initial enumeration of Ethereal with just Burp Repeater and tcpdump, or using responder to read the DNS requests. But writing a shell is much more fun and good coding practice. I’ll develop around primary two modules from Python, scapy to listen for and process DNS packets, and cmd to create a shell user interface, with requests to make the http injections. In this post I’ll show how I built the shell step by step.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 6, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/06/htb-granny.html">
                HTB: Granny
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-granny " class="post-tag">htb-granny</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#webdav " class="post-tag">webdav</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#htb-devel " class="post-tag">htb-devel</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#ms14-058 " class="post-tag">ms14-058</a> <a href="/tags#local-exploit-suggester " class="post-tag">local_exploit_suggester</a> <a href="/tags#pwk " class="post-tag">pwk</a> <a href="/tags#cadaver " class="post-tag">cadaver</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/granny-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/granny-cover.png" alt="Granny-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>As I’m continuing to work through older boxes, I came to Granny, another easy Windows host involving webshells. In this case, I’ll use WebDAV to get a webshell on target, which is something I haven’t written about before, but that I definitely ran into while doing PWK. In this case, WebDav blocks aspx uploads, but it doesn’t prevent me from uploading as a txt file, and then using the HTTP Move to move the file to an aspx. I’ll show how to get a simple webshell, and how to get meterpreter. For privesc, I’ll use a Windows local exploit to get SYSTEM access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 5, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/05/htb-devel.html">
                HTB: Devel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-devel " class="post-tag">htb-devel</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#ms11-046 " class="post-tag">ms11-046</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#watson " class="post-tag">watson</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/devel-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/devel-cover.png" alt="Devel-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Another one of the first boxes on HTB, and another simple beginner Windows target. In this case, I’ll use anonymous access to FTP that has it’s root in the webroot of the machine. I can upload a webshell, and use it to get execution and then a shell on the machine. Then I’ll use one of many available Windows kernel exploits to gain system. I’ll do it all without Metasploit, and then with Metasploit.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Mar 2, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/03/02/htb-access.html">
                HTB: Access
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-access " class="post-tag">htb-access</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#mdbtools " class="post-tag">mdbtools</a> <a href="/tags#readpst " class="post-tag">readpst</a> <a href="/tags#mutt " class="post-tag">mutt</a> <a href="/tags#telnet " class="post-tag">telnet</a> <a href="/tags#runas " class="post-tag">runas</a> <a href="/tags#cached-creds " class="post-tag">cached-creds</a> <a href="/tags#dpapi " class="post-tag">dpapi</a> <a href="/tags#mimikatz " class="post-tag">mimikatz</a> <a href="/tags#pylnker " class="post-tag">pylnker</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/access-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/access-cover.png" alt="Access-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Access was an easy Windows box, which is really nice to have around, since it’s hard to find places for beginners on Windows.    And, unlike most Windows boxes, it didn’t involve SMB. I’ll start using anonymous FTP access to get a zip file and an Access database. I’ll use command line tools to find a password in the database that works for the zip file, and find   an Outlook mail file inside. I’ll read the email to find the password for an account on the box, and connect with telnet. From there, I’ll take advantage of cached administrator credentials two different ways to get root.txt. In Beyond Root, I’ll look at ways to get more details out of lnk files, both with PowerShell and pylnker.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 27, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/02/27/playing-with-jenkins-rce-vulnerability.html">
                Playing with Jenkins RCE Vulnerability
              </a>
            </h3>

<span class="tag-list"><a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#cve-2019-1003000 " class="post-tag">cve-2019-1003000</a> <a href="/tags#jenkins " class="post-tag">jenkins</a> <a href="/tags#jeeves " class="post-tag">jeeves</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#windows " class="post-tag">windows</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/jenkins-exploit-cover.jpg" alt="" style="float: right;margin-right:50px; margin-left:50px" />Orange Tsai published a really interesting writeup on their discovery of CVE-2019-1003000, an Unauthenticated remote code execution (RCE) in Jenkins. There was a box from HackTheBox.eu that ran Jenkins, and while the configuration wasn’t perfect for this kind of test, I decided to play with it and see what I could figure out. I’ll get the exploit working with a new payload so that it runs on the Windows environment.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 23, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/02/23/htb-zipper.html">
                HTB: Zipper
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-zipper " class="post-tag">htb-zipper</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#zabbix " class="post-tag">zabbix</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#path-hijack " class="post-tag">path-hijack</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#ltrace " class="post-tag">ltrace</a> <a href="/tags#service-hijack " class="post-tag">service-hijack</a> <a href="/tags#exploit-db " class="post-tag">exploit-db</a> <a href="/tags#jq " class="post-tag">jq</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#linux " class="post-tag">linux</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/zipper-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/zipper-cover.png" alt="Zipper-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Zipper was a pretty straight-forward box, especially compared to some of the more recent 40 point boxes. The main challenge involved using the API for a product called Zabbix, used to manage and inventory computers in an environment. I’ll show way too many ways to abuse Zabbix to get a shell. Then for privesc, I’ll show two methods, using a suid binary that makes a call to system without providing a full path, allowing me to change the path and get a root shell, and identifying a writable service file that I can hijack to gain root privilege. In Beyond Root, I’ll dig into the shell from Exploit-DB, figure out how it works, and make a few improvements.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 22, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/02/22/wl-dummy.html">
                Wizard Labs: Dummy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#wizard-labs " class="post-tag">wizard-labs</a> <a href="/tags#wl-dummy " class="post-tag">wl-dummy</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#ms17-010 " class="post-tag">ms17-010</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#htb-legacy " class="post-tag">htb-legacy</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/wl-dummy-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/wl-dummy-cover.png" alt="wl-dummy-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>I had an opportunity to check out <a href="https://labs.wizard-security.net">Wizard Labs</a> recently. It’s a recently launched service much like HackTheBox. Their user interface isn’t as polished or feature rich as HTB, but they have 16 vulnerable machines online right now to attack. The box called Dummy recently retired from their system, so I can safely give it a walk-through. It’s a bit of bad luck that I looked at this just after doing <a href="/2019/02/21/htb-legacy.html">Legacy</a>, as they were very similar boxes. Seems popular to start a service with a Windows SMB vulnerability. This was a Windows 7 box, vulnerable to MS17-010. I’ll use a different python script, and give the Metasploit exploit a spin and fail.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 21, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/02/21/htb-legacy.html">
                HTB: Legacy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-legacy " class="post-tag">htb-legacy</a> <a href="/tags#windows " class="post-tag">windows</a> <a href="/tags#ms08-067 " class="post-tag">ms08-067</a> <a href="/tags#ms17-010 " class="post-tag">ms17-010</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#xp " class="post-tag">xp</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/legacy-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/legacy-cover.png" alt="legacy-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Since I’m caught up on all the live boxes, challenges, and labs, I’ve started looking back at retired boxes from before I joined HTB. The top of the list was legacy, a box that seems like it was one of the first released on HTB. It’s a very easy Windows box, vulnerable to two SMB bugs that are easily exploited with Metasploit. I’ll show how to exploit both of them without Metasploit, generating shellcode and payloads with msfvenom, and modifying public scripts to get shells. In beyond root, I’ll take a quick look at the lack of whoami on XP systems.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 16, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/02/16/htb-giddy.html">
                HTB: Giddy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-giddy " class="post-tag">htb-giddy</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#winrm " class="post-tag">winrm</a> <a href="/tags#net-ntlmv2 " class="post-tag">net-ntlmv2</a> <a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#unifivideo " class="post-tag">unifivideo</a> <a href="/tags#defender " class="post-tag">defender</a> <a href="/tags#ebowla " class="post-tag">ebowla</a> <a href="/tags#smbserver " class="post-tag">smbserver</a> <a href="/tags#applocker " class="post-tag">applocker</a> <a href="/tags#powershell-web-access " class="post-tag">powershell-web-access</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/giddy-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />I thought Giddy was a ton of fun. It was a relateively straight forward box, but I learned two really neat things working it (each of which inspired <a href="/2018/11/08/powershell-history-file.html">other</a> <a href="/2019/01/13/getting-net-ntlm-hases-from-windows.html">posts</a>). The box starts with some enumeration that leads to a site that gives inventory. I’ll abuse an SQL-Injection vulnerability to get the host to make an SMB connect back to me, where I can collect Net-NTLMv2 challenge response, and crack it to get a password. I can then use either the web PowerShell console or WinRM to get a shell. To get system, I’ll take advantage of a vulnerability in Ubiquiti UniFi Video.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 13, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/02/13/playing-with-dirty-sock.html">
                Playing with Dirty Sock
              </a>
            </h3>

<span class="tag-list"><a href="/tags#snapd " class="post-tag">snapd</a> <a href="/tags#cve-2019-7304 " class="post-tag">cve-2019-7304</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ubuntu " class="post-tag">ubuntu</a> <a href="/tags#exploit " class="post-tag">exploit</a> <a href="/tags#dirty-sock " class="post-tag">dirty-sock</a> <a href="/tags#htb-canape " class="post-tag">htb-canape</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/dirtysock-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" /> A local privilege escalation exploit against a vulnerability in the snapd server on Ubuntu was released today by Shenanigans Labs under the name Dirty Sock. Snap is an attempt by Ubuntu to simplify packaging and software distribution, and there’s a vulnerability in the REST API which is attached to a local UNIX socket that allowed multiple methods to get root access. I decided to give it a run, both on a VM locally and on some of the <a href="https://www.hackthebox.eu">HackTheBox.eu</a> machines.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 9, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/02/09/htb-ypuffy.html">
                HTB: Ypuffy
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-ypuffy " class="post-tag">htb-ypuffy</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#ldap " class="post-tag">ldap</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#ssh-keygen " class="post-tag">ssh-keygen</a> <a href="/tags#doas " class="post-tag">doas</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#certificate " class="post-tag">certificate</a> <a href="/tags#certificate-authority " class="post-tag">certificate-authority</a> <a href="/tags#wireshark " class="post-tag">wireshark</a> <a href="/tags#cve-2018-14665 " class="post-tag">cve-2018-14665</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#wsgi " class="post-tag">wsgi</a> <a href="/tags#authorizedkeyscommand " class="post-tag">authorizedkeyscommand</a> <a href="/tags#htb-dab " class="post-tag">htb-dab</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/ypuffy-cover.gif" alt="" style="float: right;margin-right:50px; margin-left:50px" />Ypuffy was an OpenBSD box, but the author said it could have really been any OS, and I get that. The entire thing was about protocols that operate on any environment. I’ll use ldap to get a hash, which I can use to authenticate an SMB share. There I find an SSH key that gets me a user shell. From there, I’ll abuse my doas privilege with ssh-keygen to create a signed certificate that I can use to authenticate to the box as root for ssh. In Beyond root, I’ll look at the Xorg privesc vulnerability that became public a month or so after Ypuffy was released, and also explore the web server configuration used in the ssh auth.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Feb 2, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/02/02/htb-dab.html">
                HTB: Dab
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-dab " class="post-tag">htb-dab</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#nginx " class="post-tag">nginx</a> <a href="/tags#wsgi " class="post-tag">wsgi</a> <a href="/tags#memcached " class="post-tag">memcached</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#ldd " class="post-tag">ldd</a> <a href="/tags#ldconfig " class="post-tag">ldconfig</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> <a href="/tags#ida " class="post-tag">ida</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/dab-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />Dab had some really neat elements, with a few trolls thrown in. I’ll start by ignoring a steg troll in an open FTP and looking at two web apps. As I’m able to brute force my way into one, it populates a memcached instance, that I’m then able to query using the other as a proxy. From that instance, I’m able to dump users with md5 password hashes. After cracking twelve of them, one gives me ssh access to the box. From there, I’ll take advantage of my having root level access to the tool that configures how dynamic run-time linking occurs, and use that to pivot to a root shell. In Beyond Root, I’ll look at the web apps and how they are configured, one of the troll binaries, and a cleanup cron job I found but managed to avoid by accident.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 28, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/01/28/pwk-notes-tunneling-update1.html">
                PWK Notes: Tunneling and Pivoting [Updated]
              </a>
            </h3>

<span class="tag-list"><a href="/tags#pwk " class="post-tag">pwk</a> <a href="/tags#oscp " class="post-tag">oscp</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#sshuttle " class="post-tag">sshuttle</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#htb-reddish " class="post-tag">htb-reddish</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/tunneling-cover.jpg" alt="" style="float: right; margin-left:50px" /> That beautiful feeling of shell on a box is such a high. But once you realize that you need to pivot through that host deeper into the network, it can take you a bit out of your comfort zone. I’ve run into this in Sans Netwars, Hackthebox, and now in PWK. In this post I’ll attempt to document the different methods I’ve used for pivoting and tunneling, including different ways to use SSH, sshuttle, and meterpreter, as well as some strategies for how to live from the host you are currently working through. Updated on 28 Jan 2018 to add references to two additional tools, Chisel and SSF.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 26, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/01/26/htb-reddish.html">
                HTB: Reddish
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-reddish " class="post-tag">htb-reddish</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#node-red " class="post-tag">node-red</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#redis " class="post-tag">redis</a> <a href="/tags#rsync " class="post-tag">rsync</a> <a href="/tags#wildcard " class="post-tag">wildcard</a> <a href="/tags#docker " class="post-tag">docker</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/reddish-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />Reddish is one of my favorite boxes on HTB. The exploitation wasn’t that difficult, but it required tunneling communications through multiple networks, and operate in bare-bones environments without the tools I’ve come to expect. Reddish was initially released as a medium difficulty (30 point) box, and after the initial user blood took 9.5 hours, and root blood took 16.5 hours, it was raised to hard (40). Later, it was upped again to insane (50). To get root on this box, I’ll start with an instance of node-red, a javascript browser-based editor to set up flows for IoT. I’ll use that to get a remote shell into a container. From there I’ll pivot using three other containers, escalating privilege in one, before eventually ending up in the host system. Throughout this process, I’ll only have connectivity to the initial container, so I’ll have to maintain tunnels for communication.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 19, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/01/19/htb-secnotes.html">
                HTB: SecNotes
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-secnotes " class="post-tag">htb-secnotes</a> <a href="/tags#csrf " class="post-tag">csrf</a> <a href="/tags#second-order-sqli " class="post-tag">second-order-sqli</a> <a href="/tags#second-order " class="post-tag">second-order</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#wsl " class="post-tag">wsl</a> <a href="/tags#bash-exe " class="post-tag">bash.exe</a> <a href="/tags#winexe " class="post-tag">winexe</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> <a href="/tags#htb-nightmare " class="post-tag">htb-nightmare</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/secnotes-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />SecNotes is a bit different to write about, since I built it. The goal was to make an easy Windows box that, though the HTB team decided to release it as a medium Windows box. It was the first box I ever submitted to HackTheBox, and overall, it was a great experience. I’ll talk about what I wanted to box to look like from the HTB user’s point of view in Beyond Root. SecNotes had a neat XSRF in the site that was completely bypassed by most people using an unintentional second order SQL injection. Either way, after gaining SMB credentials, it allowed the attacker to upload a webshell, and get a shell on the host. Privesc involved diving into the Linux Subsystem for  Windows, finding the history file, and getting the admin creds from there.</p>

</li>
        















          <li class="post-list-li"><span class="post-meta">Jan 15, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/holidayhack2018/">
                Holiday Hack 2018: KringleCon
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#sans-holiday-hack " class="post-tag">sans-holiday-hack</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/hh18-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px" /> The <a href="https://www.holidayhackchallenge.com">Sans Holiday Hack</a> is one of the events I most look forward to each year. This year’s event is based around <a href="https://kringlecon.com/">KringleCon</a>, an infosec conference organized by Santa as a response to the fact that there have been so many attempts to hack Christmas over the last few years. This conference even has a <a href="https://www.youtube.com/channel/UCNiR-C_VXv_TCFgww5Vczag">bunch of talks</a>, some quite useful for completing the challenge, but others that as just interesting as on their own. To complete the Holiday Hack Challenge, I’m asked to enter this virtual conference, walk around, and solve a series of technical challenges. As usual, the challenges were interesting and set up in such a way that it was very beginner friendly, with lots of hints and talks to ensure that you learned something while solving. The designers also implemented several more defensive / forensic challenges this year, which was neat to see.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 13, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/01/13/getting-net-ntlm-hases-from-windows.html">
                Getting Creds via NTLMv2
              </a>
            </h3>

<span class="tag-list"><a href="/tags#responder " class="post-tag">responder</a> <a href="/tags#mitm " class="post-tag">mitm</a> <a href="/tags#net-ntlmv2 " class="post-tag">net-ntlmv2</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#llmnr " class="post-tag">llmnr</a> <a href="/tags#wpad " class="post-tag">wpad</a> <a href="/tags#xp-dirtree " class="post-tag">xp-dirtree</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/responder-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/responder-cover.png" alt="" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>One of the authentication protocols Windows machines use to authenticate across the network is a challenge / response / validation called Net-NTLMv2. If can get a Windows machine to engage my machine with one of these requests, I can perform an offline cracking to attempt to retrieve their password. In some cases, I could also do a relay attack to authenticate directly to some other server in the network. I’ve run into an interesting case of this recently that were worth sharing. In this post, I’ll focus on ways to get a host to send you a challenge / response. If you’re interested in relaying, leave a command and I’ll consider that too.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 12, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/01/12/htb-oz.html">
                HTB: Oz
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-oz " class="post-tag">htb-oz</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#api " class="post-tag">api</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#ssti " class="post-tag">ssti</a> <a href="/tags#jinja2 " class="post-tag">jinja2</a> <a href="/tags#payloadsallthethings " class="post-tag">payloadsallthethings</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#container " class="post-tag">container</a> <a href="/tags#pivot " class="post-tag">pivot</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#port-knocking " class="post-tag">port-knocking</a> <a href="/tags#portainer " class="post-tag">portainer</a> <a href="/tags#tplmap " class="post-tag">tplmap</a> <a href="/tags#jwt " class="post-tag">jwt</a> <a href="/tags#htb-olympus " class="post-tag">htb-olympus</a> </span><br/><br/>



<picture>
    <source type="image/webp" srcset="https://0xdfimages.gitlab.io/img/oz-cover.webp" />
    <img loading="lazy" src="https://0xdfimages.gitlab.io/img/oz-cover.png" alt="oz-cover" style="float: right; margin-right:50px; margin-left:50px; height:120px;" class="include_image " />
</picture>

<p>Oz was long. There was a bunch of enumeration at the front, but once you get going, it presented a relatively straight forward yet technically interesting path through two websites, a Server-Side Template Injection, using a database to access an SSH key, and then using the key to get access to the main host. To privesc, I’ll go back into a different container and take advatnage of a vulnarbility in the docker management software to get root access.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 8, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/01/08/htb-mischief-more-root.html">
                HTB: Mischief Additional Roots
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-mischief " class="post-tag">htb-mischief</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#cve-2018-18955 " class="post-tag">cve-2018-18955</a> <a href="/tags#policykit " class="post-tag">policykit</a> <a href="/tags#polkit " class="post-tag">polkit</a> <a href="/tags#pkexec " class="post-tag">pkexec</a> <a href="/tags#pkttyagent " class="post-tag">pkttyagent</a> </span><br/><br/>


<p>Since publishing my <a href="/2019/01/05/htb-mischief.html">write-up on Mischief</a> from HackTheBox, I’ve learned of two additional ways to privesc to root once I have access as loki. The first is another method to get around the fact the <code class="language-plaintext highlighter-rouge">su</code> was blocked on the host using PolicyKit with the root password. The second was to take advantage of a kernel bug that was publicly released in November, well after Mischief went live. I’ll quickly show both those methods.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 5, 2019</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2019/01/05/htb-mischief.html">
                HTB: Mischief
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-mischief " class="post-tag">htb-mischief</a> <a href="/tags#ipv6 " class="post-tag">ipv6</a> <a href="/tags#snmp " class="post-tag">snmp</a> <a href="/tags#snmpwalk " class="post-tag">snmpwalk</a> <a href="/tags#enyx " class="post-tag">enyx</a> <a href="/tags#command-injection " class="post-tag">command-injection</a> <a href="/tags#hydra " class="post-tag">hydra</a> <a href="/tags#filter " class="post-tag">filter</a> <a href="/tags#facl " class="post-tag">facl</a> <a href="/tags#getfacl " class="post-tag">getfacl</a> <a href="/tags#systemd-run " class="post-tag">systemd-run</a> <a href="/tags#lxc " class="post-tag">lxc</a> <a href="/tags#lxd " class="post-tag">lxd</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#xxd " class="post-tag">xxd</a> <a href="/tags#iptables " class="post-tag">iptables</a> <a href="/tags#color-print " class="post-tag">color-print</a> <a href="/tags#htb-olympus " class="post-tag">htb-olympus</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/mischief-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />Mishcief was one of the easier 50 point boxes, but it still provided a lot of opportunity to enumerate things, and forced the attacker to think about and work with IPv6, which is something that likely don’t come naturally to most of us.  I’ll use snmp to get both the IPv6 address of the host and credentials from the webserver. From there, I can use those creds to log in and get more creds. The other creds work on a website hosted only on IPv6. That site has command injection, which gives me code execution, a shell as www-data, and creds for loki. loki’s bash history gives me the root password, which I can use to get root, once I get around the fact that file access control lists are used to prevent loki from running su. In beyond root, I’ll look at how I could get RCE without the creds to the website, how I might have exfiled data via ping if there wasn’t a way to see output, the filtering that site did, and the iptables rules.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 31, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/hackvent2018/">
                Hackvent 2018: Days 1-12
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackvent " class="post-tag">hackvent</a> <a href="/tags#jab " class="post-tag">jab</a> <a href="/tags#qrcode " class="post-tag">qrcode</a> <a href="/tags#14-segment-display " class="post-tag">14-segment-display</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#dial-a-pirate " class="post-tag">dial-a-pirate</a> <a href="/tags#certificate-transparency " class="post-tag">certificate-transparency</a> <a href="/tags#piet " class="post-tag">piet</a> <a href="/tags#perl " class="post-tag">perl</a> <a href="/tags#deobfuscation " class="post-tag">deobfuscation</a> <a href="/tags#steganography " class="post-tag">steganography</a> <a href="/tags#stegsolve " class="post-tag">stegsolve</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#sandbox-escape " class="post-tag">sandbox-escape</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#telegram " class="post-tag">telegram</a> <a href="/tags#sqli " class="post-tag">sqli</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/hackvent2018-cover.png" alt="" style="float: right; margin-left:50px; margin-right:20px" /> Hackvent is a great CTF, where a different challenge is presented each day, and the techniques necessary to solve each challenge vary widely. Like Advent of Code, I only made it through the first half before a combination of increased difficulty, travel for the holidays, and Holiday Hack (and, of course, <a href="https://twitter.com/0xdf_/status/1074880711285448705">winning NetWars TOC</a>) all led to my stopping Hackvent mid-way. Still, even the first 12 challenges has some neat stuff, and were interesting enough to write up.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 19, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/12/19/jq.html">
                You Need To Know jq
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#sans-holiday-hack " class="post-tag">sans-holiday-hack</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#jq " class="post-tag">jq</a> <a href="/tags#htb-waldo " class="post-tag">htb-waldo</a> <a href="/tags#ja3 " class="post-tag">ja3</a> <a href="/tags#malware " class="post-tag">malware</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/jq-cover.png" alt="" style="float: right; margin-left:50px" />jq is such a nifty tool that not nealry enough people know about. If you’re working with json data, even just small bits here and there, it’s worth knowing the basics to make some simple data manipulations possible. And if you want to become a full on jq wizard, all the better. In this post, I’ll walk through three examples of varying levels of complexity to show off jq. I’ll detail what I did in Waldo, show an example from the 2017 Sans Holiday Hack Challenge, and conclude with a real-world example where I’m looking at SSL/TLS fingerprints.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 15, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/12/15/htb-waldo.html">
                HTB: Waldo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-waldo " class="post-tag">htb-waldo</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#rbash " class="post-tag">rbash</a> <a href="/tags#capabilities " class="post-tag">capabilities</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/waldo-cover.png" alt="" style="float: right; margin-left:50px" /> Waldo was a pretty straight forward box, with a few twists that weren’t too difficult to circumvent. First, I’ll take advantage of a php website, that allows me to leak its source. I’ll use that to bypass filters to read files outside the webroot. In doing so, I’ll find an ssh key that gets me into a container. I’ll notice that I can actually ssh back into localhost again to get out of the container, but with a restricted rbash shell. After escaping, I’ll find the tac program will the linux capability set to allow for full system read, giving me full read access over the entire system, including the flag.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 12, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/adventofcode2018/">
                Advent of Code 2018: Days 1-12
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#advent-of-code " class="post-tag">advent-of-code</a> <a href="/tags#python " class="post-tag">python</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/aoc2018-cover.png" alt="" style="float: right; margin-left:50px" />Advent of Code is a fun CTF because it forces you to program, and to think about data structures and efficiency. It starts off easy enough, and gets really hard by the end. It’s also a neat learning opportunity, as it’s one of the least competitive CTFs I know of. After the first 20 people solve and the leaderboard is full, people start to post answers on reddit on other places, and you can see how others solved it, or help yourself when you get stuck. I’m going to create one post and just keep updating it with my answers as far as I get.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 8, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/12/08/htb-active.html">
                HTB: Active
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-active " class="post-tag">htb-active</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#gpp-password " class="post-tag">gpp-password</a> <a href="/tags#gpp-decrypt " class="post-tag">gpp-decrypt</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#enum4linux " class="post-tag">enum4linux</a> <a href="/tags#getuserspns " class="post-tag">getuserspns</a> <a href="/tags#kerberoast " class="post-tag">kerberoast</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#psexec-py " class="post-tag">psexec-py</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/active-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" /> Active was an example of an easy box that still provided a lot of opportunity to learn. The box was centered around common vulnerabilities associated with Active Directory. There’s a good chance to practice SMB enumeration. It also gives the opportunity to use Kerberoasting against a Windows Domain, which, if you’re not a pentester, you may not have had the chance to do before.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Dec 2, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/12/02/pwk-notes-smb-enumeration-checklist-update1.html">
                PWK Notes: SMB Enumeration Checklist [Updated]
              </a>
            </h3>

<span class="tag-list"><a href="/tags#oscp " class="post-tag">oscp</a> <a href="/tags#pwk " class="post-tag">pwk</a> <a href="/tags#enumeration " class="post-tag">enumeration</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#nmblookup " class="post-tag">nmblookup</a> <a href="/tags#smbclient " class="post-tag">smbclient</a> <a href="/tags#rpcclient " class="post-tag">rpcclient</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#enum4linux " class="post-tag">enum4linux</a> <a href="/tags#smbmap " class="post-tag">smbmap</a> </span><br/><br/>


<p>[Update 2018-12-02] I just learned about smbmap, which is just great. Adding it to the original post. Beyond the enumeration I show here, it will also help enumerate shares that are readable, and can ever execute commands on writable shares. [Original] As I’ve been working through PWK/OSCP for the last month, one thing I’ve noticed is that enumeration of SMB is tricky, and different tools fail / succeed on different hosts. With some input from the NetSecFocus group, I’m building out an SMB enumeration check list here. I’ll include examples, but where I use <a href="https://www.offensive-security.com/information-security-training/penetration-testing-training-kali-linux/">PWK labs</a>, I’ll anonymize the data per their rules. If I’m missing something, leave a comment.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 30, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/11/30/htb-hawk.html">
                HTB: Hawk
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-hawk " class="post-tag">htb-hawk</a> <a href="/tags#drupal " class="post-tag">drupal</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#openssl " class="post-tag">openssl</a> <a href="/tags#openssl-bruteforce " class="post-tag">openssl-bruteforce</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#credentials " class="post-tag">credentials</a> <a href="/tags#h2 " class="post-tag">h2</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#htb-smasher " class="post-tag">htb-smasher</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/hawk-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />Hawk was a pretty easy box, that provided the challenge to decrypt a file with openssl, then use those credentials to get admin access to a Drupal website. I’ll use that access to gain execution on the host via php. Credential reuse by the daniel user allows me to escalate to that user. From there, I’ll take advantage of a H2 database to first get arbitrary file read as root, and then target a different vulnerability to get RCE and a root shell. In Beyond Root, I’ll explore the two other listening ports associated with H2, 5435 and 9092.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 24, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/11/24/htb-smasher.html">
                HTB: Smasher
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-smasher " class="post-tag">htb-smasher</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> <a href="/tags#timing-attack " class="post-tag">timing-attack</a> <a href="/tags#padding-oracle " class="post-tag">padding-oracle</a> <a href="/tags#aes " class="post-tag">aes</a> <a href="/tags#directory-traversal " class="post-tag">directory-traversal</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/smasher-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" /> Smasher is a really hard box with three challenges that require a detailed understanding of how the code you’re intereacting with works. It starts with an instance of shenfeng tiny-web-server running on port 1111. I’ll use a path traversal vulnerability to access to the root file system. I’ll use that to get a copy of the source and binary for the running web server. With that, I’ll write a buffer overflow exploit to get a reverse shell. Next, I’ll exploit a padding oracle vulnerability to get a copy of the smasher user’s password. From there, I’ll take advantage of a timing vulnerability in setuid binary to read the contents of root.txt. I think it’s possible to get a root shell exploiting a buffer overflow, but I wasn’t able to pull it off (yet). In Beyond Root, I’ll check out the AES script, and show how I patched the checker binary.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 24, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/11/24/htb-smasher-bof.html">
                Buffer Overflow in HTB Smasher
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-smasher " class="post-tag">htb-smasher</a> <a href="/tags#gdb " class="post-tag">gdb</a> <a href="/tags#bof " class="post-tag">bof</a> <a href="/tags#pwntools " class="post-tag">pwntools</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/smasher-bof-cover.jpg" alt="" style="float: right; margin-left:50px" /> There was so much to write about for Smasher, it seemed that the buffer overflow in tiny deserved its own post. I’ll walk through my process, code analysis and debugging, through development of a small ROP chain, and show how I trouble shot when things didn’t work. I’ll also show off pwntools along the way.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 17, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/11/17/htb-jerry.html">
                HTB: Jerry
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-jerry " class="post-tag">htb-jerry</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#tomcat " class="post-tag">tomcat</a> <a href="/tags#war " class="post-tag">war</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#jar " class="post-tag">jar</a> <a href="/tags#jsp " class="post-tag">jsp</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/jerry-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" /> Jerry is quite possibly the easiest box I’ve done on HackTheBox (maybe rivaled only by Blue). In fact, it was rooted in just over 6 minutes! There’s a Tomcat install with a default password for the Web Application Manager. I’ll use that to upload a malicious war file, which returns a system shell, and access to both flags.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 13, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/11/13/malware-analysis-phishing-docs-from-htb-reel.html">
                Malware Analysis: Phishing Docs from HTB Reel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-reel " class="post-tag">htb-reel</a> <a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#rtf " class="post-tag">rtf</a> <a href="/tags#hta " class="post-tag">hta</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#rtfdump " class="post-tag">rtfdump</a> <a href="/tags#oledump " class="post-tag">oledump</a> <a href="/tags#scdbg " class="post-tag">scdbg</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#vbscript " class="post-tag">vbscript</a> <a href="/tags#shellcode " class="post-tag">shellcode</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/reel-malware-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />I regularly use tools like msfvenom or scripts from GitHub to create attacks in HackTheBox or PWK. I wanted to take a minute and look under the hood of the phishing documents I generated to gain access to Reel in HTB, to understand what they are doing. By the end, we’ll understand how the RTF abuses a COM object to download and launch a remote HTA. In the HTA, we’ll see layers of script calling each other, until I find some shellcode loaded into memory by PowerShell and run. I’ll do some initial analysis of that shellcode to see the network connection attempts.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 10, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/11/10/htb-reel.html">
                HTB: Reel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-reel " class="post-tag">htb-reel</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#ftp " class="post-tag">ftp</a> <a href="/tags#cve-2017-0199 " class="post-tag">cve-2017-0199</a> <a href="/tags#rtf " class="post-tag">rtf</a> <a href="/tags#hta " class="post-tag">hta</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#bloodhound " class="post-tag">bloodhound</a> <a href="/tags#powerview " class="post-tag">powerview</a> <a href="/tags#active-directory " class="post-tag">active-directory</a> <a href="/tags#metasploit " class="post-tag">metasploit</a> <a href="/tags#htb-bart " class="post-tag">htb-bart</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/reel-cover.png" alt="" style="float: right; margin-left:50px" />Reel was an awesome box because it presents challenges rarely seen in CTF environments, phishing and Active Directory. Rather than initial access coming through a web exploit, to gain an initial foothold on Reel, I’ll use some documents collected from FTP to craft a malicious rtf file and phishing email that will exploit the host and avoid the protections put into place. Then I’ll pivot through different AD users and groups, taking advantage of their different rights to eventually escalate to administrator. In Beyond Root, I’ll explore remnants of a second path to root that didn’t make the final cut, look at the ACLs on root.txt, examine the script that opens attachments as nico.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 8, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/11/08/powershell-history-file.html">
                PowerShell History File
              </a>
            </h3>

<span class="tag-list"><a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#psreadline " class="post-tag">psreadline</a> <a href="/tags#history " class="post-tag">history</a> </span><br/><br/>


<p>I came across a situation where I discovered a user’s PSReadline ConsoleHost_history.txt file, and it ended up giving me the information I needed at the time. Most people are aware of the <code class="language-plaintext highlighter-rouge">.bash_history</code> file. But did you know that the PowerShell equivalent is enabled by default starting in PowerShell v5 on Windows 10? This means this file will become more present over time as systems upgrade.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Nov 3, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/11/03/htb-dropzone.html">
                HTB: Dropzone
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-dropzone " class="post-tag">htb-dropzone</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#xp " class="post-tag">xp</a> <a href="/tags#tftp " class="post-tag">tftp</a> <a href="/tags#mof " class="post-tag">mof</a> <a href="/tags#wmi " class="post-tag">wmi</a> <a href="/tags#stuxnet " class="post-tag">stuxnet</a> <a href="/tags#alternative-data-streams " class="post-tag">alternative-data-streams</a> <a href="/tags#sysinternals " class="post-tag">sysinternals</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/Parachute-win.png" alt="" style="float: right;margin-right:50px; margin-left:50px" /> Dropzone was unique in many ways. Right off the bat, an initial nmap scan shows no TCP ports open. I’ll find unauthenticated TFTP on UDP 69, and use that access identify the host OS as Windows XP. From there, I’ll use TFTP to drop a malicious mof file where it will automatically compiled, giving me code execution, in a technique made well know by Stuxnet (though not via TFTP, but rather a SMB 0-day). This technique provides a system shell, but there’s one more twist, as I’ll have to find the flags in alternative data streams of a text file on the desktop. I’ll also take this opportunity to dive in on WMI / MOF and how they were used in Stuxnet.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 27, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/10/27/htb-bounty.html">
                HTB: Bounty
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-bounty " class="post-tag">htb-bounty</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#asp " class="post-tag">asp</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#lonelypotato " class="post-tag">lonelypotato</a> <a href="/tags#potato " class="post-tag">potato</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#ms10-051 " class="post-tag">ms10-051</a> <a href="/tags#ms16-014 " class="post-tag">ms16-014</a> <a href="/tags#web-config " class="post-tag">web-config</a> <a href="/tags#sherlock " class="post-tag">sherlock</a> <a href="/tags#watson " class="post-tag">watson</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/bounty-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" /> Bounty was one of the easier boxes I’ve done on HTB, but it still showcased a neat trick for initial access that involved embedding ASP code in a web.config file that wasn’t subject to file extension filtering. Initial shell provides access as an unprivileged user on a relatively unpatched host, vulnerable to several kernel exploits, as well as a token privilege attack. I’ll show a handful of ways to enumerate and to escalate privilege, including a really neat new tool, Watson. When I first wrote this post, Watson wouldn’t run on Bounty, but thanks to some quick work from Rasta Mouse and Mark S, I was able to update the post to include it.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 21, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/10/21/htb-tartarsauce-part-2-backuperer-follow-up.html">
                HTB TartarSauce: backuperer Follow-Up
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-tartarsauce " class="post-tag">htb-tartarsauce</a> <a href="/tags#tar " class="post-tag">tar</a> <a href="/tags#diff " class="post-tag">diff</a> </span><br/><br/>


<p>I always watch IppSec’s videos on the retired box, because even if I completed the box, I typically learn something. Watching <a href="https://www.youtube.com/watch?v=9MeBiP637ZA">IppSec’s TartarSauce video</a> yesterday left me with three things I wanted to play with a bit more in depth, each related to the <code class="language-plaintext highlighter-rouge">backuperer</code> script. First, the issue of a bash if statement, and how it evaluates on exit status. Next, how Linux handles permissions and ownership between hosts and in and out of archives. Finally, I was wrong in thinking there wasn’t a way to get a root shell… so of course I have to do that.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 20, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/10/20/htb-tartarsauce.html">
                HTB: TartarSauce
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-tartarsauce " class="post-tag">htb-tartarsauce</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#wpscan " class="post-tag">wpscan</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#rfi " class="post-tag">rfi</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#tar " class="post-tag">tar</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#monstra " class="post-tag">monstra</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/tartar-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />TartarSauce was a box with lots of steps, and an interesting focus around two themes: trolling us, and the tar binary. For initial access, I’ll find a barely functional WordPress site with a plugin vulnerable to remote file include. After abusing that RFI to get a shell, I’ll privesc twice, both times centered around tar; once through sudo tar, and once needing to manipulate an archive before a sleep runs out. In beyond root, I’ll look at some of the rabbit holes I went down, and show a short script I created to quickly get initial access and do the first privesc in one step.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 13, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/10/13/htb-devoops.html">
                HTB: DevOops
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-devoops " class="post-tag">htb-devoops</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#git " class="post-tag">git</a> <a href="/tags#pickle " class="post-tag">pickle</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#htb-canape " class="post-tag">htb-canape</a> <a href="/tags#rss " class="post-tag">rss</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>


<p><img src="https://0xdfimages.gitlab.io/img/devoops-cover.png" alt="" style="float: right;margin-right:50px; margin-left:50px" />DevOops was a really fun box that did a great job of providing interesting challenges that weren’t too difficult to solve. I’ll show how to gain access using XXE to leak the users SSH key, and then how I get root by discovering the root SSH key in an old git commit. In Beyond Root, I’ll show an alternative path to user shell exploiting a python pickle deserialization bug.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Oct 11, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/10/11/pwk-notes-post-exploitation-windows-file-transfers.html">
                PWK Notes: Post-Exploitation Windows File Transfers with SMB
              </a>
            </h3>

<span class="tag-list"><a href="/tags#pwk " class="post-tag">pwk</a> <a href="/tags#oscp " class="post-tag">oscp</a> <a href="/tags#smb " class="post-tag">smb</a> <a href="/tags#impacket " class="post-tag">impacket</a> <a href="/tags#exfil " class="post-tag">exfil</a> <a href="/tags#upload " class="post-tag">upload</a> </span><br/><br/>


<p>Moving files to and from a compromised Linux machine is, in general, pretty easy. You’ve got nc, wget, curl, and if you get really desperate, base64 copy and paste. Windows, is another issue all together. PowerShell makes this somewhat easier, but for a lot of the PWK labs, the systems are too old to have PowerShell. The course material goes over a few ways to achieve this, but they don’t cover my favorite - SMB. This may be less realistic in an environment where you have to connect from a victim machine back to your attacker box over the public internet (where SMB could be blocked), but for environments like PWK labs and HTB where you are vpned into the same LAN as your targets, it works great.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 29, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/09/29/htb-sunday.html">
                HTB: Sunday
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-sunday " class="post-tag">htb-sunday</a> <a href="/tags#finger " class="post-tag">finger</a> <a href="/tags#hashcat " class="post-tag">hashcat</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#wget " class="post-tag">wget</a> <a href="/tags#shadow " class="post-tag">shadow</a> <a href="/tags#sudoers " class="post-tag">sudoers</a> <a href="/tags#gtfobins " class="post-tag">gtfobins</a> <a href="/tags#arbitrary-write " class="post-tag">arbitrary-write</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p>Sunday is definitely one of the easier boxes on HackTheBox. It had a lot of fun concepts, but on a crowded server, they step on each other. We start by using finger to brute-force enumerate users, though once once person logs in, the answer is given to anyone working that host. I’m never a huge fan of asking people to just guess obvious passwords, but after that, there are a couple more challenges, including a troll that proves useful later, some password cracking, and a ton of neat opportunities to complete the final privesc using wget. I’ll show 6 ways to use wget to get root. Finally, in Beyond Root, I’ll explore the overwrite script being run by root, finger for file transfer, and execution without read.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 22, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/09/22/htb-olympus.html">
                HTB: Olympus
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-olympus " class="post-tag">htb-olympus</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#zone-transfer " class="post-tag">zone-transfer</a> <a href="/tags#xdebug " class="post-tag">xdebug</a> <a href="/tags#aircrack-ng " class="post-tag">aircrack-ng</a> <a href="/tags#802-11 " class="post-tag">802-11</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#port-knocking " class="post-tag">port-knocking</a> <a href="/tags#docker " class="post-tag">docker</a> <a href="/tags#cve-2018-15473 " class="post-tag">cve-2018-15473</a> </span><br/><br/>


<p>Olympus was, for the most part, a really fun box, where we got to bounce around between different containers, and a clear path of challenges was presented to us. The creator did a great job of getting interesting challenges such as dns and wifi cracking into a HTB format. There was one jump I wasn’t too excited to have to make, but overall, this box was a lot of fun to attack.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 15, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/09/15/htb-canape.html">
                HTB: Canape
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#pickle " class="post-tag">pickle</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#couchdb " class="post-tag">couchdb</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-canape " class="post-tag">htb-canape</a> <a href="/tags#flask " class="post-tag">flask</a> <a href="/tags#pip " class="post-tag">pip</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#cve-2017-12635 " class="post-tag">cve-2017-12635</a> <a href="/tags#cve-1017-12636 " class="post-tag">cve-1017-12636</a> <a href="/tags#cve-2018-8007 " class="post-tag">cve-2018-8007</a> <a href="/tags#erl " class="post-tag">erl</a> <a href="/tags#erlang " class="post-tag">erlang</a> </span><br/><br/>


<p>Canape is one of my favorite boxes on HTB. There is a flask website with a pickle deserialization bug. I find that bug by taking advantage of an exposed git repo on the site. With a user shell, we can exploit CouchDB to gain admin access, where we get homer’s password. I went down several rabbit holes trying to get code execution through couchdb, succeeding with EMPD, succeeding with one config change as root for CVE-2018-8007, and failing with CVE-2017-12636. Finally, I’ll take advantage of our user having sudo rights to run pip, and first get a copy of the flag, and then take it all the way to root shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 15, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/09/15/malware-analysis-bmw_of_sterlindoc.html">
                Malware Analysis: BMW_Of_Sterlin.doc
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#vba " class="post-tag">vba</a> <a href="/tags#doc " class="post-tag">doc</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#dosfuscation " class="post-tag">dosfuscation</a> <a href="/tags#olevba " class="post-tag">olevba</a> </span><br/><br/>


<p>Someone on an InfoSec group I participate in asked for help looking at a potentially malicious word doc. I took a quick look, and when I sent back the command line that came out, he asked if I could share how I was able to de-obfuscate
quickly. In writing it up for him, I figured it might help others as well, so I’ll post it here as an example.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 12, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/09/12/malware-analysis-yourexploitpdf.html">
                Malware Analysis: YourExploit.pdf
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#pdf " class="post-tag">pdf</a> <a href="/tags#pdf-parser " class="post-tag">pdf-parser</a> <a href="/tags#pdfid " class="post-tag">pdfid</a> <a href="/tags#nanocore " class="post-tag">nanocore</a> <a href="/tags#vbscript " class="post-tag">vbscript</a> </span><br/><br/>


<p>Pretty simple PDF file was uploaded to VT today, and only 11 of our 59 vendors mark is as malicious, despite it’s being pretty tiny and clearly bad. The file makes no effort at showing any real cover, and could even be a test upload from the malicious actor. The file writes a vbs script which downloads the next stage, and then runs the script and then the resulting binary. The stage two is still up, so I got a copy, which I was able to identify as nanocore, and do some basic dynamic analysis of that as well.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 8, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/09/08/htb-poison.html">
                HTB: Poison
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-poison " class="post-tag">htb-poison</a> <a href="/tags#log-poisoning " class="post-tag">log-poisoning</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#vnc " class="post-tag">vnc</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p>Poison was one of the first boxes I attempted on HTB. The discovery of a relatively obvious local file include vulnerability drives us towards a web shell via log poisoning. From there, we can find a users password out in the clear, albeit lightly obfuscated, and use that to get ssh access. With our ssh access, we find VNC listening as root on localhost, and</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Sep 1, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/09/01/htb-stratosphere.html">
                HTB: Stratosphere
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-stratosphere " class="post-tag">htb-stratosphere</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#python " class="post-tag">python</a> <a href="/tags#struts " class="post-tag">struts</a> <a href="/tags#cve-2017-9805 " class="post-tag">cve-2017-9805</a> <a href="/tags#cve-2017-5638 " class="post-tag">cve-2017-5638</a> <a href="/tags#mkfifo-shell " class="post-tag">mkfifo-shell</a> <a href="/tags#forward-shell " class="post-tag">forward-shell</a> </span><br/><br/>


<p>Stratosphere is a super fun box, with an Apache Struts vulnerability that we can exploit to get single command execution, but not a legit full shell. I’ll use the Ippsec mkfifo pipe method to write my own shell. Then there’s a python script that looks like it will give us the root flag if we only crack some hashes. However, we actually have to exploit the script, to get a root shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 25, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/08/25/secnotes-now-live-on-hackthebox.html">
                SecNotes now live on HackTheBox
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-secnotes " class="post-tag">htb-secnotes</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#windows " class="post-tag">windows</a> </span><br/><br/>


<p>My first submission to HTB, SecNotes, went live today! I was aiming for an easy (20 pt) Windows box, but it released as a medium (30 pt) box. First blood for user just fell, 1 hour and 9 minutes in. Still waiting on root. I hope people enjoy, and if you do the box, please reach out to me on the forums or direct message and let me know what you thought of it, and how you solved it. I’d be very excited to hear if there were any unintended paths discovered.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 25, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/08/25/htb-celestial.html">
                HTB: Celestial
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-celestial " class="post-tag">htb-celestial</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nodejs " class="post-tag">nodejs</a> <a href="/tags#deserialization " class="post-tag">deserialization</a> <a href="/tags#htb-aragog " class="post-tag">htb-aragog</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> </span><br/><br/>


<p>Celestial is a fairly easy box that gives us a chance to play with deserialization vulnerabilities in Node.js. Weather it’s in struts, or python’s pickle, or in Node.js, deserialization of user input is almost always a bad idea, and here’s we’ll show why. To escalate, we’ll take advantage of a cron running the user’s code as root.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 9, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/08/09/malware-analysis-dotanfiledoc.html">
                Malware Analysis: dotanFile.doc
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> </span><br/><br/>


<p>On first finding this sample, I was excited to think that I had found something interesting, rarely detected, and definitely malicious so close to when it was potentially used in a phishing attack. The more analysis I did, the more it became clear this was more likely a testing document, used by a security team evaluating their employees or an endpoint product. Still, it was an interesting sample to play with, and understand how it does interesting things like C2 protocol detection and Sandbox detection.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 7, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/08/07/malware-analysis-penn-national-health-and-wellness-program-2018doc.html">
                Malware Analysis: Penn National Health and Wellness Program 2018.doc
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#doc " class="post-tag">doc</a> <a href="/tags#vba " class="post-tag">vba</a> <a href="/tags#msbuild " class="post-tag">msbuild</a> <a href="/tags#csproj " class="post-tag">csproj</a> <a href="/tags#dns " class="post-tag">dns</a> <a href="/tags#document-variables " class="post-tag">document-variables</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#c " class="post-tag">c#</a> <a href="/tags#oledump " class="post-tag">oledump</a> </span><br/><br/>


<p>This word document contains a short bit of VBA that’s obfuscated using Word document variables to store the strings that might be identified in email filters and by AV. This seems to be effective, given the VT dection ratio. In fact, I came across this sample in conversation with someone who worked for one of the few products that was catching this sample. The VBA drops a Visual Basic C# project file, and runs it with msbuild, which executes a compilation Task. This code uses DNS TXT records to decrypt a next stage payload. Unfortunately, since the DNS record is no longer present.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 6, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/08/06/malware-analysis-inovoice-019338pdf.html">
                Malware Analysis: inovoice-019338.pdf
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#pdf " class="post-tag">pdf</a> <a href="/tags#pdfid " class="post-tag">pdfid</a> <a href="/tags#pdf-parser " class="post-tag">pdf-parser</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#settingcontent-ms " class="post-tag">settingcontent-ms</a> <a href="/tags#flawedammyy " class="post-tag">flawedammyy</a> </span><br/><br/>


<p>This is a neat PDF sample that I saw mentioned on <a href="https://twitter.com/c0d3inj3cT/status/1017553433128103936">@c0d3inj3cT</a>’s Twitter, and wanted to take a look for myself. As <a href="https://twitter.com/c0d3inj3cT/status/1017553433128103936">@c0d3inj3cT</a> says, it is a PDF that drops a SettingsContent-ms file, which then uses PowerShell to download and execute the next stage. I had been on the lookout for PDFs that try to run code to play with, so this seemed like a good place to dive in.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Aug 4, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/08/04/htb-silo.html">
                HTB: Silo
              </a>
            </h3>

<span class="tag-list"><a href="/tags#htb-silo " class="post-tag">htb-silo</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#oracle " class="post-tag">oracle</a> <a href="/tags#odat " class="post-tag">odat</a> <a href="/tags#sqlplus " class="post-tag">sqlplus</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#aspx " class="post-tag">aspx</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#volatility " class="post-tag">volatility</a> <a href="/tags#passthehash " class="post-tag">passthehash</a> <a href="/tags#rottenpotato " class="post-tag">rottenpotato</a> <a href="/tags#potato " class="post-tag">potato</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p>Silo was the first time I’ve had the opportunity to play around with exploiting a Oracle database. After the struggle of getting the tools installed and learning the ins and outs of using them, we can take advantage of this database to upload a webshell to the box. Then with the webshell, we can get a powershell shell access as a low-priv user. To privesc, we’ll have to break out our memory forensics skillset to get a hash out of a memory dump, which then we can pass back in a pass the hash attack to get a system shell. That’s all if we decided not to take the shortcut and just use the Oracle database (running as system) to read both flag files.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 31, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/07/31/malware-analysis-muddoc.html">
                Malware Analysis: mud.doc
              </a>
            </h3>

<span class="tag-list"><a href="/tags#doc " class="post-tag">doc</a> <a href="/tags#vba " class="post-tag">vba</a> <a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#crypto " class="post-tag">crypto</a> <a href="/tags#phishing " class="post-tag">phishing</a> <a href="/tags#wmi " class="post-tag">wmi</a> </span><br/><br/>


<p>This phishing document was interesting for not only its lure / cover, but also for the way it used encryption to target users who had a domain with certain key words in it. While brute forcing the domains only results in some potentially financial key words, the stage 2 domain acts as a pivot to find an original phish email in VT, which shows this was quite targeted after all.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 28, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/07/28/htb-valentine.html">
                HTB: Valentine
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-valentine " class="post-tag">htb-valentine</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#heartbleed " class="post-tag">heartbleed</a> <a href="/tags#tmux " class="post-tag">tmux</a> <a href="/tags#dirtycow " class="post-tag">dirtycow</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p>Valentine was one of the first hosts I solved on hack the box. We’ll use heartbleed to get the password for an SSH key that we find through enumeration. There’s two paths to privesc, but I’m quite partial to using the root tmux session. The box is very much on the easier side for HTB.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 24, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/07/24/sans-sec599-review.html">
                SANS SEC599 Review
              </a>
            </h3>

<span class="tag-list"><a href="/tags#training " class="post-tag">training</a> <a href="/tags#review " class="post-tag">review</a> <a href="/tags#purple-team " class="post-tag">purple-team</a> </span><br/><br/>


<p>I had the chance to take <a href="https://www.sans.org/course/defeating-advanced-adversaries-kill-chain-defenses">SANS SEC599</a>, “Defeating Advanced Adversaries - Purple Team Tactics &amp; Kill Chain Defenses” last week at SANSFIRE. The class is one of the newer SANS offerings, and so I suspect it will be changing and updating rapidly. There are some things I would change about the class, but overall, I enjoyed the class, definitely learned things that I didn’t know before, and got to meet some really smart people.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 21, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/07/21/htb-aragog.html">
                HTB: Aragog
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#htb-aragog " class="post-tag">htb-aragog</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#xxe " class="post-tag">xxe</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#pspy " class="post-tag">pspy</a> <a href="/tags#wordpress " class="post-tag">wordpress</a> <a href="/tags#cron " class="post-tag">cron</a> </span><br/><br/>


<p>Aragog provided a chance to play with XML External Entity (XXE) vulnerabilities, as well as a chance to modify a running website to capture user credentials.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 15, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/07/15/htb-bart.html">
                HTB: Bart
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-bart " class="post-tag">htb-bart</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#nmap " class="post-tag">nmap</a> <a href="/tags#gobuster " class="post-tag">gobuster</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#cewl " class="post-tag">cewl</a> <a href="/tags#bruteforce " class="post-tag">bruteforce</a> <a href="/tags#log-poisoning " class="post-tag">log-poisoning</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#winlogon " class="post-tag">winlogon</a> <a href="/tags#powershell-run-as " class="post-tag">powershell-run-as</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> </span><br/><br/>


<p>Bart starts simple enough, only listening on port 80. Yet it ends up providing a path to user shell that requires enumeration of two different sites, bypassing two logins, and then finding a file upload / LFI webshell. The privesc is relateively simple, yet I ran into an interesting issue that caused me to miss it at first. Overall, a fun box with lots to play with.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 7, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/07/07/second-order-sql-injection-on-htb-nightmare.html">
                Second Order SQL-Injection on HTB Nightmare
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-nightmare " class="post-tag">htb-nightmare</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#tamper " class="post-tag">tamper</a> <a href="/tags#second-order-sqli " class="post-tag">second-order-sqli</a> <a href="/tags#second-order " class="post-tag">second-order</a> </span><br/><br/>


<p>Nightmare just retired, and it was a insanely difficult box. Rather than do a full walkthrough, I wanted to focus on a write-up of the second-order SQL injection necessary as a first step for this host.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jul 7, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/07/07/malware-analysis-faktura_vat_115590300178js.html">
                Malware Analysis: Faktura_VAT_115590300178.js
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#javascript " class="post-tag">javascript</a> <a href="/tags#procmon " class="post-tag">procmon</a> <a href="/tags#procdot " class="post-tag">procdot</a> <a href="/tags#process-hacker " class="post-tag">process-hacker</a> <a href="/tags#logging " class="post-tag">logging</a> <a href="/tags#powershell " class="post-tag">powershell</a> </span><br/><br/>


<p>I spent some time looking at this javascript sample from VT. Based on both the file extension and the fact that I couldn’t get it to run in <code class="language-plaintext highlighter-rouge">spidermonkey</code> or <code class="language-plaintext highlighter-rouge">internet explorer</code>, it seems likely that this was a <code class="language-plaintext highlighter-rouge">.js</code> file sent as a phishing attachment that acts as a downloader to get the next stage from the c2 server. I show how to use Process Hacker, ProcMon, ProcDot, and Windows loggings to observer the PowerShell commands, and thus determine what the mawlare was doing.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 30, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/06/30/htb-nibbles.html">
                HTB: Nibbles
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-nibbles " class="post-tag">htb-nibbles</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#cve-2015-6967 " class="post-tag">cve-2015-6967</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p>Nibbles is one of the easier boxes on HTB. It hosts a vulnerable instance of <a href="http://www.nibbleblog.com/">nibbleblog</a>. There’s a Metasploit exploit for it, but it’s also easy to do without MSF, so I’ll show both. The privesc involves abusing <code class="language-plaintext highlighter-rouge">sudo</code> on a file that is world-writable.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 23, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/06/23/htb-falafel.html">
                HTB: Falafel
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-falafel " class="post-tag">htb-falafel</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#sqlmap " class="post-tag">sqlmap</a> <a href="/tags#sqli " class="post-tag">sqli</a> <a href="/tags#type-juggling " class="post-tag">type-juggling</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#upload " class="post-tag">upload</a> <a href="/tags#webshell " class="post-tag">webshell</a> <a href="/tags#framebuffer " class="post-tag">framebuffer</a> <a href="/tags#dev-fb0 " class="post-tag">/dev/fb0</a> <a href="/tags#debugfs " class="post-tag">debugfs</a> <a href="/tags#oscp-plus " class="post-tag">oscp-plus</a> <a href="/tags#oswe-like " class="post-tag">oswe-like</a> </span><br/><br/>


<p>Falafel is one of the best put together boxes on HTB. The author does a great job of creating a path with lots of technical challenges that are both not that hard and require a good deal of learning and understanding what’s going on. And there are hints distributed to us along the way.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 18, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/06/18/htb-chatterbox.html">
                HTB: Chatterbox
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-chatterbox " class="post-tag">htb-chatterbox</a> <a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#msfvenom " class="post-tag">msfvenom</a> <a href="/tags#meterpreter " class="post-tag">meterpreter</a> <a href="/tags#achat " class="post-tag">achat</a> <a href="/tags#autorunscript " class="post-tag">autorunscript</a> <a href="/tags#nishang " class="post-tag">nishang</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p>Chatterbox is one of the easier rated boxes on HTB. Overall, this box was both easy and frustrating, as there was really only one exploit to get all the way to system, but yet there were many annoyances along the way. While I typically try to avoid Meterpreter, I’ll use it here because it’s an interesting chance to learn / play with the Metasploit AutoRunScript to migrate immediately after exploitation, so that I could maintain a stable shell.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 10, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/06/10/intro-to-ssh-tunneling.html">
                Intro to SSH Tunneling
              </a>
            </h3>

<span class="tag-list"><a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#ssh " class="post-tag">ssh</a> <a href="/tags#tunnel " class="post-tag">tunnel</a> </span><br/><br/>


<p>I came across a situation on a <a href="https://www.hackthebox.eu">htb</a> box today where I needed IE to get a really slow, older, OWA page to fully function and do what I needed to do. I had a Windows vm around, but it was relatively isolated, and no able to talk directly to my kali vm. SSH tunneling turned out to be the easiest solution here, and since I get questions about SSH tunneling all the time, I figured it would be good to write up a short description.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 8, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/06/08/malware-analysis-facture-impayee-30-mai0730-04071885doc.html">
                PSDecode, follow-on analysis of Emotet samples
              </a>
            </h3>

<span class="tag-list"><a href="/tags#emotet " class="post-tag">emotet</a> <a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#doc " class="post-tag">doc</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#invoke-obfuscation " class="post-tag">invoke-obfuscation</a> <a href="/tags#psdecode " class="post-tag">psdecode</a> </span><br/><br/>


<p>In <a href="/2018/06/04/emotet-doc-sample.html">my analysis of an emotet sample</a>, I came across <a href="https://github.com/R3MRUM/PSDecode">PSDecode</a>, and, after some back and forth with the author and a couple updates, got it working on this sample. The tool is very cool. What follows is analysis of a different emotet phishing document similar to the other one I was looking at, as well as <code class="language-plaintext highlighter-rouge">PSDecode</code> output for the previous sample.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 4, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/06/04/emotet-doc-sample.html">
                Malware: Facture-impayee-30-mai#0730-04071885.doc
              </a>
            </h3>

<span class="tag-list"><a href="/tags#malware " class="post-tag">malware</a> <a href="/tags#doc " class="post-tag">doc</a> <a href="/tags#vba " class="post-tag">vba</a> <a href="/tags#powershell " class="post-tag">powershell</a> <a href="/tags#emotet " class="post-tag">emotet</a> <a href="/tags#invoke-obfuscation " class="post-tag">invoke-obfuscation</a> </span><br/><br/>


<p>Interesting sample from VT which ends up being a phishing document for the Emotet malware.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jun 3, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/06/03/htb-crimestoppers.html">
                HTB: CrimeStoppers
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-crimestoppers " class="post-tag">htb-crimestoppers</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#php-wrapper " class="post-tag">php-wrapper</a> <a href="/tags#lfi " class="post-tag">lfi</a> <a href="/tags#ida " class="post-tag">ida</a> <a href="/tags#reverse-engineering " class="post-tag">reverse-engineering</a> </span><br/><br/>


<p>This is one of my favorite boxes on HTB. It’s got a good flow, and I learned a bunch doing it. We got to tackle an LFI that allows us to get source for the site, and then we turn that LFI into RCE toget access. From there we get access to a Mozilla profile, which allows privesc to a user, and from there we find someone’s already left a modified rootme apache module in place. We can RE that mod to get root on the system.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">May 12, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/05/12/htb-fluxcapacitor.html">
                HTB: FluxCapacitor
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-fluxcapacitor " class="post-tag">htb-fluxcapacitor</a> <a href="/tags#waf " class="post-tag">waf</a> <a href="/tags#wfuzz " class="post-tag">wfuzz</a> <a href="/tags#sudo " class="post-tag">sudo</a> </span><br/><br/>


<p>Probably my least favorite box on HTB, largely because it involved a lot of guessing. I did enjoy looking for privesc without having a shell on the host.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Apr 29, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/04/29/htb-bashed.html">
                HTB: Bashed
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ctf " class="post-tag">ctf</a> <a href="/tags#hackthebox " class="post-tag">hackthebox</a> <a href="/tags#htb-bashed " class="post-tag">htb-bashed</a> <a href="/tags#php " class="post-tag">php</a> <a href="/tags#sudo " class="post-tag">sudo</a> <a href="/tags#cron " class="post-tag">cron</a> <a href="/tags#oscp-like " class="post-tag">oscp-like</a> </span><br/><br/>


<p>Bashed retired from hackthebox.eu today. Here’s my notes transformed into a walkthrough. These notes are from a couple months ago, and they are a bit raw, but posting here anyway.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 15, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/01/15/home-lab-on-the-super-cheap-esxi.html">
                Home Lab On The Super Cheap - ESXi
              </a>
            </h3>

<span class="tag-list"><a href="/tags#macpro " class="post-tag">macpro</a> <a href="/tags#home-lab " class="post-tag">home-lab</a> <a href="/tags#esxi " class="post-tag">esxi</a> </span><br/><br/>


<p>Getting the hypervisor installed is the next step.</p>

</li>
        

          <li class="post-list-li"><span class="post-meta">Jan 15, 2018</span>
            <h3 class="post-list-h3">
              <a class="post-link" href="/2018/01/15/home-lab-on-the-super-cheap-the-hardware.html">
                Home Lab On The Super Cheap - The Hardware
              </a>
            </h3>

<span class="tag-list"><a href="/tags#ebay " class="post-tag">ebay</a> <a href="/tags#macpro " class="post-tag">macpro</a> <a href="/tags#home-lab " class="post-tag">home-lab</a> </span><br/><br/>


<p>The benefits of a home lab are numerous to anyone into infosec, CTFs, and/or malware analysis. Here’s how I approached it on the cheap.</p>

</li>
        
</ul>

    <p class="rss-subscribe">subscribe <a href="/feed.xml">via RSS</a></p></div>

      </div>
    </main>
<footer class="site-footer h-card">

  <div class="wrapper">

    <h2 data-toc-skip class="footer-heading">0xdf hacks stuff</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">0xdf hacks stuff
</li><li><a class="u-email" href="mailto:0xdf.223@gmail.com">0xdf.223@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://www.twitter.com/0xdf_"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg> <span class="username">0xdf_</span></a></li><!--<li><a href="https://mm.netsecfocus.com/nsf/messages/@oxdf"><img class="svg-icon" src="/assets/icons/mattermost-icon-128.png" alt="NSF" /><span class="username">oxdf</span></a></li>--><li><a href="https://youtube.com/channel/UChO9OAH57Flz35RRX__E25A"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#youtube"></use></svg> <span class="username">0xdf</span></a></li><li><a href="/feed.xml"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#rss"></use></svg> <span>feed</span></a></li><li class="bmc"><a href="https://www.hackthebox.eu/home/users/profile/4935"><img class="svg-icon bmc" src="/assets/icons/htb-favicon.png" alt="HTB" /><span class="username">0xdf</span></a></li><li class="bmc"><a rel="me" href="https://infosec.exchange/@0xdf"><img class="svg-icon bmc" src="/assets/icons/mastodon.svg" alt="Mastodon" /><span class="username">@0xdf@infosec.exchange</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>CTF solutions, malware analysis, home lab development</p>
        <link href="https://fonts.googleapis.com/css?family=Cookie"
rel="stylesheet"><a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/0xdf"><img src="https://cdn.buymeacoffee.com/buttons/bmc-new-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:15px;font-size:28px !important;">Buy me a coffee</span></a>
      </div>
    </div>

  </div>


  <script src="/assets/js/jquery-3.6.0.min.js" integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK" crossorigin="anonymous"></script>
  <script src="/assets/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <script src="/assets/js/bootstrap-toc.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  
  <script src="/assets/js/collapsable.js"></script>


  <!-- Twitter universal website tag code -->
  <script>
    !function(e,t,n,s,u,a){e.twq||(s=e.twq=function(){s.exe?s.exe.apply(s,arguments):s.queue.push(arguments);
     },s.version='1.1',s.queue=[],u=t.createElement(n),u.async=!0,u.src='//static.ads-twitter.com/uwt.js',
     a=t.getElementsByTagName(n)[0],a.parentNode.insertBefore(u,a))}(window,document,'script');
    // Insert Twitter Pixel ID and Standard Event data below
    twq('init','o42o1');
    twq('track','PageView');
  </script>
  <!-- End Twitter universal website tag code -->
</footer>
</body>

</html>
